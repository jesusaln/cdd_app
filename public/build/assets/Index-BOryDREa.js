import{B as G,C as z,w as Y,i as c,o as u,f as e,l as C,t as n,v as A,z as ye,x as D,F as S,m as O,s as ee,Q as _e,p as J,r as w,c as we,O as ke,g as I,u as Ce,Z as Me,k,n as V,e as je,q as Q,P as $e,I as Pe,N as b}from"./vendor-d19pJyVS.js";import{A as Ee}from"./AppLayout-CcnrZQKI.js";import{N as Fe}from"./app-BcT2PLJy.js";import{_ as te}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./utils-Dq7h7Pqt.js";const Be={class:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden"},Ne={class:"bg-gradient-to-r from-green-50 to-emerald-50 px-6 py-6 border-b border-gray-200/60"},Te={class:"grid grid-cols-2 md:grid-cols-7 gap-4"},ze={class:"bg-white/70 rounded-lg p-4 border border-gray-200/50"},Ae={class:"flex items-center justify-between"},Ve={class:"text-2xl font-bold text-gray-900"},Se={class:"bg-white/70 rounded-lg p-4 border border-gray-200/50"},Le={class:"flex items-center justify-between"},De={class:"text-2xl font-bold text-green-600"},Ie={class:"bg-white/70 rounded-lg p-4 border border-gray-200/50"},Oe={class:"flex items-center justify-between"},He={class:"text-2xl font-bold text-blue-600"},Ue={class:"bg-white/70 rounded-lg p-4 border border-gray-200/50"},qe={class:"flex items-center justify-between"},Re={class:"text-2xl font-bold text-red-600"},We={class:"bg-white/70 rounded-lg p-4 border border-gray-200/50"},Ke={class:"flex items-center justify-between"},Xe={class:"text-lg font-bold text-green-600"},Ze={class:"bg-white/70 rounded-lg p-4 border border-gray-200/50"},Ge={class:"flex items-center justify-between"},Je={class:"text-lg font-bold text-blue-600"},Qe={class:"bg-white/70 rounded-lg p-4 border border-gray-200/50"},Ye={class:"flex items-center justify-between"},et={class:"text-lg font-bold text-orange-600"},tt={class:"px-6 py-4 bg-gray-50/50 border-b border-gray-200/60"},ot={class:"flex flex-col md:flex-row md:items-center md:justify-between space-y-4 md:space-y-0"},st={class:"flex-1 max-w-md"},rt={class:"relative"},nt={class:"flex items-center space-x-3"},at=["value"],it={__name:"PrestamosHeader",props:G({total:{type:Number,default:0},activos:{type:Number,default:0},completados:{type:Number,default:0},cancelados:{type:Number,default:0},monto_total_prestado:{type:Number,default:0},monto_total_pagado:{type:Number,default:0},monto_total_pendiente:{type:Number,default:0},clientes:{type:Array,default:()=>[]}},{searchTerm:{type:String,default:""},searchTermModifiers:{},sortBy:{type:String,default:"created_at-desc"},sortByModifiers:{},filtroEstado:{type:String,default:""},filtroEstadoModifiers:{},filtroCliente:{type:[String,Number],default:""},filtroClienteModifiers:{}}),emits:G(["crear-nueva","search-change","filtro-estado-change","filtro-cliente-change","sort-change","limpiar-filtros"],["update:searchTerm","update:sortBy","update:filtroEstado","update:filtroCliente"]),setup(l,{emit:p}){const a=p,P=z(l,"searchTerm"),x=z(l,"sortBy"),M=z(l,"filtroEstado"),i=z(l,"filtroCliente"),j=()=>a("crear-nueva"),E=()=>a("search-change",P.value),h=()=>a("filtro-estado-change",M.value),f=()=>a("filtro-cliente-change",i.value),y=()=>a("sort-change",x.value),_=()=>a("limpiar-filtros"),g=F=>{const r=parseFloat(F),m=Number.isFinite(r)?r:0;return new Intl.NumberFormat("es-MX",{minimumFractionDigits:2,maximumFractionDigits:2}).format(m)};return Y([P,x,M,i],()=>{},{immediate:!0}),(F,r)=>(u(),c("div",Be,[e("div",Ne,[e("div",{class:"flex items-center justify-between mb-6"},[r[5]||(r[5]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900 tracking-tight"},"Préstamos"),e("p",{class:"text-sm text-gray-600 mt-1"},"Gestiona todos tus préstamos activos e históricos")],-1)),e("button",{onClick:j,class:"inline-flex items-center px-4 py-2 bg-green-600 text-white text-sm font-medium rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition-colors duration-200"},r[4]||(r[4]=[e("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),C(" Nuevo Préstamo ")]))]),e("div",Te,[e("div",ze,[e("div",Ae,[e("div",null,[r[6]||(r[6]=e("p",{class:"text-sm font-medium text-gray-600"},"Total",-1)),e("p",Ve,n(l.total),1)]),r[7]||(r[7]=e("div",{class:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center"},[e("svg",{class:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})])],-1))])]),e("div",Se,[e("div",Le,[e("div",null,[r[8]||(r[8]=e("p",{class:"text-sm font-medium text-gray-600"},"Activos",-1)),e("p",De,n(l.activos),1)]),r[9]||(r[9]=e("div",{class:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center"},[e("svg",{class:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1))])]),e("div",Ie,[e("div",Oe,[e("div",null,[r[10]||(r[10]=e("p",{class:"text-sm font-medium text-gray-600"},"Completados",-1)),e("p",He,n(l.completados),1)]),r[11]||(r[11]=e("div",{class:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center"},[e("svg",{class:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})])],-1))])]),e("div",Ue,[e("div",qe,[e("div",null,[r[12]||(r[12]=e("p",{class:"text-sm font-medium text-gray-600"},"Cancelados",-1)),e("p",Re,n(l.cancelados),1)]),r[13]||(r[13]=e("div",{class:"w-10 h-10 bg-red-100 rounded-full flex items-center justify-center"},[e("svg",{class:"w-5 h-5 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})])],-1))])]),e("div",We,[e("div",Ke,[e("div",null,[r[14]||(r[14]=e("p",{class:"text-sm font-medium text-gray-600"},"Total Prestado",-1)),e("p",Xe,"$"+n(g(l.monto_total_prestado)),1)]),r[15]||(r[15]=e("div",{class:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center"},[e("svg",{class:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})])],-1))])]),e("div",Ze,[e("div",Ge,[e("div",null,[r[16]||(r[16]=e("p",{class:"text-sm font-medium text-gray-600"},"Total Pagado",-1)),e("p",Je,"$"+n(g(l.monto_total_pagado)),1)]),r[17]||(r[17]=e("div",{class:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center"},[e("svg",{class:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"})])],-1))])]),e("div",Qe,[e("div",Ye,[e("div",null,[r[18]||(r[18]=e("p",{class:"text-sm font-medium text-gray-600"},"Pendiente",-1)),e("p",et,"$"+n(g(l.monto_total_pendiente)),1)]),r[19]||(r[19]=e("div",{class:"w-10 h-10 bg-orange-100 rounded-full flex items-center justify-center"},[e("svg",{class:"w-5 h-5 text-orange-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1))])])])]),e("div",tt,[e("div",ot,[e("div",st,[e("div",rt,[r[20]||(r[20]=e("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[e("svg",{class:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1)),A(e("input",{"onUpdate:modelValue":r[0]||(r[0]=m=>P.value=m),type:"text",placeholder:"Buscar por cliente o monto...",class:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-green-500 focus:border-green-500 text-sm",onInput:E},null,544),[[ye,P.value]])])]),e("div",nt,[A(e("select",{"onUpdate:modelValue":r[1]||(r[1]=m=>M.value=m),onChange:h,class:"block w-48 pl-3 pr-10 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-1 focus:ring-green-500 focus:border-green-500 bg-white"},r[21]||(r[21]=[e("option",{value:""},"Todos los estados",-1),e("option",{value:"activo"},"Activos",-1),e("option",{value:"completado"},"Completados",-1),e("option",{value:"cancelado"},"Cancelados",-1)]),544),[[D,M.value]]),A(e("select",{"onUpdate:modelValue":r[2]||(r[2]=m=>i.value=m),onChange:f,class:"block w-48 pl-3 pr-10 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-1 focus:ring-green-500 focus:border-green-500 bg-white"},[r[22]||(r[22]=e("option",{value:""},"Todos los clientes",-1)),(u(!0),c(S,null,O(l.clientes,m=>(u(),c("option",{key:m.id,value:m.id},n(m.nombre_razon_social),9,at))),128))],544),[[D,i.value]]),A(e("select",{"onUpdate:modelValue":r[3]||(r[3]=m=>x.value=m),onChange:y,class:"block w-48 pl-3 pr-10 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-1 focus:ring-green-500 focus:border-green-500 bg-white"},r[23]||(r[23]=[ee('<option value="created_at-desc" data-v-981d0fd9>Fecha (Más reciente)</option><option value="created_at-asc" data-v-981d0fd9>Fecha (Más antiguo)</option><option value="monto_prestado-desc" data-v-981d0fd9>Monto (Mayor)</option><option value="monto_prestado-asc" data-v-981d0fd9>Monto (Menor)</option><option value="cliente.nombre_razon_social-asc" data-v-981d0fd9>Cliente (A-Z)</option><option value="cliente.nombre_razon_social-desc" data-v-981d0fd9>Cliente (Z-A)</option>',6)]),544),[[D,x.value]]),e("button",{onClick:_,class:"inline-flex items-center px-3 py-2 border border-gray-300 text-sm leading-4 font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-colors duration-200"},r[24]||(r[24]=[e("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),C(" Limpiar ")]))])])])]))}},lt=te(it,[["__scopeId","data-v-981d0fd9"]]),dt={class:"prestamos-index min-h-screen bg-gray-50"},ct={class:"max-w-8xl mx-auto px-6 py-8"},ut={class:"flex justify-between items-center mb-4 text-sm text-gray-600"},gt={class:"flex items-center space-x-2"},pt=["value"],mt={class:"mt-6"},vt={class:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden"},ft={class:"bg-gradient-to-r from-gray-50 to-gray-100/50 px-6 py-4 border-b border-gray-200/60"},xt={class:"flex items-center justify-between"},bt={class:"text-sm text-gray-600 bg-white/70 px-3 py-1 rounded-full border border-gray-200/50"},ht={class:"overflow-x-auto"},yt={class:"min-w-full divide-y divide-gray-200/60"},_t={class:"bg-white divide-y divide-gray-200/40"},wt={class:"px-6 py-4"},kt={class:"flex flex-col space-y-0.5"},Ct={class:"text-sm font-medium text-gray-900"},Mt={class:"px-6 py-4"},jt={class:"flex flex-col space-y-0.5"},$t={class:"text-sm font-medium text-gray-900 group-hover:text-gray-800"},Pt={class:"text-xs text-gray-500"},Et={class:"px-6 py-4"},Ft={class:"flex flex-col space-y-0.5"},Bt={class:"text-sm font-medium text-gray-900"},Nt={class:"text-xs text-green-600"},Tt={class:"px-6 py-4"},zt={class:"text-sm text-gray-700"},At={class:"px-6 py-4"},Vt={class:"flex flex-col space-y-0.5"},St={class:"text-sm text-gray-900"},Lt={class:"text-xs text-gray-500"},Dt={key:0,class:"text-xs text-red-600 font-medium"},It={class:"px-6 py-4"},Ot={class:"px-6 py-4"},Ht={class:"flex items-center justify-end space-x-2"},Ut=["onClick"],qt=["onClick"],Rt=["onClick"],Wt=["onClick"],Kt=["onClick"],Xt=["onClick"],Zt=["onClick"],Gt={key:1},Jt={key:0,class:"flex justify-center items-center space-x-2 mt-6"},Qt=["disabled"],Yt={class:"flex space-x-1"},eo=["onClick"],to=["disabled"],oo=["onKeydown"],so={key:0,class:"text-center"},ro={key:1,class:"space-y-4"},no={class:"text-lg font-medium mb-1 flex items-center gap-2"},ao={key:0,class:"text-sm text-gray-500"},io={key:0,class:"space-y-4"},lo={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},co={class:"text-sm text-gray-600"},uo={class:"text-sm text-gray-600"},go={class:"text-sm text-gray-600"},po={class:"text-sm text-gray-600"},mo={class:"text-sm text-gray-600"},vo={class:"text-sm text-gray-600"},fo={class:"text-sm text-gray-600"},xo={class:"bg-gray-50 rounded-lg p-4"},bo={class:"grid grid-cols-2 gap-4 text-sm"},ho={class:"text-lg font-semibold text-gray-900"},yo={class:"text-lg font-semibold text-green-600"},_o={class:"text-lg font-semibold text-orange-600"},wo={class:"text-lg font-semibold text-blue-600"},ko={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Co=Object.assign({layout:Ee},{__name:"Index",props:{prestamos:{type:Object,default:()=>({data:[]})},estadisticas:{type:Object,default:()=>({total:0,activos:0,completados:0,cancelados:0,monto_total_prestado:0,monto_total_pagado:0,monto_total_pendiente:0})},filters:{type:Object,default:()=>({})},sorting:{type:Object,default:()=>({sort_by:"created_at",sort_direction:"desc"})},pagination:{type:Object,default:()=>({})}},setup(l){const p=l,a=new Fe({duration:4e3,position:{x:"right",y:"top"},types:[{type:"success",background:"#10b981",icon:!1},{type:"error",background:"#ef4444",icon:!1},{type:"warning",background:"#f59e0b",icon:!1}]}),P=_e();J(()=>{const o=P.props.flash;o!=null&&o.success&&a.success(o.success),o!=null&&o.error&&a.error(o.error)});const x=w(!1),M=w("details"),i=w(null),j=w(null),E=w(!1),h=w(""),f=w("created_at-desc"),y=w(""),_=w(""),g=we(()=>{var o,t,d,s,v,N;return{current_page:((o=p.pagination)==null?void 0:o.current_page)||1,last_page:((t=p.pagination)==null?void 0:t.last_page)||1,per_page:((d=p.pagination)==null?void 0:d.per_page)||10,from:((s=p.pagination)==null?void 0:s.from)||0,to:((v=p.pagination)==null?void 0:v.to)||0,total:((N=p.pagination)==null?void 0:N.total)||0}}),F=o=>{const t={page:o,search:h.value,estado:y.value,cliente_id:_.value,sort_by:f.value.split("-")[0],sort_direction:f.value.split("-")[1]||"desc"};b.visit("/prestamos",{data:t})},r=()=>{var d,s;const o=((d=p.pagination)==null?void 0:d.current_page)||1,t=((s=p.pagination)==null?void 0:s.last_page)||1;o<t&&F(o+1)},m=()=>{var t;const o=((t=p.pagination)==null?void 0:t.current_page)||1;o>1&&F(o-1)},oe=()=>{h.value="",f.value="fecha-desc",y.value="",_.value="",b.visit("/prestamos"),a.success("Filtros limpiados correctamente")},se=o=>{if(o&&typeof o=="string"){f.value=o;const t={sort_by:o.split("-")[0],sort_direction:o.split("-")[1]||"desc",search:h.value,estado:y.value,cliente_id:_.value};b.visit("/prestamos",{data:t})}},re=o=>{const d={per_page:o.target.value,search:h.value,estado:y.value,cliente_id:_.value,sort_by:f.value.split("-")[0],sort_direction:f.value.split("-")[1]||"desc"};b.visit("/prestamos",{data:d})},ne=()=>{const o={search:h.value,estado:y.value,cliente_id:_.value,sort_by:f.value.split("-")[0],sort_direction:f.value.split("-")[1]||"desc"};b.visit("/prestamos",{data:o})},H=()=>{const o={search:h.value,estado:y.value,cliente_id:_.value,sort_by:f.value.split("-")[0],sort_direction:f.value.split("-")[1]||"desc"};b.visit("/prestamos",{data:o})};function ae(o){if(!(o!=null&&o.id))throw new Error("ID de préstamo no válido");return!0}const ie=o=>{try{ae(o),i.value=o,M.value="details",x.value=!0}catch(t){a.error(t.message)}},U=o=>{var t;try{const d=o||((t=i.value)==null?void 0:t.id);if(!d)throw new Error("ID de préstamo no válido");b.visit(`/prestamos/${d}/edit`)}catch(d){a.error(d.message)}},le=o=>{try{if(!o)throw new Error("ID de préstamo no válido");j.value=o,M.value="confirm",x.value=!0}catch(t){a.error(t.message)}},de=async()=>{try{if(!j.value)throw new Error("No se seleccionó ningún préstamo");E.value=!0,b.delete(`/prestamos/${j.value}`,{onStart:()=>{a.success("Eliminando préstamo...")},onSuccess:o=>{a.success("Préstamo eliminado exitosamente"),x.value=!1,j.value=null},onError:o=>{console.error("Error al eliminar:",o),a.error("Error al eliminar el préstamo")},onFinish:()=>{E.value=!1}})}catch(o){a.error(o.message),E.value=!1}},ce=()=>{b.visit("/prestamos/create")},ue=o=>{b.visit(`/pagos?prestamo_id=${o}`)},ge=o=>{try{b.visit(`/pagos/create?prestamo_id=${o}`)}catch(t){a.error(t.message)}},pe=o=>{try{b.visit(`/prestamos/${o}/pagare`)}catch(t){a.error(t.message)}},me=async o=>{var t,d;try{if(!((t=o.cliente)!=null&&t.telefono)){a.error("El cliente no tiene número de teléfono registrado");return}try{const s=await fetch("/api/whatsapp/test",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({telefono:o.cliente.telefono,mensaje:"Verificación de configuración WhatsApp"})});if(!s.ok){const v=await s.json();a.error("WhatsApp no está configurado: "+(v.message||"Error de configuración"));return}}catch{a.error("Error verificando configuración de WhatsApp");return}if(confirm(`¿Enviar recordatorio de pago por WhatsApp a ${o.cliente.nombre_razon_social}?`))try{const s=await fetch(`/prestamos/${o.id}/enviar-recordatorio-whatsapp`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":((d=document.querySelector('meta[name="csrf-token"]'))==null?void 0:d.getAttribute("content"))||""}}),v=await s.json();s.ok&&v.success?a.success(v.message):a.error("Error: "+(v.message||"Error desconocido"))}catch(s){console.error("Error enviando recordatorio:",s),a.error("Error de conexión: "+s.message)}}catch(s){a.error(s.message)}},L={activo:{label:"Activo",classes:"bg-green-100 text-green-700",color:"bg-green-400"},completado:{label:"Completado",classes:"bg-blue-100 text-blue-700",color:"bg-blue-400"},cancelado:{label:"Cancelado",classes:"bg-red-100 text-red-700",color:"bg-red-400"}},q=o=>{var t;return((t=L[o])==null?void 0:t.classes)||"bg-gray-100 text-gray-700"},ve=o=>{var t;return((t=L[o])==null?void 0:t.color)||"bg-gray-400"},R=o=>{var t;return((t=L[o])==null?void 0:t.label)||"Pendiente"},$=o=>{const t=parseFloat(o),d=Number.isFinite(t)?t:0;return new Intl.NumberFormat("es-MX",{minimumFractionDigits:2,maximumFractionDigits:2}).format(d)},W=o=>{if(!o)return"Fecha no disponible";try{const t=new Date(o).getTime();return Number.isNaN(t)?"Fecha inválida":new Date(t).toLocaleDateString("es-MX",{day:"2-digit",month:"2-digit",year:"numeric"})}catch{return"Fecha inválida"}},K=w(null),fe=()=>{var o;try{(o=K.value)==null||o.focus()}catch{}};Y(()=>x,o=>{o&&setTimeout(fe,0)});const X=o=>{o.key==="Escape"&&x.value&&T()};J(()=>window.addEventListener("keydown",X)),ke(()=>window.removeEventListener("keydown",X));const xe=()=>{x.value=!1,i.value=null,j.value=null},be=()=>{de()},T=()=>{x.value=!1,i.value=null,j.value=null},he=()=>{var o;U((o=i.value)==null?void 0:o.id)};return(o,t)=>{var d;return u(),c(S,null,[I(Ce(Me),{title:"Préstamos"}),e("div",dt,[e("div",ct,[I(lt,{total:l.estadisticas.total,activos:l.estadisticas.activos,completados:l.estadisticas.completados,cancelados:l.estadisticas.cancelados,monto_total_prestado:l.estadisticas.monto_total_prestado,monto_total_pagado:l.estadisticas.monto_total_pagado,monto_total_pendiente:l.estadisticas.monto_total_pendiente,clientes:[],"search-term":h.value,"onUpdate:searchTerm":t[0]||(t[0]=s=>h.value=s),"sort-by":f.value,"onUpdate:sortBy":t[1]||(t[1]=s=>f.value=s),"filtro-estado":y.value,"onUpdate:filtroEstado":t[2]||(t[2]=s=>y.value=s),"filtro-cliente":_.value,"onUpdate:filtroCliente":t[3]||(t[3]=s=>_.value=s),onCrearNueva:ce,onSearchChange:ne,onFiltroEstadoChange:H,onFiltroClienteChange:H,onSortChange:se,onLimpiarFiltros:oe},null,8,["total","activos","completados","cancelados","monto_total_prestado","monto_total_pagado","monto_total_pendiente","search-term","sort-by","filtro-estado","filtro-cliente"]),e("div",ut,[e("div",null," Mostrando "+n(g.value.from)+" - "+n(g.value.to)+" de "+n(g.value.total)+" préstamos ",1),e("div",gt,[t[5]||(t[5]=e("span",null,"Elementos por página:",-1)),e("select",{value:g.value.per_page,onChange:re,class:"border border-gray-300 rounded px-2 py-1 text-sm"},t[4]||(t[4]=[ee('<option value="10" data-v-88b8b961>10</option><option value="15" data-v-88b8b961>15</option><option value="25" data-v-88b8b961>25</option><option value="50" data-v-88b8b961>50</option><option value="100" data-v-88b8b961>100</option>',5)]),40,pt)])]),e("div",mt,[e("div",vt,[e("div",ft,[e("div",xt,[t[6]||(t[6]=e("h2",{class:"text-lg font-semibold text-gray-900 tracking-tight"},"Préstamos",-1)),e("div",bt,n(((d=p.prestamos.data)==null?void 0:d.length)||0)+" de "+n(g.value.total)+" préstamos ",1)])]),e("div",ht,[e("table",yt,[t[15]||(t[15]=e("thead",{class:"bg-gray-50/60"},[e("tr",null,[e("th",{class:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider"},"Fecha"),e("th",{class:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider"},"Cliente"),e("th",{class:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider"},"Monto"),e("th",{class:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider"},"Tasa Mensual"),e("th",{class:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider"},"Pagos"),e("th",{class:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider"},"Estado"),e("th",{class:"px-6 py-4 text-right text-xs font-semibold text-gray-600 uppercase tracking-wider"},"Acciones")])],-1)),e("tbody",_t,[p.prestamos.data&&p.prestamos.data.length>0?(u(!0),c(S,{key:0},O(p.prestamos.data,s=>{var v,N,Z;return u(),c("tr",{key:s.id,class:"group hover:bg-gray-50/60 transition-all duration-150 hover:shadow-sm"},[e("td",wt,[e("div",kt,[e("div",Ct,n(W(s.created_at||s.fecha)),1)])]),e("td",Mt,[e("div",jt,[e("div",$t,n(((v=s.cliente)==null?void 0:v.nombre_razon_social)||"Sin cliente"),1),e("div",Pt,n(((N=s.cliente)==null?void 0:N.rfc)||""),1)])]),e("td",Et,[e("div",Ft,[e("div",Bt," $"+n($(s.monto_prestado)),1),e("div",Nt," Pago: $"+n($(s.pago_periodico)),1)])]),e("td",Tt,[e("div",zt,n(s.tasa_interes_mensual)+"% ",1)]),e("td",At,[e("div",Vt,[e("div",St,n(s.pagos_realizados||0)+" / "+n(s.numero_pagos),1),e("div",Lt,n(s.numero_pagos>0?Math.round((s.pagos_realizados||0)/s.numero_pagos*100):0)+"% completado ",1),s.tiene_pagos_atrasados?(u(),c("div",Dt," ¡Pagos atrasados! ")):k("",!0)])]),e("td",It,[e("span",{class:V([q(s.estado),"inline-flex items-center px-3 py-1.5 rounded-full text-xs font-medium transition-all duration-150 hover:shadow-sm"])},[e("span",{class:V(["w-2 h-2 rounded-full mr-2 transition-all duration-150",ve(s.estado)])},null,2),C(" "+n(R(s.estado)),1)],2)]),e("td",Ot,[e("div",Ht,[e("button",{onClick:B=>ie(s),class:"group/btn relative inline-flex items-center justify-center w-8 h-8 rounded-lg bg-blue-50 text-blue-600 hover:bg-blue-100 hover:text-blue-700 hover:shadow-sm transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:ring-offset-1",title:"Ver detalles"},t[7]||(t[7]=[e("svg",{class:"w-4 h-4 transition-transform duration-200 group-hover/btn:scale-110",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})],-1)]),8,Ut),e("button",{onClick:B=>ue(s.id),class:"group/btn relative inline-flex items-center justify-center w-8 h-8 rounded-lg bg-purple-50 text-purple-600 hover:bg-purple-100 hover:text-purple-700 hover:shadow-sm transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-purple-500/50 focus:ring-offset-1",title:"Ver pagos del préstamo"},t[8]||(t[8]=[e("svg",{class:"w-4 h-4 transition-transform duration-200 group-hover/btn:scale-110",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})],-1)]),8,qt),e("button",{onClick:B=>pe(s.id),class:"group/btn relative inline-flex items-center justify-center w-8 h-8 rounded-lg bg-red-50 text-red-600 hover:bg-red-100 hover:text-red-700 hover:shadow-sm transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-red-500/50 focus:ring-offset-1",title:"Generar pagaré PDF"},t[9]||(t[9]=[e("svg",{class:"w-4 h-4 transition-transform duration-200 group-hover/btn:scale-110",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})],-1)]),8,Rt),e("button",{onClick:B=>U(s.id),class:"group/btn relative inline-flex items-center justify-center w-8 h-8 rounded-lg bg-amber-50 text-amber-600 hover:bg-amber-100 hover:text-amber-700 hover:shadow-sm transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-amber-500/50 focus:ring-offset-1",title:"Editar préstamo"},t[10]||(t[10]=[e("svg",{class:"w-4 h-4 transition-transform duration-200 group-hover/btn:scale-110",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)]),8,Wt),s.estado==="activo"?(u(),c("button",{key:0,onClick:B=>ge(s.id),class:"group/btn relative inline-flex items-center justify-center w-8 h-8 rounded-lg bg-green-50 text-green-600 hover:bg-green-100 hover:text-green-700 hover:shadow-sm transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-green-500/50 focus:ring-offset-1",title:"Registrar pago"},t[11]||(t[11]=[e("svg",{class:"w-4 h-4 transition-transform duration-200 group-hover/btn:scale-110",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)]),8,Kt)):k("",!0),s.estado==="activo"&&((Z=s.cliente)!=null&&Z.telefono)?(u(),c("button",{key:1,onClick:B=>me(s),class:"group/btn relative inline-flex items-center justify-center w-8 h-8 rounded-lg bg-emerald-50 text-emerald-600 hover:bg-emerald-100 hover:text-emerald-700 hover:shadow-sm transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-emerald-500/50 focus:ring-offset-1",title:"Enviar recordatorio por WhatsApp"},t[12]||(t[12]=[e("svg",{class:"w-4 h-4 transition-transform duration-200 group-hover/btn:scale-110",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})],-1)]),8,Xt)):k("",!0),s.estado==="cancelado"?(u(),c("button",{key:2,onClick:B=>le(s.id),class:"group/btn relative inline-flex items-center justify-center w-8 h-8 rounded-lg bg-red-50 text-red-600 hover:bg-red-100 hover:text-red-700 hover:shadow-sm transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-red-500/50 focus:ring-offset-1",title:"Eliminar préstamo"},t[13]||(t[13]=[e("svg",{class:"w-4 h-4 transition-transform duration-200 group-hover/btn:scale-110",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)]),8,Zt)):k("",!0)])])])}),128)):(u(),c("tr",Gt,t[14]||(t[14]=[e("td",{colspan:7,class:"px-6 py-16 text-center"},[e("div",{class:"flex flex-col items-center space-y-4"},[e("div",{class:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center"},[e("svg",{class:"w-8 h-8 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})])]),e("div",{class:"space-y-1"},[e("p",{class:"text-gray-700 font-medium"},"No hay préstamos"),e("p",{class:"text-sm text-gray-500"},"Los préstamos aparecerán aquí cuando se creen")])])],-1)])))])])])])]),g.value.last_page>1?(u(),c("div",Jt,[e("button",{onClick:m,disabled:g.value.current_page===1,class:"px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," Anterior ",8,Qt),e("div",Yt,[(u(!0),c(S,null,O([g.value.current_page-1,g.value.current_page,g.value.current_page+1].filter(s=>s>0&&s<=g.value.last_page),s=>(u(),c("button",{key:s,onClick:v=>F(s),class:V(["px-3 py-2 text-sm font-medium border border-gray-300 rounded-md",s===g.value.current_page?"bg-green-500 text-white border-green-500":"text-gray-700 bg-white hover:bg-gray-50"])},n(s),11,eo))),128))]),e("button",{onClick:r,disabled:g.value.current_page===g.value.last_page,class:"px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," Siguiente ",8,to)])):k("",!0)]),I(Pe,{name:"modal"},{default:je(()=>{var s,v;return[x.value?(u(),c("div",{key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:Q(T,["self"])},[e("div",{class:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto p-6 outline-none",role:"dialog","aria-modal":"true","aria-label":"Modal de Préstamo",tabindex:"-1",ref_key:"modalRef",ref:K,onKeydown:$e(Q(T,["prevent"]),["esc"])},[M.value==="confirm"?(u(),c("div",so,[t[16]||(t[16]=e("div",{class:"w-12 h-12 mx-auto bg-red-100 rounded-full flex items-center justify-center mb-4"},[e("svg",{class:"w-6 h-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"})])],-1)),t[17]||(t[17]=e("h3",{class:"text-lg font-medium mb-2"}," ¿Eliminar préstamo? ",-1)),t[18]||(t[18]=e("p",{class:"text-gray-600 mb-6"}," Esta acción no se puede deshacer. ",-1)),e("div",{class:"flex gap-3"},[e("button",{onClick:xe,class:"flex-1 px-4 py-2 bg-gray-200 rounded-lg hover:bg-gray-300 transition-colors"}," Cancelar "),e("button",{onClick:be,class:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors"}," Eliminar ")])])):M.value==="details"?(u(),c("div",ro,[e("h3",no,[t[19]||(t[19]=C(" Detalles de Préstamo ")),(s=i.value)!=null&&s.id?(u(),c("span",ao,"#"+n(i.value.id),1)):k("",!0)]),i.value?(u(),c("div",io,[e("div",lo,[e("div",null,[e("p",co,[t[20]||(t[20]=e("strong",null,"Cliente:",-1)),C(" "+n(((v=i.value.cliente)==null?void 0:v.nombre_razon_social)||"Sin cliente"),1)]),e("p",uo,[t[21]||(t[21]=e("strong",null,"Monto Prestado:",-1)),C(" $"+n($(i.value.monto_prestado)),1)]),e("p",go,[t[22]||(t[22]=e("strong",null,"Tasa de Interés:",-1)),C(" "+n(i.value.tasa_interes_mensual)+"% ",1)]),e("p",po,[t[23]||(t[23]=e("strong",null,"Pago Periódico:",-1)),C(" $"+n($(i.value.pago_periodico)),1)])]),e("div",null,[e("p",mo,[t[24]||(t[24]=e("strong",null,"Estado:",-1)),e("span",{class:V([q(i.value.estado),"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ml-2"])},n(R(i.value.estado)),3)]),e("p",vo,[t[25]||(t[25]=e("strong",null,"Pagos Realizados:",-1)),C(" "+n(i.value.pagos_realizados)+" / "+n(i.value.numero_pagos),1)]),e("p",fo,[t[26]||(t[26]=e("strong",null,"Fecha de Inicio:",-1)),C(" "+n(W(i.value.fecha_inicio)),1)])])]),e("div",xo,[t[31]||(t[31]=e("h4",{class:"text-sm font-medium text-gray-900 mb-3"},"Resumen Financiero",-1)),e("div",bo,[e("div",null,[t[27]||(t[27]=e("p",{class:"text-gray-600"},"Total a Pagar:",-1)),e("p",ho,"$"+n($(i.value.monto_total_pagar)),1)]),e("div",null,[t[28]||(t[28]=e("p",{class:"text-gray-600"},"Total Pagado:",-1)),e("p",yo,"$"+n($(i.value.monto_pagado)),1)]),e("div",null,[t[29]||(t[29]=e("p",{class:"text-gray-600"},"Monto Pendiente:",-1)),e("p",_o,"$"+n($(i.value.monto_pendiente)),1)]),e("div",null,[t[30]||(t[30]=e("p",{class:"text-gray-600"},"Interés Total:",-1)),e("p",wo,"$"+n($(i.value.monto_interes_total)),1)])])])])):k("",!0),e("div",{class:"flex flex-wrap justify-end gap-2 mt-6"},[e("button",{onClick:he,class:"px-3 py-2 bg-amber-600 text-white rounded-lg hover:bg-amber-700 transition-colors text-sm"}," ✏️ Editar "),e("button",{onClick:T,class:"px-3 py-2 bg-gray-300 rounded-lg hover:bg-gray-400 transition-colors text-sm"}," Cerrar ")])])):k("",!0)],40,oo)])):k("",!0)]}),_:1}),E.value?(u(),c("div",ko,t[32]||(t[32]=[e("div",{class:"bg-white p-6 rounded-lg shadow-lg"},[e("div",{class:"flex items-center space-x-3"},[e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-500"}),e("span",{class:"text-gray-700"},"Procesando...")])],-1)]))):k("",!0)])],64)}}}),Fo=te(Co,[["__scopeId","data-v-88b8b961"]]);export{Fo as default};
