import{r as y,T as ue,c as G,p as pe,O,i as p,o as m,g as h,f as o,u as i,Z as me,q as ve,l as f,v as F,z as N,k as V,x as ge,F as $,m as B,t as b,n as R}from"./vendor-d19pJyVS.js";import{N as fe}from"./app-BcT2PLJy.js";import{A as be}from"./AppLayout-CcnrZQKI.js";import{_ as xe,a as ye,b as he}from"./BotonesAccion-DYwTTkJE.js";import{_ as _e,P as we}from"./ProductosSeleccionados-DXGsTgz6.js";import{_ as ke}from"./BuscarProducto-B_taEjGP.js";import{_ as Fe}from"./VistaPreviaModal-CAwANwka.js";import"./utils-Dq7h7Pqt.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Ce={class:"compras-create min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 p-6"},Se={class:"max-w-6xl mx-auto"},Pe={class:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden"},Ne={class:"p-6 grid grid-cols-1 md:grid-cols-2 gap-6"},$e={class:"relative"},Me={class:"relative"},je={class:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden"},Ae={class:"p-6"},Ee={class:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden"},Ve={class:"p-6"},Be=["value"],De={key:0,class:"mt-2 p-2 bg-blue-50 border border-blue-200 rounded-md"},Le={class:"text-xs text-blue-700"},qe={class:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden"},ze={class:"p-6"},Ie={key:0,class:"mb-6"},He={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4"},Ue=["onClick"],Te={class:"flex items-center justify-between mb-2"},Ge={class:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800"},Oe={class:"text-xs text-gray-500"},Re={class:"font-medium text-gray-900 text-sm mb-1"},Qe={key:0,class:"text-xs text-gray-500 mb-2"},Je={class:"space-y-1"},Xe={class:"flex justify-between text-sm"},Ye={class:"font-semibold text-green-600"},Ze={class:"flex justify-between text-sm"},Ke={class:"font-semibold text-blue-600"},We={class:"flex justify-between text-sm"},eo={key:1,class:"mt-2 pt-2 border-t border-gray-100"},oo={class:"space-y-1"},to={class:"text-gray-600"},ro={class:"font-medium"},so={key:1,class:"text-center py-8"},ao={class:"mt-6 pt-6 border-t border-gray-200"},no={class:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden"},lo={class:"p-6"},io={class:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden"},co={class:"p-6"},uo={class:"space-y-4"},C="C0001",_o=Object.assign({layout:be},{__name:"Create",props:{proveedores:{type:Array,default:()=>[]},productos:{type:Array,default:()=>[]},servicios:{type:Array,default:()=>[]},almacenes:{type:Array,default:()=>[]},almacen_predeterminado:{type:[String,Number],default:null},recordatorio_almacen:{type:String,default:null}},setup(Q){const J=new fe({duration:5e3,position:{x:"right",y:"top"},types:[{type:"success",background:"#10B981",icon:{className:"notyf__icon--success",tagName:"i",text:"✓"}},{type:"error",background:"#EF4444",icon:{className:"notyf__icon--error",tagName:"i",text:"✗"}},{type:"info",background:"#3B82F6",icon:{className:"notyf__icon--info",tagName:"i",text:"ℹ"}}]}),l=(t,e="success")=>{J.open({type:e,message:t})},x=Q,X=y([...x.proveedores]),S=()=>{const t=new Date,e=t.getFullYear(),r=String(t.getMonth()+1).padStart(2,"0"),a=String(t.getDate()).padStart(2,"0");return`${e}-${r}-${a}`},s=ue({numero_compra:C,fecha_compra:S(),proveedor_id:"",almacen_id:x.almacen_predeterminado||"",descuento_general:0,subtotal:0,descuento_items:0,iva:0,total:0,productos:[],notas:"",estado:"borrador"}),Y=y(null),v=y(null),n=y([]),d=y({}),g=y({}),c=y({}),M=y(!1),P=y(!0),D=y(null),L=G(()=>x.productos.filter(t=>t.nombre&&t.precio_compra>0&&t.codigo&&t.categoria)),Z=t=>{D.value=t;const e={id:t.id,tipo:"producto"};if(n.value.some(a=>a.id===t.id&&a.tipo==="producto"))l("Este producto ya está seleccionado","info");else{n.value.push(e);const a=`producto-${t.id}`;d.value[a]=1,g.value[a]=t.precio_compra||0,c.value[a]=0,_(),w(),l(`Producto seleccionado: ${t.nombre}`)}},q=t=>(Number.parseFloat(t)||0).toLocaleString("es-MX",{minimumFractionDigits:2,maximumFractionDigits:2}),K=(t,e)=>{try{localStorage.setItem(t,JSON.stringify(e))}catch(r){console.warn("No se pudo guardar en localStorage:",r)}},W=t=>{try{const e=localStorage.getItem(t);return e?JSON.parse(e):null}catch(e){return console.warn("No se pudo cargar desde localStorage:",e),null}},j=t=>{try{localStorage.removeItem(t)}catch(e){console.warn("No se pudo eliminar de localStorage:",e)}},ee=()=>{v.value&&s.almacen_id&&n.value.length>0?M.value=!0:l("Selecciona un proveedor, almacén y al menos un producto","error")},oe=t=>{var e;if(!t){v.value=null,s.proveedor_id="",w(),l("Selección de proveedor limpiada","info");return}((e=v.value)==null?void 0:e.id)!==t.id&&(v.value=t,s.proveedor_id=t.id,w(),l(`Proveedor seleccionado: ${t.nombre_razon_social}`))},te=t=>{if(!t||typeof t.id>"u"||!t.tipo){l("Producto inválido","error");return}const e={id:t.id,tipo:t.tipo};if(!n.value.some(a=>a.id===t.id&&a.tipo===t.tipo)){n.value.push(e);const a=`${t.tipo}-${t.id}`;d.value[a]=1;let u=0;t.tipo==="producto"?u=typeof t.precio_compra=="number"?t.precio_compra:0:u=typeof t.precio=="number"?t.precio:0,g.value[a]=u,c.value[a]=0,_(),w(),l(`Producto añadido: ${t.nombre||t.descripcion||"Item"}`)}},re=t=>{if(!t||typeof t.id>"u"||!t.tipo)return;const e=`${t.tipo}-${t.id}`;n.value=n.value.filter(r=>!(r.id===t.id&&r.tipo===r.tipo)),delete d.value[e],delete g.value[e],delete c.value[e],_(),w(),l(`Producto eliminado: ${t.nombre||t.descripcion||"Item"}`,"info")},se=(t,e)=>{const r=parseFloat(e);isNaN(r)||r<0||(d.value[t]=r,_(),w())},ae=(t,e)=>{const r=parseFloat(e);isNaN(r)||r<0||r>100||(c.value[t]=r,_(),w())},k=G(()=>{let t=0,e=0;n.value.forEach(I=>{const E=`${I.tipo}-${I.id}`,H=parseFloat(d.value[E])||0,U=parseFloat(g.value[E])||0,ce=parseFloat(c.value[E])||0;if(H>0&&U>=0){const T=H*U;e+=T*(ce/100),t+=T}});const r=parseFloat(s.descuento_general)||0,a=Math.max(0,t-e-r),u=a*.16,A=a+u;return{subtotal:parseFloat(t.toFixed(2)),descuentoItems:parseFloat(e.toFixed(2)),descuentoGeneral:parseFloat(r.toFixed(2)),subtotalConDescuentos:parseFloat(a.toFixed(2)),iva:parseFloat(u.toFixed(2)),total:parseFloat(A.toFixed(2))}}),_=()=>{s.subtotal=k.value.subtotal,s.descuento_items=k.value.descuentoItems,s.iva=k.value.iva,s.total=k.value.total},ne=()=>{if(!s.proveedor_id)return l("Selecciona un proveedor","error"),!1;if(!s.almacen_id)return l("Selecciona un almacén de recepción","error"),!1;if(n.value.length===0)return l("Agrega al menos un producto o servicio","error"),!1;for(const t of n.value){const e=`${t.tipo}-${t.id}`,r=parseFloat(c.value[e])||0,a=parseFloat(d.value[e])||0,u=parseFloat(g.value[e])||0;if(r<0||r>100)return l("Los descuentos deben estar entre 0% y 100%.","error"),!1;if(a<=0)return l("Las cantidades deben ser mayores a 0","error"),!1;if(u<0)return l("Los precios no pueden ser negativos","error"),!1}return!0},le=()=>{ne()&&(s.productos=n.value.map(t=>{const e=`${t.tipo}-${t.id}`;return{id:t.id,tipo:t.tipo,cantidad:parseFloat(d.value[e])||1,precio:parseFloat(g.value[e])||0,descuento:parseFloat(c.value[e])||0}}),_(),s.post(route("compras.store"),{onSuccess:()=>{j("compraEnProgreso"),n.value=[],d.value={},g.value={},c.value={},v.value=null,s.reset(),l("Compra creada con éxito")},onError:t=>{console.error("Errores de validación:",t);const e=Object.values(t)[0];Array.isArray(e)?l(e[0],"error"):l("Hubo errores de validación","error")}}))},ie=()=>{v.value=null,s.numero_compra=C,s.fecha_compra=S(),s.proveedor_id="",s.descuento_general=0,n.value=[],d.value={},g.value={},c.value={},s.notas="",j("compraEnProgreso"),l("Formulario limpiado correctamente")},w=()=>{const t={numero_compra:C,fecha_compra:s.fecha_compra,proveedor_id:s.proveedor_id,descuento_general:s.descuento_general,proveedor:v.value,selectedProducts:n.value,quantities:d.value,prices:g.value,discounts:c.value};K("compraEnProgreso",t)},z=t=>{(s.proveedor_id||n.value.length>0)&&(t.preventDefault(),t.returnValue="Tienes cambios sin guardar. ¿Estás seguro de que quieres salir?")},de=()=>{const t=S();s.fecha_compra!==t&&(s.fecha_compra=t)};return pe(()=>{l(`Número de compra fijo: ${C}`,"info");const t=W("compraEnProgreso");if(t&&typeof t=="object")try{s.numero_compra=C,s.fecha_compra=S(),s.proveedor_id=t.proveedor_id||"",s.descuento_general=t.descuento_general||0,v.value=t.proveedor||null,n.value=Array.isArray(t.selectedProducts)?t.selectedProducts:[],d.value=t.quantities||{},g.value=t.prices||{},c.value=t.discounts||{},_()}catch(r){console.warn("Error al cargar datos guardados:",r),j("compraEnProgreso")}const e=setInterval(()=>{de()},5*60*1e3);O(()=>{clearInterval(e)}),window.addEventListener("beforeunload",z)}),O(()=>{window.removeEventListener("beforeunload",z)}),(t,e)=>(m(),p($,null,[h(i(me),{title:"Crear Compra"}),o("div",Ce,[o("div",Se,[h(xe,{title:"Nueva Compra",description:"Crea una nueva compra para tus proveedores","can-preview":v.value&&i(s).almacen_id&&n.value.length>0,"back-url":t.route("compras.index"),"show-shortcuts":P.value,onPreview:ee,onCloseShortcuts:e[0]||(e[0]=r=>P.value=!1)},null,8,["can-preview","back-url","show-shortcuts"]),o("form",{onSubmit:ve(le,["prevent"]),class:"space-y-8"},[o("div",Pe,[e[16]||(e[16]=o("div",{class:"bg-gradient-to-r from-indigo-500 to-indigo-600 px-6 py-4"},[o("h2",{class:"text-lg font-semibold text-white flex items-center"},[o("svg",{class:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})]),f(" Información General ")])],-1)),o("div",Ne,[o("div",null,[e[11]||(e[11]=o("label",{for:"numero_compra",class:"block text-sm font-medium text-gray-700 mb-2 flex items-center gap-2"},[f(" Número de Compra * "),o("span",{class:"inline-flex items-center gap-1 px-2 py-1 bg-blue-100 text-blue-700 text-xs font-medium rounded-full"},[o("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})]),f(" Número fijo ")])],-1)),o("div",$e,[F(o("input",{id:"numero_compra","onUpdate:modelValue":e[1]||(e[1]=r=>i(s).numero_compra=r),type:"text",class:"w-full bg-gray-50 text-gray-500 cursor-not-allowed border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"C0001",readonly:"",required:""},null,512),[[N,i(s).numero_compra]]),e[10]||(e[10]=o("div",{class:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none"},[o("svg",{class:"w-5 h-5 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})])],-1))]),e[12]||(e[12]=o("p",{class:"mt-1 text-xs text-gray-500"}," Este número es fijo para todas las compras ",-1))]),o("div",null,[e[14]||(e[14]=o("label",{for:"fecha_compra",class:"block text-sm font-medium text-gray-700 mb-2 flex items-center gap-2"},[f(" Fecha de Compra * "),o("span",{class:"inline-flex items-center gap-1 px-2 py-1 bg-blue-100 text-blue-700 text-xs font-medium rounded-full"},[o("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})]),f(" Automática ")])],-1)),o("div",Me,[F(o("input",{id:"fecha_compra","onUpdate:modelValue":e[2]||(e[2]=r=>i(s).fecha_compra=r),type:"date",class:"w-full bg-gray-50 text-gray-500 cursor-not-allowed border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-indigo-500 focus:border-transparent",readonly:"",required:""},null,512),[[N,i(s).fecha_compra]]),e[13]||(e[13]=o("div",{class:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none"},[o("svg",{class:"w-5 h-5 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1))]),e[15]||(e[15]=o("p",{class:"mt-1 text-xs text-gray-500"}," Esta fecha se establece automáticamente con la fecha de creación ",-1))])])]),o("div",je,[e[17]||(e[17]=o("div",{class:"bg-gradient-to-r from-blue-500 to-blue-600 px-6 py-4"},[o("h2",{class:"text-lg font-semibold text-white flex items-center"},[o("svg",{class:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})]),f(" Información del Proveedor ")])],-1)),o("div",Ae,[h(_e,{proveedores:X.value,"proveedor-seleccionado":v.value,"label-busqueda":"Proveedor","placeholder-busqueda":"Buscar proveedor por nombre, RFC, email...",requerido:"",onProveedorSeleccionado:oe},null,8,["proveedores","proveedor-seleccionado"])])]),o("div",Ee,[e[22]||(e[22]=o("div",{class:"bg-gradient-to-r from-orange-500 to-orange-600 px-6 py-4"},[o("h2",{class:"text-lg font-semibold text-white flex items-center"},[o("svg",{class:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})]),f(" Almacén de Recepción ")])],-1)),o("div",Ve,[o("div",null,[e[20]||(e[20]=o("label",{for:"almacen_id",class:"block text-sm font-medium text-gray-700 mb-2"}," Almacén donde se recibirán los productos * ",-1)),F(o("select",{id:"almacen_id","onUpdate:modelValue":e[3]||(e[3]=r=>i(s).almacen_id=r),required:"",class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-all duration-200"},[e[18]||(e[18]=o("option",{value:""},"Seleccionar almacén",-1)),(m(!0),p($,null,B(x.almacenes,r=>(m(),p("option",{key:r.id,value:r.id},b(r.nombre),9,Be))),128))],512),[[ge,i(s).almacen_id]]),e[21]||(e[21]=o("p",{class:"mt-1 text-xs text-gray-500"}," Los productos comprados se agregarán automáticamente al inventario de este almacén ",-1)),x.recordatorio_almacen?(m(),p("div",De,[o("p",Le,[e[19]||(e[19]=o("svg",{class:"w-3 h-3 inline mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),f(" "+b(x.recordatorio_almacen),1)])])):V("",!0)])])]),o("div",qe,[e[29]||(e[29]=o("div",{class:"bg-gradient-to-r from-green-500 to-green-600 px-6 py-4"},[o("h2",{class:"text-lg font-semibold text-white flex items-center"},[o("svg",{class:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})]),f(" Productos Disponibles ")])],-1)),o("div",ze,[L.value.length>0?(m(),p("div",Ie,[e[27]||(e[27]=o("h3",{class:"text-sm font-medium text-gray-700 mb-3"},"Selecciona productos para comprar:",-1)),o("div",He,[(m(!0),p($,null,B(L.value,r=>{var a;return m(),p("div",{key:r.id,onClick:u=>Z(r),class:R(["p-4 border-2 rounded-lg cursor-pointer transition-all duration-200 hover:shadow-md",((a=D.value)==null?void 0:a.id)===r.id?"border-green-500 bg-green-50":"border-gray-200 hover:border-green-300 hover:bg-green-50"])},[o("div",Te,[o("span",Ge,b(r.codigo||"N/A"),1),o("span",Oe,b(r.unidad_medida),1)]),o("h4",Re,b(r.nombre),1),r.categoria?(m(),p("div",Qe,b(typeof r.categoria=="string"?r.categoria:r.categoria.nombre),1)):V("",!0),o("div",Je,[o("div",Xe,[e[23]||(e[23]=o("span",{class:"text-gray-600"},"Precio compra:",-1)),o("span",Ye,"$"+b(q(r.precio_compra)),1)]),o("div",Ze,[e[24]||(e[24]=o("span",{class:"text-gray-600"},"Precio venta:",-1)),o("span",Ke,"$"+b(q(r.precio_venta)),1)]),o("div",We,[e[25]||(e[25]=o("span",{class:"text-gray-600"},"Stock disponible:",-1)),o("span",{class:R(["font-semibold",r.stock_total>10?"text-green-600":r.stock_total>0?"text-yellow-600":"text-red-600"])},b(r.stock_total),3)])]),r.stock_por_almacen?(m(),p("div",eo,[e[26]||(e[26]=o("div",{class:"text-xs text-gray-500 mb-1"},"Stock por almacén:",-1)),o("div",oo,[(m(!0),p($,null,B(r.stock_por_almacen,(u,A)=>(m(),p("div",{key:A,class:"flex justify-between text-xs"},[o("span",to,b(u.almacen_nombre)+":",1),o("span",ro,b(u.cantidad),1)]))),128))])])):V("",!0)],10,Ue)}),128))])])):(m(),p("div",so,e[28]||(e[28]=[o("svg",{class:"w-16 h-16 mx-auto text-gray-400 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})],-1),o("p",{class:"text-gray-500 text-lg font-medium"},"No hay productos disponibles",-1),o("p",{class:"text-gray-400 text-sm mt-1"},"Los productos aparecerán aquí cuando tengan información completa",-1)]))),o("div",ao,[h(ke,{ref_key:"buscarProductoRef",ref:Y,productos:x.productos,servicios:x.servicios,onAgregarProducto:te},null,8,["productos","servicios"])]),h(we,{"selected-products":n.value,productos:x.productos,servicios:x.servicios,quantities:d.value,prices:g.value,discounts:c.value,onEliminarProducto:re,onUpdateQuantity:se,onUpdateDiscount:ae},null,8,["selected-products","productos","servicios","quantities","prices","discounts"])])]),o("div",no,[e[30]||(e[30]=o("div",{class:"bg-gradient-to-r from-purple-500 to-purple-600 px-6 py-4"},[o("h2",{class:"text-lg font-semibold text-white flex items-center"},[o("svg",{class:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})]),f(" Notas Adicionales ")])],-1)),o("div",lo,[F(o("textarea",{"onUpdate:modelValue":e[4]||(e[4]=r=>i(s).notas=r),class:"w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-vertical",rows:"4",placeholder:"Agrega notas adicionales, términos y condiciones, o información relevante para la compra..."},null,512),[[N,i(s).notas]])])]),o("div",io,[e[33]||(e[33]=o("div",{class:"bg-gradient-to-r from-red-500 to-red-600 px-6 py-4"},[o("h2",{class:"text-lg font-semibold text-white flex items-center"},[o("svg",{class:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})]),f(" Descuento General ")])],-1)),o("div",co,[o("div",uo,[o("div",null,[e[31]||(e[31]=o("label",{for:"descuento_general",class:"block text-sm font-medium text-gray-700 mb-2"}," Descuento General ($) ",-1)),F(o("input",{id:"descuento_general",type:"number",step:"0.01",min:"0","onUpdate:modelValue":e[5]||(e[5]=r=>i(s).descuento_general=r),class:"w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-red-500 focus:border-transparent",placeholder:"0.00"},null,512),[[N,i(s).descuento_general]]),e[32]||(e[32]=o("p",{class:"mt-1 text-xs text-gray-500"}," Este descuento se aplica al subtotal después de los descuentos por item ",-1))])])])]),h(ye,{"show-margin-calculator":!1,"margin-data":{costoTotal:0,precioVenta:0,ganancia:0,margenPorcentaje:0},totals:k.value,"item-count":n.value.length,"total-quantity":Object.values(d.value).reduce((r,a)=>r+(a||0),0),"onUpdate:descuentoGeneral":e[6]||(e[6]=r=>i(s).descuento_general=r)},null,8,["totals","item-count","total-quantity"]),h(he,{"back-url":t.route("compras.index"),"is-processing":i(s).processing,"can-submit":i(s).proveedor_id&&i(s).almacen_id&&n.value.length>0,"button-text":i(s).processing?"Guardando...":"Crear Compra",onLimpiar:ie},null,8,["back-url","is-processing","can-submit","button-text"])],32),o("button",{onClick:e[7]||(e[7]=r=>P.value=!P.value),class:"fixed bottom-4 left-4 bg-gray-600 text-white p-3 rounded-full shadow-lg hover:bg-gray-700 transition-colors duration-200",title:"Mostrar atajos de teclado"},e[34]||(e[34]=[o("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)])),h(Fe,{show:M.value,type:"compra",proveedor:v.value,items:n.value,totals:k.value,notas:i(s).notas,onClose:e[8]||(e[8]=r=>M.value=!1),onPrint:e[9]||(e[9]=()=>t.window.print())},null,8,["show","proveedor","items","totals","notas"])])])],64))}});export{_o as default};
