import{r as y,c as V,w as Pe,p as Se,O as $e,i as l,o as n,g as S,b as Fe,f as o,u as L,Z as Ne,e as de,l as E,U as Le,k as p,t as r,s as Me,F as D,m as q,n as O,q as ce,P as Ve,I as ze,N as h}from"./vendor-d19pJyVS.js";import{a as H}from"./utils-Dq7h7Pqt.js";import{N as Ie,F as z}from"./app-BcT2PLJy.js";import"./jspdf.es.min-BE3S9W4e.js";import{A as Te}from"./AppLayout-CcnrZQKI.js";import{P as Ae}from"./PedidosHeader-BSl_NYVt.js";import{_ as Be}from"./_plugin-vue_export-helper-DlAUqK2U.js";const De={class:"pedidos-index min-h-screen bg-gray-50"},Oe={class:"max-w-8xl mx-auto px-6 py-8"},Re={class:"flex justify-between items-center mb-4 text-sm text-gray-600"},Ue={class:"flex items-center space-x-2"},Xe=["value"],qe={class:"mt-6"},He={class:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden"},Ke={class:"bg-gradient-to-r from-gray-50 to-gray-100/50 px-6 py-4 border-b border-gray-200/60"},We={class:"flex items-center justify-between"},Ze={class:"text-sm text-gray-600 bg-white/70 px-3 py-1 rounded-full border border-gray-200/50"},Ge={class:"overflow-x-auto"},Je={class:"min-w-full divide-y divide-gray-200/60"},Qe={class:"bg-white divide-y divide-gray-200/40"},Ye={class:"px-6 py-4"},et={class:"flex flex-col space-y-0.5"},tt={class:"text-sm font-medium text-gray-900"},ot={class:"text-xs text-gray-500"},st={class:"px-6 py-4"},at={class:"flex flex-col space-y-0.5"},rt={class:"text-sm font-medium text-gray-900 group-hover:text-gray-800"},nt={key:0,class:"text-xs text-gray-500 truncate max-w-48"},lt={class:"px-6 py-4"},it={class:"text-sm font-mono font-medium text-gray-700 bg-gray-100/60 px-2 py-1 rounded-md inline-block"},dt={class:"px-6 py-4"},ct={class:"text-sm font-semibold text-gray-900"},ut={class:"px-6 py-4"},pt={class:"px-6 py-4"},vt={class:"flex items-center justify-end space-x-2"},gt=["onClick"],mt=["onClick"],ft=["onClick","title"],bt=["onClick"],xt=["onClick"],yt={key:1},ht={key:0,class:"flex justify-center items-center space-x-2 mt-6"},_t=["disabled"],wt={class:"flex space-x-1"},kt=["onClick"],Ct=["disabled"],Et=["onKeydown"],jt={key:0,class:"text-center"},Pt={key:1,class:"space-y-4"},St={class:"text-lg font-medium mb-1 flex items-center gap-2"},$t={key:0,class:"text-sm text-gray-500"},Ft={key:0,class:"space-y-4"},Nt={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},Lt={class:"text-sm text-gray-600"},Mt={key:0,class:"text-sm text-gray-600"},Vt={class:"text-sm text-gray-600"},zt={class:"text-sm text-gray-600"},It={class:"text-sm text-gray-600"},Tt={class:"text-sm text-gray-600"},At={class:"text-sm text-gray-600"},Bt={key:0,class:"mt-4"},Dt={class:"space-y-2"},Ot={class:"font-medium"},Rt={class:"text-sm text-gray-600 ml-2"},Ut={class:"font-medium"},Xt={class:"mt-4 p-4 bg-gray-50 rounded-lg border border-gray-200"},qt={class:"space-y-2 text-sm"},Ht={class:"flex justify-between"},Kt={class:"font-medium"},Wt={class:"flex justify-between"},Zt={class:"font-medium"},Gt={class:"flex justify-between border-t border-gray-300 pt-2"},Jt={class:"text-gray-900 font-bold"},Qt={class:"flex flex-wrap justify-end gap-2 mt-6"},Yt={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},eo=Object.assign({layout:Te},{__name:"IndexNew",props:{pedidos:{type:Object,default:()=>({data:[]})},stats:{type:Object,default:()=>({})},filterOptions:{type:Object,default:()=>({})},filters:{type:Object,default:()=>({})},sorting:{type:Object,default:()=>({sort_by:"created_at",sort_direction:"desc"})},pagination:{type:Object,default:()=>({})}},setup(ue){var oe,se,ae,re;const i=ue,m=new Ie({duration:4e3,position:{x:"right",y:"top"},types:[{type:"success",background:"#10b981",icon:!1},{type:"error",background:"#ef4444",icon:!1},{type:"warning",background:"#f59e0b",icon:!1}]}),C=y(!1),a=y(null),I=y("details"),F=y(null),$=y(!1),_=y(((oe=i.filters)==null?void 0:oe.search)??""),b=y((se=i.sorting)!=null&&se.sort_by?`${i.sorting.sort_by}-${i.sorting.sort_direction}`:"created_at-desc"),w=y(((ae=i.filters)==null?void 0:ae.estado)??""),k=y(((re=i.filters)==null?void 0:re.cliente_id)??""),T=y(10),x=V(()=>{const t=i.stats||{},e=t.total||0;return{total:e,borradores:t.borradores||0,pendientes:t.pendientes||0,confirmados:t.confirmados||0,enviados_venta:t.enviados_venta||0,cancelados:t.cancelados||0,con_cotizacion:t.con_cotizacion||0,sin_cotizacion:t.sin_cotizacion||0,borradoresPorcentaje:e>0?Math.round((t.borradores||0)/e*100):0,pendientesPorcentaje:e>0?Math.round((t.pendientes||0)/e*100):0,confirmadosPorcentaje:e>0?Math.round((t.confirmados||0)/e*100):0}}),v=V(()=>{var t,e,s,d,u,c;return{current_page:((t=i.pagination)==null?void 0:t.current_page)||1,last_page:((e=i.pagination)==null?void 0:e.last_page)||1,per_page:((s=i.pagination)==null?void 0:s.per_page)||10,from:((d=i.pagination)==null?void 0:d.from)||0,to:((u=i.pagination)==null?void 0:u.to)||0,total:((c=i.pagination)==null?void 0:c.total)||0}});function K(t){if(!(t!=null&&t.id))throw new Error("ID de pedido no válido");return!0}const pe=t=>{try{K(t),a.value=t,I.value="details",C.value=!0}catch(e){m.error(e.message)}},W=t=>{var e;try{const s=t||((e=a.value)==null?void 0:e.id);if(!s)throw new Error("ID de pedido no válido");h.visit(`/pedidos/${s}/edit`)}catch(s){m.error(s.message)}},ve=t=>{W(t)},Z=t=>{try{if(!t)throw new Error("ID de pedido no válido");F.value=t,I.value="confirm",C.value=!0}catch(e){m.error(e.message)}},ge=async()=>{try{if(!F.value)throw new Error("No se seleccionó ningún pedido");$.value=!0;const{data:t}=await H.post(`/pedidos/${F.value}/cancel`);if(t!=null&&t.success)m.success(t.message||"Pedido cancelado exitosamente"),C.value=!1,F.value=null,h.reload();else throw new Error((t==null?void 0:t.error)||"Error al cancelar el pedido")}catch(t){console.error("Error al cancelar:",t),m.error("Error al cancelar el pedido")}finally{$.value=!1}},G=async t=>{try{const e=t!=null&&t.id?t:a.value;K(e),$.value=!0,m.success("Enviando pedido a venta...");const{data:s}=await H.post(`/pedidos/${e.id}/enviar-a-venta`);if(s!=null&&s.success)m.success(s.message||"Pedido enviado a venta exitosamente"),C.value=!1,h.visit("/ventas");else throw new Error((s==null?void 0:s.error)||"No se pudo enviar a venta")}catch(e){console.error("Error al enviar a venta:",e),m.error("Error al enviar a venta")}finally{$.value=!1}},J=async t=>{var e;try{if(!((e=t.cliente)!=null&&e.email)){m.error("El cliente no tiene email configurado");return}$.value=!0,m.success(`Enviando pedido #${t.numero_pedido||t.id} por email...`);const{data:s}=await H.post(`/pedidos/${t.id}/enviar-email`,{},{headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}});if(s!=null&&s.success)m.success(s.message||"Pedido enviado por email exitosamente");else throw new Error((s==null?void 0:s.error)||"No se pudo enviar el email")}catch(s){console.error("Error al enviar email:",s),m.error("Error al enviar pedido por email")}finally{$.value=!1}},me=()=>{h.visit("/pedidos/create")},fe=t=>{_.value=t,h.get(route("pedidos.index"),{search:t,sort_by:b.value.split("-")[0],sort_direction:b.value.split("-")[1]||"desc",estado:w.value,cliente_id:k.value,per_page:T.value,page:1},{preserveState:!0,preserveScroll:!0})},be=t=>{w.value=t,h.get(route("pedidos.index"),{search:_.value,sort_by:b.value.split("-")[0],sort_direction:b.value.split("-")[1]||"desc",estado:t,cliente_id:k.value,per_page:T.value,page:1},{preserveState:!0,preserveScroll:!0})},xe=t=>{k.value=t,h.get(route("pedidos.index"),{search:_.value,sort_by:b.value.split("-")[0],sort_direction:b.value.split("-")[1]||"desc",estado:w.value,cliente_id:t,per_page:T.value,page:1},{preserveState:!0,preserveScroll:!0})},ye=t=>{b.value=t,h.get(route("pedidos.index"),{search:_.value,sort_by:t.split("-")[0],sort_direction:t.split("-")[1]||"desc",estado:w.value,cliente_id:k.value,per_page:T.value,page:1},{preserveState:!0,preserveScroll:!0})},he=t=>{h.get(route("pedidos.index"),{...i.filters,...i.sorting,per_page:t,page:1},{preserveState:!0,preserveScroll:!0})},R=t=>{h.get(route("pedidos.index"),{...i.filters,...i.sorting,page:t},{preserveState:!0,preserveScroll:!0})};V(()=>!!_.value||!!w.value||!!k.value);const _e=()=>{_.value="",b.value="created_at-desc",w.value="",k.value="",h.visit("/pedidos"),m.success("Filtros limpiados correctamente")},Q=y(null),we=()=>{var t;try{(t=Q.value)==null||t.focus()}catch{}};Pe(()=>C,t=>{t&&setTimeout(we,0)});const Y=t=>{t.key==="Escape"&&C.value&&A()};Se(()=>window.addEventListener("keydown",Y)),$e(()=>window.removeEventListener("keydown",Y));const ke=()=>{C.value=!1,a.value=null,F.value=null},Ce=()=>{ge()},A=()=>{C.value=!1,a.value=null,F.value=null},ee=t=>{if(!t)return"Fecha no disponible";try{return new Date(t).toLocaleDateString("es-MX",{day:"2-digit",month:"2-digit",year:"numeric"})}catch{return"Fecha inválida"}},Ee=t=>{if(!t)return"";try{return new Date(t).toLocaleTimeString("es-MX",{hour:"2-digit",minute:"2-digit"})}catch{return""}},N=t=>{const e=parseFloat(t),s=Number.isFinite(e)?e:0;return new Intl.NumberFormat("es-MX",{minimumFractionDigits:2,maximumFractionDigits:2}).format(s)},U={borrador:{label:"Borrador",classes:"bg-gray-100 text-gray-700",color:"bg-gray-400"},pendiente:{label:"Pendiente",classes:"bg-yellow-100 text-yellow-700",color:"bg-yellow-400"},confirmado:{label:"Confirmado",classes:"bg-blue-100 text-blue-700",color:"bg-blue-400"},enviado_venta:{label:"Enviado a Venta",classes:"bg-purple-100 text-purple-700",color:"bg-purple-400"},cancelado:{label:"Cancelado",classes:"bg-red-100 text-red-700",color:"bg-red-400"}},te=t=>{var e;return((e=U[t])==null?void 0:e.classes)||"bg-gray-100 text-gray-700"},je=t=>{var e;return((e=U[t])==null?void 0:e.color)||"bg-gray-400"},B=t=>{var e;return((e=U[t])==null?void 0:e.label)||"Pendiente"},X=V(()=>{if(!Array.isArray(i.pedidos.data))return[];let t=i.pedidos.data.slice();if(_.value){const e=_.value.toLowerCase().trim();t=t.filter(s=>{var g,f,j;const d=((f=(g=s.cliente)==null?void 0:g.nombre_razon_social)==null?void 0:f.toLowerCase())||"",u=String(s.numero_pedido||s.id||"").toLowerCase(),c=((j=s.estado)==null?void 0:j.toLowerCase())||"";return d.includes(e)||u.includes(e)||c.includes(e)})}if(w.value&&(t=t.filter(e=>e.estado===w.value)),k.value&&(t=t.filter(e=>{var s;return((s=e.cliente)==null?void 0:s.id)==k.value})),b.value){const[e,s]=b.value.split("-");t.sort((d,u)=>{var j,M;let c,g;switch(e){case"fecha":c=new Date(d.fecha||d.created_at).getTime()||0,g=new Date(u.fecha||u.created_at).getTime()||0;break;case"cliente":c=(((j=d.cliente)==null?void 0:j.nombre_razon_social)||"").toLowerCase(),g=(((M=u.cliente)==null?void 0:M.nombre_razon_social)||"").toLowerCase();break;case"total":c=parseFloat(d.total)||0,g=parseFloat(u.total)||0;break;case"estado":c=B(d.estado).toLowerCase(),g=B(u.estado).toLowerCase();break;default:c=(d[e]||"").toString().toLowerCase(),g=(u[e]||"").toString().toLowerCase()}const f=c<g?-1:c>g?1:0;return s==="desc"?-f:f})}return t});return V(()=>{const t=x.value.total||1;return{borradores:{label:"Borradores",icon:"document",color:"gray",description:"Pedidos en borrador",porcentaje:Math.round((x.value.borradores||0)/t*100)},pendientes:{label:"Pendientes",icon:"clock",color:"yellow",description:"Pedidos pendientes",porcentaje:Math.round((x.value.pendientes||0)/t*100)},confirmados:{label:"Confirmados",icon:"check-circle",color:"blue",description:"Pedidos confirmados",porcentaje:Math.round((x.value.confirmados||0)/t*100)},enviados_venta:{label:"Enviados a Venta",icon:"paper-plane",color:"purple",description:"Pedidos enviados a venta",porcentaje:Math.round((x.value.enviados_venta||0)/t*100)},cancelados:{label:"Cancelados",icon:"x-circle",color:"red",description:"Pedidos cancelados",porcentaje:Math.round((x.value.cancelados||0)/t*100)}}}),(t,e)=>(n(),l(D,null,[S(L(Ne),{title:"Pedidos"}),(n(),Fe(Le("style"),null,{default:de(()=>e[10]||(e[10]=[E(" @import url('https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css'); ")])),_:1})),o("div",De,[o("div",Oe,[S(Ae,{total:x.value.total,borradores:x.value.borradores,pendientes:x.value.pendientes,confirmados:x.value.confirmados,enviados_venta:x.value.enviados_venta,cancelados:x.value.cancelados,"filter-options":i.filterOptions,"search-term":_.value,"onUpdate:searchTerm":e[0]||(e[0]=s=>_.value=s),"sort-by":b.value,"onUpdate:sortBy":e[1]||(e[1]=s=>b.value=s),"filtro-estado":w.value,"onUpdate:filtroEstado":e[2]||(e[2]=s=>w.value=s),"filtro-cliente":k.value,"onUpdate:filtroCliente":e[3]||(e[3]=s=>k.value=s),onCrearNueva:me,onSearchChange:fe,onFiltroEstadoChange:be,onFiltroClienteChange:xe,onSortChange:ye,onLimpiarFiltros:_e},null,8,["total","borradores","pendientes","confirmados","enviados_venta","cancelados","filter-options","search-term","sort-by","filtro-estado","filtro-cliente"]),o("div",Re,[o("div",null," Mostrando "+r(v.value.from)+" - "+r(v.value.to)+" de "+r(v.value.total)+" pedidos ",1),o("div",Ue,[e[12]||(e[12]=o("span",null,"Elementos por página:",-1)),o("select",{value:v.value.per_page,onChange:e[4]||(e[4]=s=>he(parseInt(s.target.value))),class:"border border-gray-300 rounded px-2 py-1 text-sm"},e[11]||(e[11]=[Me('<option value="10" data-v-6d85cb38>10</option><option value="15" data-v-6d85cb38>15</option><option value="25" data-v-6d85cb38>25</option><option value="50" data-v-6d85cb38>50</option><option value="100" data-v-6d85cb38>100</option>',5)]),40,Xe)])]),o("div",qe,[o("div",He,[o("div",Ke,[o("div",We,[e[13]||(e[13]=o("h2",{class:"text-lg font-semibold text-gray-900 tracking-tight"},"Pedidos",-1)),o("div",Ze,r(X.value.length)+" de "+r(v.value.total)+" pedidos ",1)])]),o("div",Ge,[o("table",Je,[e[15]||(e[15]=o("thead",{class:"bg-gray-50/60"},[o("tr",null,[o("th",{class:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider"},"Fecha"),o("th",{class:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider"},"Cliente"),o("th",{class:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider"},"N° Pedido"),o("th",{class:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider"},"Total"),o("th",{class:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider"},"Estado"),o("th",{class:"px-6 py-4 text-right text-xs font-semibold text-gray-600 uppercase tracking-wider"},"Acciones")])],-1)),o("tbody",Qe,[X.value.length>0?(n(!0),l(D,{key:0},q(X.value,s=>{var d,u,c,g;return n(),l("tr",{key:s.id,class:"group hover:bg-gray-50/60 transition-all duration-150 hover:shadow-sm"},[o("td",Ye,[o("div",et,[o("div",tt,r(ee(s.fecha||s.created_at)),1),o("div",ot,r(Ee(s.fecha||s.created_at)),1)])]),o("td",st,[o("div",at,[o("div",rt,r(((d=s.cliente)==null?void 0:d.nombre_razon_social)||"Sin cliente"),1),(u=s.cliente)!=null&&u.email?(n(),l("div",nt,r((c=s.cliente)==null?void 0:c.email),1)):p("",!0)])]),o("td",lt,[o("div",it,r(s.numero_pedido||"N/A"),1)]),o("td",dt,[o("div",ct," $"+r(N(s.total||0)),1)]),o("td",ut,[o("span",{class:O([te(s.estado),"inline-flex items-center px-3 py-1.5 rounded-full text-xs font-medium transition-all duration-150 hover:shadow-sm"])},[o("span",{class:O(["w-2 h-2 rounded-full mr-2 transition-all duration-150",je(s.estado)])},null,2),E(" "+r(B(s.estado)),1)],2)]),o("td",pt,[o("div",vt,[o("button",{onClick:f=>pe(s),class:"group/btn relative inline-flex items-center justify-center w-8 h-8 rounded-lg bg-blue-50 text-blue-600 hover:bg-blue-100 hover:text-blue-700 hover:shadow-sm transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:ring-offset-1",title:"Ver detalles"},[S(L(z),{icon:"eye",class:"w-3.5 h-3.5 transition-transform duration-200 group-hover/btn:scale-110"})],8,gt),["borrador","pendiente"].includes(s.estado)?(n(),l("button",{key:0,onClick:f=>W(s.id),class:"group/btn relative inline-flex items-center justify-center w-8 h-8 rounded-lg bg-amber-50 text-amber-600 hover:bg-amber-100 hover:text-amber-700 hover:shadow-sm transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-amber-500/50 focus:ring-offset-1",title:"Editar pedido"},[S(L(z),{icon:"edit",class:"w-3.5 h-3.5 transition-transform duration-200 group-hover/btn:scale-110"})],8,mt)):p("",!0),(g=s.cliente)!=null&&g.email?(n(),l("button",{key:1,onClick:f=>J(s),class:"group/btn relative inline-flex items-center justify-center w-8 h-8 rounded-lg bg-green-50 text-green-600 hover:bg-green-100 hover:text-green-700 hover:shadow-sm transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-green-500/50 focus:ring-offset-1",title:s.email_enviado?"Reenviar por Email":"Enviar por Email"},[S(L(z),{icon:s.email_enviado?"envelope-open":"envelope",class:"w-3.5 h-3.5 transition-transform duration-200 group-hover/btn:scale-110"},null,8,["icon"])],8,ft)):p("",!0),["confirmado","en_preparacion","listo_entrega","entregado","borrador"].includes(s.estado)?(n(),l("button",{key:2,onClick:f=>G(s),class:"group/btn relative inline-flex items-center justify-center w-8 h-8 rounded-lg bg-purple-50 text-purple-600 hover:bg-purple-100 hover:text-purple-700 hover:shadow-sm transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-purple-500/50 focus:ring-offset-1",title:"Enviar a venta"},[S(L(z),{icon:"shopping-cart",class:"w-3.5 h-3.5 transition-transform duration-200 group-hover/btn:scale-110"})],8,bt)):p("",!0),s.estado!=="cancelado"?(n(),l("button",{key:3,onClick:f=>Z(s.id),class:"group/btn relative inline-flex items-center justify-center w-8 h-8 rounded-lg bg-red-50 text-red-600 hover:bg-red-100 hover:text-red-700 hover:shadow-sm transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-red-500/50 focus:ring-offset-1",title:"Cancelar pedido"},[S(L(z),{icon:"times-circle",class:"w-3.5 h-3.5 transition-transform duration-200 group-hover/btn:scale-110"})],8,xt)):p("",!0)])])])}),128)):(n(),l("tr",yt,e[14]||(e[14]=[o("td",{colspan:6,class:"px-6 py-16 text-center"},[o("div",{class:"flex flex-col items-center space-y-4"},[o("div",{class:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center"},[o("svg",{class:"w-8 h-8 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})])]),o("div",{class:"space-y-1"},[o("p",{class:"text-gray-700 font-medium"},"No hay pedidos"),o("p",{class:"text-sm text-gray-500"},"Los pedidos aparecerán aquí cuando se creen")])])],-1)])))])])])])]),v.value.last_page>1?(n(),l("div",ht,[o("button",{onClick:e[5]||(e[5]=s=>R(v.value.current_page-1)),disabled:v.value.current_page===1,class:"px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," Anterior ",8,_t),o("div",wt,[(n(!0),l(D,null,q([v.value.current_page-1,v.value.current_page,v.value.current_page+1].filter(s=>s>0&&s<=v.value.last_page),s=>(n(),l("button",{key:s,onClick:d=>R(s),class:O(["px-3 py-2 text-sm font-medium border border-gray-300 rounded-md",s===v.value.current_page?"bg-blue-500 text-white border-blue-500":"text-gray-700 bg-white hover:bg-gray-50"])},r(s),11,kt))),128))]),o("button",{onClick:e[6]||(e[6]=s=>R(v.value.current_page+1)),disabled:v.value.current_page===v.value.last_page,class:"px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," Siguiente ",8,Ct)])):p("",!0)]),S(ze,{name:"modal"},{default:de(()=>{var s,d,u,c,g,f,j,M,ne,le,ie;return[C.value?(n(),l("div",{key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:ce(A,["self"])},[o("div",{class:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-y-auto p-6 outline-none",role:"dialog","aria-modal":"true","aria-label":"Modal de Pedido",tabindex:"-1",ref_key:"modalRef",ref:Q,onKeydown:Ve(ce(A,["prevent"]),["esc"])},[I.value==="confirm"?(n(),l("div",jt,[e[16]||(e[16]=o("div",{class:"w-12 h-12 mx-auto bg-red-100 rounded-full flex items-center justify-center mb-4"},[o("svg",{class:"w-6 h-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"})])],-1)),e[17]||(e[17]=o("h3",{class:"text-lg font-medium mb-2"}," ¿Cancelar pedido? ",-1)),e[18]||(e[18]=o("p",{class:"text-gray-600 mb-6"}," Esta acción no se puede deshacer. ",-1)),o("div",{class:"flex gap-3"},[o("button",{onClick:ke,class:"flex-1 px-4 py-2 bg-gray-200 rounded-lg hover:bg-gray-300 transition-colors"}," Cancelar "),o("button",{onClick:Ce,class:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors"}," Cancelar Pedido ")])])):I.value==="details"?(n(),l("div",Pt,[o("h3",St,[e[19]||(e[19]=E(" Detalles de Pedido ")),(s=a.value)!=null&&s.id?(n(),l("span",$t,"#"+r(a.value.id),1)):p("",!0)]),a.value?(n(),l("div",Ft,[o("div",Nt,[o("div",null,[o("p",Lt,[e[20]||(e[20]=o("strong",null,"Cliente:",-1)),E(" "+r(((d=a.value.cliente)==null?void 0:d.nombre_razon_social)||"Sin cliente"),1)]),(u=a.value.cliente)!=null&&u.email?(n(),l("p",Mt,[e[21]||(e[21]=o("strong",null,"Email:",-1)),E(" "+r(a.value.cliente.email),1)])):p("",!0),o("p",Vt,[e[22]||(e[22]=o("strong",null,"Fecha:",-1)),E(" "+r(ee(a.value.fecha||a.value.created_at)),1)]),o("p",zt,[e[23]||(e[23]=o("strong",null,"Estado:",-1)),o("span",{class:O([te(a.value.estado),"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"])},r(B(a.value.estado)),3)])]),o("div",null,[o("p",It,[e[24]||(e[24]=o("strong",null,"N° Pedido:",-1)),E(" "+r(a.value.numero_pedido||"N/A"),1)]),o("p",Tt,[e[25]||(e[25]=o("strong",null,"Total:",-1)),E(" $"+r(N(a.value.total||0)),1)]),o("p",At,[e[26]||(e[26]=o("strong",null,"Productos:",-1)),E(" "+r(((c=a.value.productos)==null?void 0:c.length)||0)+" items ",1)])])]),(g=a.value.productos)!=null&&g.length?(n(),l("div",Bt,[e[27]||(e[27]=o("h4",{class:"text-sm font-medium text-gray-900 mb-2"},"Productos",-1)),o("div",Dt,[(n(!0),l(D,null,q(a.value.productos,P=>(n(),l("div",{key:P.id,class:"flex justify-between items-center p-3 bg-gray-50 rounded-lg"},[o("div",null,[o("span",Ot,r(P.nombre),1),o("span",Rt,"x"+r(P.cantidad),1)]),o("span",Ut,"$"+r(N((P.cantidad||0)*(P.precio||0))),1)]))),128))])])):p("",!0),o("div",Xt,[o("div",qt,[o("div",Ht,[e[28]||(e[28]=o("span",{class:"text-gray-600"},"Subtotal:",-1)),o("span",Kt,"$"+r(N(a.value.subtotal||0)),1)]),o("div",Wt,[e[29]||(e[29]=o("span",{class:"text-gray-600"},"IVA:",-1)),o("span",Zt,"$"+r(N(a.value.iva||0)),1)]),o("div",Gt,[e[30]||(e[30]=o("span",{class:"text-gray-900 font-semibold"},"Total:",-1)),o("span",Jt,"$"+r(N(a.value.total||0)),1)])])])])):p("",!0),o("div",Qt,[["borrador","pendiente"].includes((f=a.value)==null?void 0:f.estado)?(n(),l("button",{key:0,onClick:ve,class:"px-3 py-2 bg-amber-600 text-white rounded-lg hover:bg-amber-700 transition-colors text-sm"}," ✏️ Editar ")):p("",!0),(M=(j=a.value)==null?void 0:j.cliente)!=null&&M.email?(n(),l("button",{key:1,onClick:e[7]||(e[7]=P=>J(a.value)),class:"px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-sm"},r((ne=a.value)!=null&&ne.email_enviado?"📨 Reenviar Email":"📧 Enviar Email"),1)):p("",!0),["confirmado","en_preparacion","listo_entrega","entregado","borrador"].includes((le=a.value)==null?void 0:le.estado)?(n(),l("button",{key:2,onClick:e[8]||(e[8]=P=>G(a.value)),class:"px-3 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors text-sm"}," 🛒 Enviar a Venta ")):p("",!0),((ie=a.value)==null?void 0:ie.estado)!=="cancelado"?(n(),l("button",{key:3,onClick:e[9]||(e[9]=P=>Z(a.value.id)),class:"px-3 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors text-sm"}," ❌ Cancelar ")):p("",!0),o("button",{onClick:A,class:"px-3 py-2 bg-gray-300 rounded-lg hover:bg-gray-400 transition-colors text-sm"}," Cerrar ")])])):p("",!0)],40,Et)])):p("",!0)]}),_:1}),$.value?(n(),l("div",Yt,e[31]||(e[31]=[o("div",{class:"bg-white p-6 rounded-lg shadow-lg"},[o("div",{class:"flex items-center space-x-3"},[o("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),o("span",{class:"text-gray-700"},"Procesando...")])],-1)]))):p("",!0)])],64))}}),io=Be(eo,[["__scopeId","data-v-6d85cb38"]]);export{io as default};
