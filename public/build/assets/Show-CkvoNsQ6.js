import{r as y,c as A,b as L,o as d,e as v,f as t,i as u,k as g,t as s,n as E,g as P,u as k,A as C,l as p,J as B,q as D,v as j,x as I,z as M,N as F}from"./vendor-d19pJyVS.js";import{A as R}from"./AppLayout-CcnrZQKI.js";import{N as U}from"./app-BcT2PLJy.js";import"./utils-Dq7h7Pqt.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const X={class:"flex justify-between items-center"},J={class:"flex space-x-2"},_={class:"py-12"},G={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},K={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},H={class:"p-6 bg-white border-b border-gray-200"},Q={class:"mb-6"},W={class:"grid grid-cols-1 md:grid-cols-2 gap-x-4 gap-y-6"},Y={class:"mt-1 text-sm text-gray-900"},Z={class:"mt-1"},tt={class:"mt-1 text-sm text-gray-900"},et={class:"mt-1 text-sm text-gray-900"},ot={class:"mb-6"},st={class:"bg-gray-50 p-4 rounded-lg"},at={class:"grid grid-cols-1 md:grid-cols-2 gap-x-4 gap-y-6"},nt={class:"mt-1 text-sm text-gray-900"},rt={class:"mt-1 text-sm text-gray-900"},lt={class:"mt-1 text-sm text-gray-900"},dt={class:"mt-1 text-sm text-gray-900"},it={class:"mb-6"},ut={class:"bg-blue-50 p-4 rounded-lg"},gt={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},mt={class:"text-center"},ct={class:"text-2xl font-bold text-blue-600"},xt={class:"text-center"},ft={class:"text-2xl font-bold text-green-600"},bt={class:"text-center"},yt={class:"text-2xl font-bold text-red-600"},vt={class:"mt-4"},pt={class:"flex justify-between text-sm text-gray-600 mb-1"},wt={class:"w-full bg-gray-200 rounded-full h-2"},ht={key:0,class:"mb-6"},Pt={class:"bg-green-50 p-4 rounded-lg"},kt={class:"grid grid-cols-1 md:grid-cols-2 gap-x-4 gap-y-6"},Ct={class:"mt-1"},jt={class:"mt-1 text-sm text-gray-900"},Nt={class:"mt-1 text-sm text-gray-900"},Mt={key:0,class:"mt-4"},Tt={class:"mt-1 text-sm text-gray-700 bg-white p-3 rounded border"},St={key:1,class:"mb-6"},Et={class:"bg-yellow-50 p-4 rounded-lg"},Dt={class:"text-sm text-gray-700 whitespace-pre-line"},Ft={class:"mb-6"},Vt={class:"bg-gray-50 p-4 rounded-lg"},qt={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"},Ot={class:"space-y-2"},$t={class:"flex justify-between"},zt={class:"font-semibold"},At={class:"flex justify-between"},Lt={class:"font-semibold text-green-600"},Bt={class:"flex justify-between"},It={class:"font-semibold text-red-600"},Rt={class:"flex flex-col justify-center space-y-2"},Ut={key:2,class:"text-center"},Xt={class:"border-t border-gray-200 pt-4"},Jt={class:"bg-white rounded-lg shadow-xl w-full max-w-md max-h-[90vh] overflow-y-auto"},_t={class:"flex items-center justify-between p-6 border-b border-gray-200"},Gt={class:"p-6"},Kt={class:"space-y-4"},Ht={class:"bg-gray-50 p-4 rounded-lg"},Qt={class:"flex justify-between items-center mb-2"},Wt={class:"text-sm text-gray-900"},Yt={class:"flex justify-between items-center mb-2"},Zt={class:"text-sm text-gray-900"},te={class:"flex justify-between items-center"},ee={class:"text-lg font-bold text-gray-900"},oe={class:"flex justify-end gap-3 px-6 py-4 border-t border-gray-200 bg-gray-50"},se=["disabled"],ae={class:"bg-white rounded-lg shadow-xl w-full max-w-md max-h-[90vh] overflow-y-auto"},ne={class:"flex items-center justify-between p-6 border-b border-gray-200"},re={class:"p-6"},le={class:"space-y-4"},de={class:"bg-gray-50 p-4 rounded-lg"},ie={class:"flex justify-between items-center mb-2"},ue={class:"text-sm text-gray-900"},ge={class:"flex justify-between items-center mb-2"},me={class:"text-sm text-gray-900"},ce={class:"flex justify-between items-center"},xe={class:"text-lg font-bold text-gray-900"},fe={class:"flex justify-between items-center"},be={class:"text-lg font-bold text-red-600"},ye=["max"],ve={class:"text-xs text-gray-500 mt-1"},pe={class:"flex justify-end gap-3 px-6 py-4 border-t border-gray-200 bg-gray-50"},we=["disabled"],Ne={__name:"Show",props:{cuenta:{type:Object,required:!0}},setup(o){const l=new U({duration:4e3,position:{x:"right",y:"top"},types:[{type:"success",background:"#10b981",icon:!1},{type:"error",background:"#ef4444",icon:!1},{type:"warning",background:"#f59e0b",icon:!1}]}),m=o,c=y(!1),x=y(!1),f=y(""),w=y(""),i=y(""),h=y(""),V=new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}),N=a=>{if(a==null)return 0;const e=Number(a);return Number.isFinite(e)?e:0},r=a=>V.format(N(a)),T=A(()=>{var n,S;const a=N((n=m.cuenta)==null?void 0:n.monto_total);if(a<=0)return 0;const b=N((S=m.cuenta)==null?void 0:S.monto_pagado)/a*100;return Math.min(100,Math.max(0,Math.round(b)))}),q=a=>({efectivo:"Efectivo",transferencia:"Transferencia",cheque:"Cheque",tarjeta:"Tarjeta",otros:"Otros"})[a]||a||"No especificado",O=a=>({efectivo:"bg-green-100 text-green-800",transferencia:"bg-blue-100 text-blue-800",cheque:"bg-purple-100 text-purple-800",tarjeta:"bg-orange-100 text-orange-800",otros:"bg-gray-100 text-gray-800"})[a]||"bg-gray-100 text-gray-800",$=async()=>{if(!f.value){l.error("Debe seleccionar un método de pago");return}try{const e=await(await fetch(route("cuentas-por-pagar.marcar-pagado",m.cuenta.id),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify({metodo_pago:f.value,notas_pago:w.value||null})})).json();e.success?(l.success("Cuenta marcada como pagada exitosamente"),c.value=!1,f.value="",w.value="",F.reload()):l.error(e.error||"Error al marcar como pagada")}catch{l.error("Error de conexión")}},z=async()=>{const a=parseFloat(i.value);if(!i.value||isNaN(a)||a<=0){l.error("Debe ingresar un monto válido mayor a cero");return}if(a>m.cuenta.monto_pendiente){l.error(`El monto no puede ser mayor al pendiente de ${r(m.cuenta.monto_pendiente)}`);return}try{const e=await fetch(route("cuentas-por-pagar.registrar-pago",m.cuenta.id),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify({monto:a,notas:h.value||null})});if(e.ok)l.success("Pago parcial registrado exitosamente"),x.value=!1,i.value="",h.value="",F.reload();else{const b=await e.json();l.error(b.message||"Error al registrar el pago parcial")}}catch{l.error("Error de conexión")}};return(a,e)=>(d(),L(R,{title:"Detalles de Cuenta por Pagar"},{header:v(()=>[t("div",X,[e[14]||(e[14]=t("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Detalles de Cuenta por Pagar ",-1)),t("div",J,[P(k(C),{href:a.route("cuentas-por-pagar.edit",o.cuenta.id),class:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded"},{default:v(()=>e[12]||(e[12]=[p(" Editar ")])),_:1},8,["href"]),P(k(C),{href:a.route("cuentas-por-pagar.index"),class:"bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded"},{default:v(()=>e[13]||(e[13]=[p(" Volver ")])),_:1},8,["href"])])])]),default:v(()=>{var b;return[t("div",_,[t("div",G,[t("div",K,[t("div",H,[t("div",Q,[e[19]||(e[19]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Información General",-1)),t("dl",W,[t("div",null,[e[15]||(e[15]=t("dt",{class:"text-sm font-medium text-gray-500"},"ID de Cuenta",-1)),t("dd",Y,"#"+s(o.cuenta.id),1)]),t("div",null,[e[16]||(e[16]=t("dt",{class:"text-sm font-medium text-gray-500"},"Estado",-1)),t("dd",Z,[t("span",{class:E([{"bg-red-100 text-red-800":o.cuenta.estado==="vencido","bg-yellow-100 text-yellow-800":o.cuenta.estado==="parcial","bg-green-100 text-green-800":o.cuenta.estado==="pagado","bg-gray-100 text-gray-800":o.cuenta.estado==="pendiente"},"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"])},s(o.cuenta.estado),3)])]),t("div",null,[e[17]||(e[17]=t("dt",{class:"text-sm font-medium text-gray-500"},"Fecha de Creación",-1)),t("dd",tt,s(new Date(o.cuenta.created_at).toLocaleDateString()),1)]),t("div",null,[e[18]||(e[18]=t("dt",{class:"text-sm font-medium text-gray-500"},"Fecha de Vencimiento",-1)),t("dd",et,s(o.cuenta.fecha_vencimiento?new Date(o.cuenta.fecha_vencimiento).toLocaleDateString():"No especificada"),1)])])]),t("div",ot,[e[24]||(e[24]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Información de la Compra",-1)),t("div",st,[t("dl",at,[t("div",null,[e[20]||(e[20]=t("dt",{class:"text-sm font-medium text-gray-500"},"Número de Compra",-1)),t("dd",nt,[P(k(C),{href:a.route("compras.show",o.cuenta.compra.id),class:"text-blue-600 hover:text-blue-800"},{default:v(()=>[p(s(o.cuenta.compra.numero_compra),1)]),_:1},8,["href"])])]),t("div",null,[e[21]||(e[21]=t("dt",{class:"text-sm font-medium text-gray-500"},"Proveedor",-1)),t("dd",rt,s(o.cuenta.compra.proveedor.nombre_razon_social),1)]),t("div",null,[e[22]||(e[22]=t("dt",{class:"text-sm font-medium text-gray-500"},"Total de la Compra",-1)),t("dd",lt,s(o.cuenta.compra?r(o.cuenta.compra.total):"N/A"),1)]),t("div",null,[e[23]||(e[23]=t("dt",{class:"text-sm font-medium text-gray-500"},"Estado de la Compra",-1)),t("dd",dt,s(o.cuenta.compra.estado),1)])])])]),t("div",it,[e[29]||(e[29]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Estado de Pagos",-1)),t("div",ut,[t("div",gt,[t("div",mt,[t("div",ct,s(r(o.cuenta.monto_total)),1),e[25]||(e[25]=t("div",{class:"text-sm text-blue-600"},"Monto Total",-1))]),t("div",xt,[t("div",ft,s(r(o.cuenta.monto_pagado)),1),e[26]||(e[26]=t("div",{class:"text-sm text-green-600"},"Monto Pagado",-1))]),t("div",bt,[t("div",yt,s(r(o.cuenta.monto_pendiente)),1),e[27]||(e[27]=t("div",{class:"text-sm text-red-600"},"Monto Pendiente",-1))])]),t("div",vt,[t("div",pt,[e[28]||(e[28]=t("span",null,"Progreso de Pago",-1)),t("span",null,s(T.value)+"%",1)]),t("div",wt,[t("div",{class:"bg-blue-600 h-2 rounded-full",style:B({width:T.value+"%"})},null,4)])])])]),o.cuenta.pagado?(d(),u("div",ht,[e[35]||(e[35]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Información de Pago",-1)),t("div",Pt,[t("div",kt,[e[33]||(e[33]=t("div",null,[t("dt",{class:"text-sm font-medium text-gray-500"},"Estado de Pago"),t("dd",{class:"mt-1"},[t("span",{class:"bg-green-100 text-green-800 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"}," Pagado ")])],-1)),t("div",null,[e[30]||(e[30]=t("dt",{class:"text-sm font-medium text-gray-500"},"Método de Pago",-1)),t("dd",Ct,[t("span",{class:E([O(o.cuenta.metodo_pago),"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"])},s(q(o.cuenta.metodo_pago)),3)])]),t("div",null,[e[31]||(e[31]=t("dt",{class:"text-sm font-medium text-gray-500"},"Fecha de Pago",-1)),t("dd",jt,s(new Date(o.cuenta.fecha_pago).toLocaleDateString()),1)]),t("div",null,[e[32]||(e[32]=t("dt",{class:"text-sm font-medium text-gray-500"},"Pagado Por",-1)),t("dd",Nt,s(((b=o.cuenta.pagado_por_usuario)==null?void 0:b.name)||"Usuario no encontrado"),1)])]),o.cuenta.notas_pago?(d(),u("div",Mt,[e[34]||(e[34]=t("dt",{class:"text-sm font-medium text-gray-500"},"Notas de Pago",-1)),t("dd",Tt,s(o.cuenta.notas_pago),1)])):g("",!0)])])):g("",!0),o.cuenta.notas?(d(),u("div",St,[e[36]||(e[36]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Notas",-1)),t("div",Et,[t("p",Dt,s(o.cuenta.notas),1)])])):g("",!0),t("div",Ft,[e[43]||(e[43]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Gestión de Pagos",-1)),t("div",Vt,[t("div",qt,[t("div",Ot,[t("div",$t,[e[37]||(e[37]=t("span",{class:"text-sm text-gray-600"},"Total de la cuenta:",-1)),t("span",zt,s(r(o.cuenta.monto_total)),1)]),t("div",At,[e[38]||(e[38]=t("span",{class:"text-sm text-gray-600"},"Pagado hasta ahora:",-1)),t("span",Lt,s(r(o.cuenta.monto_pagado)),1)]),t("div",Bt,[e[39]||(e[39]=t("span",{class:"text-sm text-gray-600"},"Pendiente:",-1)),t("span",It,s(r(o.cuenta.monto_pendiente)),1)])]),t("div",Rt,[o.cuenta.monto_pendiente>0?(d(),u("button",{key:0,onClick:e[0]||(e[0]=n=>x.value=!0),class:"bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded text-sm"}," + Registrar Pago Parcial ")):g("",!0),!o.cuenta.pagado&&o.cuenta.monto_pendiente>0?(d(),u("button",{key:1,onClick:e[1]||(e[1]=n=>c.value=!0),class:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded text-sm"}," ✓ Marcar como Pagado ")):g("",!0),o.cuenta.pagado?(d(),u("div",Ut,e[40]||(e[40]=[t("span",{class:"bg-green-100 text-green-800 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"}," Cuenta Completamente Pagada ",-1)]))):g("",!0)])]),t("div",Xt,[e[42]||(e[42]=t("p",{class:"text-xs text-gray-500 mb-2"},[t("strong",null,"Nota:"),p(" Los pagos parciales se registran en el historial de notas. Para ver el historial detallado, edita la cuenta. ")],-1)),P(k(C),{href:a.route("cuentas-por-pagar.edit",o.cuenta.id),class:"text-blue-600 hover:text-blue-800 text-sm font-medium"},{default:v(()=>e[41]||(e[41]=[p(" Ver historial completo de pagos → ")])),_:1},8,["href"])])])])])])])]),c.value?(d(),u("div",{key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:e[6]||(e[6]=D(n=>c.value=!1,["self"]))},[t("div",Jt,[t("div",_t,[e[45]||(e[45]=t("h3",{class:"text-lg font-medium text-gray-900"},"Marcar Cuenta como Pagada",-1)),t("button",{onClick:e[2]||(e[2]=n=>c.value=!1),class:"text-gray-400 hover:text-gray-600 transition-colors"},e[44]||(e[44]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),t("div",Gt,[t("div",Kt,[t("div",Ht,[t("div",Qt,[e[46]||(e[46]=t("span",{class:"text-sm font-medium text-gray-700"},"Cuenta:",-1)),t("span",Wt,"#"+s(o.cuenta.id),1)]),t("div",Yt,[e[47]||(e[47]=t("span",{class:"text-sm font-medium text-gray-700"},"Proveedor:",-1)),t("span",Zt,s(o.cuenta.compra.proveedor.nombre_razon_social),1)]),t("div",te,[e[48]||(e[48]=t("span",{class:"text-sm font-medium text-gray-700"},"Monto Total:",-1)),t("span",ee,s(r(o.cuenta.monto_total)),1)])]),t("div",null,[e[50]||(e[50]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Método de Pago *",-1)),j(t("select",{"onUpdate:modelValue":e[3]||(e[3]=n=>f.value=n),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:""},e[49]||(e[49]=[t("option",{value:""},"Seleccionar método de pago",-1),t("option",{value:"efectivo"},"Efectivo",-1),t("option",{value:"transferencia"},"Transferencia",-1),t("option",{value:"cheque"},"Cheque",-1),t("option",{value:"tarjeta"},"Tarjeta",-1),t("option",{value:"otros"},"Otros",-1)]),512),[[I,f.value]])]),t("div",null,[e[51]||(e[51]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Notas de Pago (opcional)",-1)),j(t("textarea",{"onUpdate:modelValue":e[4]||(e[4]=n=>w.value=n),rows:"3",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Agregar notas sobre el pago..."},null,512),[[M,w.value]])])])]),t("div",oe,[t("button",{onClick:e[5]||(e[5]=n=>c.value=!1),class:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-colors"}," Cancelar "),t("button",{onClick:$,disabled:!f.value,class:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"}," Marcar como Pagado ",8,se)])])])):g("",!0),x.value?(d(),u("div",{key:1,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:e[11]||(e[11]=D(n=>x.value=!1,["self"]))},[t("div",ae,[t("div",ne,[e[53]||(e[53]=t("h3",{class:"text-lg font-medium text-gray-900"},"Registrar Pago Parcial",-1)),t("button",{onClick:e[7]||(e[7]=n=>x.value=!1),class:"text-gray-400 hover:text-gray-600 transition-colors"},e[52]||(e[52]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),t("div",re,[t("div",le,[t("div",de,[t("div",ie,[e[54]||(e[54]=t("span",{class:"text-sm font-medium text-gray-700"},"Cuenta:",-1)),t("span",ue,"#"+s(o.cuenta.id),1)]),t("div",ge,[e[55]||(e[55]=t("span",{class:"text-sm font-medium text-gray-700"},"Proveedor:",-1)),t("span",me,s(o.cuenta.compra.proveedor.nombre_razon_social),1)]),t("div",ce,[e[56]||(e[56]=t("span",{class:"text-sm font-medium text-gray-700"},"Monto Total:",-1)),t("span",xe,s(r(o.cuenta.monto_total)),1)]),t("div",fe,[e[57]||(e[57]=t("span",{class:"text-sm font-medium text-gray-700"},"Pendiente:",-1)),t("span",be,s(r(o.cuenta.monto_pendiente)),1)])]),t("div",null,[e[58]||(e[58]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Monto del Pago *",-1)),j(t("input",{"onUpdate:modelValue":e[8]||(e[8]=n=>i.value=n),type:"number",step:"0.01",min:"0.01",max:o.cuenta.monto_pendiente,class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"0.00"},null,8,ye),[[M,i.value]]),t("p",ve," Máximo: "+s(r(o.cuenta.monto_pendiente)),1)]),t("div",null,[e[59]||(e[59]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Notas del Pago (opcional)",-1)),j(t("textarea",{"onUpdate:modelValue":e[9]||(e[9]=n=>h.value=n),rows:"3",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Agregar notas sobre este pago parcial..."},null,512),[[M,h.value]])])])]),t("div",pe,[t("button",{onClick:e[10]||(e[10]=n=>x.value=!1),class:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-colors"}," Cancelar "),t("button",{onClick:z,disabled:!i.value||isNaN(parseFloat(i.value))||parseFloat(i.value)<=0,class:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"}," Registrar Pago ",8,we)])])])):g("",!0)]}),_:1}))}};export{Ne as default};
