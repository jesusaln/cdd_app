import{T as D,r as g,i as a,o as i,g as x,f as t,u as r,Z as F,e as L,l as A,A as S,k as n,v as m,x as y,F as h,m as B,t as d,z as b,s as E,q as z}from"./vendor-d19pJyVS.js";import{A as q}from"./AppLayout-CcnrZQKI.js";import{_ as G}from"./CategoriaHerramientaModal-J0UXQrIG.js";import"./utils-Dq7h7Pqt.js";import"./app-BcT2PLJy.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const H={class:"flex items-center justify-between mb-4"},P={class:"flex gap-2 mt-1"},T=["value"],I={key:0,class:"text-xs text-gray-500 mt-1"},R={key:1,class:"text-red-600 text-sm"},O={key:0,class:"text-red-600 text-sm"},W={key:0,class:"text-red-600 text-sm"},Z={key:0,class:"text-red-600 text-sm"},$={key:0,class:"text-red-600 text-sm"},J={class:"flex flex-col items-center space-y-4"},K={key:0,class:"relative"},Q=["src"],X={key:1,class:"w-48 h-48 border-2 border-dashed border-gray-300 rounded-lg flex flex-col items-center justify-center text-gray-500 hover:border-gray-400 transition-colors"},Y={class:"flex space-x-2"},ee={class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 cursor-pointer"},te={class:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 cursor-pointer"},oe={key:2,class:"text-red-600 text-sm text-center"},re={class:"pt-2"},se=["disabled"],me=Object.assign({layout:q},{__name:"Create",props:{categorias:{type:Array,default:()=>[]}},setup(_){const w=_,o=D({nombre:"",numero_serie:"",estado:"disponible",descripcion:"",foto:null,categoria_id:"",vida_util_meses:"",costo_reemplazo:"",dias_para_mantenimiento:"",requiere_mantenimiento:!1}),p=g(null),u=g([...w.categorias||[]]),c=g(!1),v=l=>{var s;const e=(s=l.target.files)==null?void 0:s[0];if(e){if(!e.type.startsWith("image/")){alert("Por favor selecciona un archivo de imagen válido");return}if(e.size>5*1024*1024){alert("La imagen es demasiado grande. El tamaño máximo es 5MB");return}o.foto=e;const f=new FileReader;f.onload=j=>{p.value=j.target.result},f.readAsDataURL(e)}},k=()=>{o.foto=null,p.value=null},C=()=>{o.post(route("herramientas.store"),{forceFormData:!0})},V=()=>{c.value=!0},N=()=>{c.value=!1},M=l=>{u.value.push(l),o.categoria_id=l.id},U=l=>{const e=u.value.findIndex(s=>s.id===l.id);e!==-1&&(u.value[e]=l),o.categoria_id===l.id&&(o.categoria_id=l.id)};return(l,e)=>(i(),a(h,null,[x(r(F),{title:"Nueva Herramienta"}),t("div",H,[e[6]||(e[6]=t("h1",{class:"text-2xl font-semibold text-slate-900"},"Nueva Herramienta",-1)),x(r(S),{class:"text-blue-600 hover:underline",href:l.route("herramientas.index")},{default:L(()=>e[5]||(e[5]=[A("Volver")])),_:1},8,["href"])]),t("form",{onSubmit:z(C,["prevent"]),class:"bg-white shadow rounded p-6 space-y-4 max-w-2xl"},[t("div",null,[e[8]||(e[8]=t("label",{class:"block text-sm font-medium text-gray-700"},"Categoría",-1)),t("div",P,[m(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>r(o).categoria_id=s),class:"w-full border rounded px-3 py-2"},[e[7]||(e[7]=t("option",{value:""},"Sin categoría",-1)),(i(!0),a(h,null,B(u.value,s=>(i(),a("option",{key:s.id,value:s.id},d(s.nombre),9,T))),128))],512),[[y,r(o).categoria_id]]),t("button",{type:"button",onClick:V,class:"px-3 py-2 bg-green-600 text-white rounded hover:bg-green-700"},"Gestionar")]),u.value.length?n("",!0):(i(),a("p",I,'No hay categorías. Usa "Gestionar" para crear una nueva.')),r(o).errors.categoria_id?(i(),a("div",R,d(r(o).errors.categoria_id),1)):n("",!0)]),t("div",null,[e[9]||(e[9]=t("label",{class:"block text-sm font-medium text-gray-700"},"Nombre",-1)),m(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>r(o).nombre=s),type:"text",class:"mt-1 w-full border rounded px-3 py-2",required:""},null,512),[[b,r(o).nombre]]),r(o).errors.nombre?(i(),a("div",O,d(r(o).errors.nombre),1)):n("",!0)]),t("div",null,[e[10]||(e[10]=t("label",{class:"block text-sm font-medium text-gray-700"},"Número de serie",-1)),m(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>r(o).numero_serie=s),type:"text",class:"mt-1 w-full border rounded px-3 py-2"},null,512),[[b,r(o).numero_serie]]),r(o).errors.numero_serie?(i(),a("div",W,d(r(o).errors.numero_serie),1)):n("",!0)]),t("div",null,[e[12]||(e[12]=t("label",{class:"block text-sm font-medium text-gray-700"},"Estado",-1)),m(t("select",{"onUpdate:modelValue":e[3]||(e[3]=s=>r(o).estado=s),class:"mt-1 w-full border rounded px-3 py-2"},e[11]||(e[11]=[E('<option value="disponible">Disponible</option><option value="asignada">Asignada</option><option value="mantenimiento">En mantenimiento</option><option value="baja">De baja</option><option value="perdida">Perdida</option>',5)]),512),[[y,r(o).estado]]),r(o).errors.estado?(i(),a("div",Z,d(r(o).errors.estado),1)):n("",!0)]),t("div",null,[e[13]||(e[13]=t("label",{class:"block text-sm font-medium text-gray-700"},"Descripción",-1)),m(t("textarea",{"onUpdate:modelValue":e[4]||(e[4]=s=>r(o).descripcion=s),rows:"3",class:"mt-1 w-full border rounded px-3 py-2"},null,512),[[b,r(o).descripcion]]),r(o).errors.descripcion?(i(),a("div",$,d(r(o).errors.descripcion),1)):n("",!0)]),t("div",null,[e[17]||(e[17]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Foto de la herramienta",-1)),t("div",J,[p.value?(i(),a("div",K,[t("img",{src:p.value,class:"w-48 h-48 object-cover rounded-lg border-2 border-gray-200"},null,8,Q),t("button",{onClick:k,class:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center hover:bg-red-600",title:"Eliminar imagen"}," × ")])):(i(),a("div",X,e[14]||(e[14]=[t("svg",{class:"w-12 h-12 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1),t("span",{class:"text-sm"},"Foto de la herramienta",-1)]))),t("div",Y,[t("label",ee,[e[15]||(e[15]=t("span",null,"Seleccionar imagen",-1)),t("input",{onChange:v,accept:"image/*",type:"file",class:"hidden"},null,32)]),t("label",te,[e[16]||(e[16]=t("span",null,"Capturar foto",-1)),t("input",{onChange:v,accept:"image/*",capture:"environment",type:"file",class:"hidden"},null,32)])]),r(o).errors.foto?(i(),a("div",oe,d(r(o).errors.foto),1)):n("",!0)])]),t("div",re,[t("button",{disabled:r(o).processing,type:"submit",class:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50"},"Guardar",8,se)])],32),x(G,{show:c.value,categorias:u.value,onClose:N,onCategoriaCreated:M,onCategoriaUpdated:U},null,8,["show","categorias"])],64))}});export{me as default};
