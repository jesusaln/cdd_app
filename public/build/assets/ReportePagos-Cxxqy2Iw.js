import{r as p,p as T,b as V,o as n,e as b,f as t,q as A,v as x,z as w,i as a,F as f,m as g,t as i,x as k,n as j,k as E,l as y,g as O,u as z,A as L}from"./vendor-d19pJyVS.js";import{A as U}from"./AppLayout-CcnrZQKI.js";import"./utils-Dq7h7Pqt.js";import"./app-BcT2PLJy.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const B={class:"flex justify-between items-center"},D={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg mb-6"},X={class:"p-6"},H=["value"],I=["value"],$={class:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6"},J={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},K={class:"p-6"},G={class:"flex items-center"},Q={class:"ml-4"},W={class:"text-lg font-semibold text-gray-900"},Y={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},Z={class:"p-6"},tt={class:"flex items-center"},et={class:"flex-shrink-0"},st={class:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center"},ot={class:"text-white text-sm font-bold"},it={class:"ml-4"},nt={class:"text-lg font-semibold text-gray-900"},at={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},rt={class:"p-6"},lt={class:"flex items-center"},dt={class:"flex-shrink-0"},ct={class:"w-8 h-8 bg-purple-500 rounded-full flex items-center justify-center"},ut={class:"text-white text-sm font-bold"},mt={class:"ml-4"},xt={class:"text-lg font-semibold text-gray-900"},ft={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},gt={class:"p-6"},pt={class:"flex items-center"},bt={class:"flex-shrink-0"},yt={class:"w-8 h-8 bg-orange-500 rounded-full flex items-center justify-center"},ht={class:"text-white text-sm font-bold"},_t={class:"ml-4"},vt={class:"text-lg font-semibold text-gray-900"},wt={class:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6"},kt={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},jt={class:"p-6"},Et={class:"space-y-4"},Mt={class:"font-medium text-gray-900"},Ct={class:"text-sm text-gray-500"},Pt={class:"text-right"},qt={class:"font-bold text-lg text-gray-900"},Nt={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},Rt={class:"p-6"},St={class:"space-y-4"},Ft={class:"flex items-center justify-between"},Tt={class:"font-semibold"},Vt={class:"flex items-center justify-between"},At={class:"font-semibold"},Ot={class:"flex items-center justify-between"},zt={class:"font-semibold"},Lt={class:"flex items-center justify-between"},Ut={class:"font-semibold"},Bt={class:"flex items-center justify-between font-bold text-lg"},Dt={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},Xt={class:"overflow-x-auto"},Ht={class:"min-w-full divide-y divide-gray-200"},It={class:"bg-white divide-y divide-gray-200"},$t={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Jt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Kt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Gt={class:"px-6 py-4 whitespace-nowrap"},Qt={class:"px-6 py-4 whitespace-nowrap"},Wt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Yt={key:0,class:"text-green-600"},Zt={key:1,class:"text-blue-600"},te={key:2,class:"text-gray-600"},ee={class:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-gray-900"},se={class:"px-6 py-4 text-sm text-gray-500 max-w-xs truncate"},oe={class:"px-6 py-4 whitespace-nowrap"},ie={key:0,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800"},ne={key:1,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800"},ae={key:2,class:"text-xs text-gray-500 mt-1"},re={key:3,class:"text-xs text-gray-500"},le={class:"px-6 py-4 text-right"},de=["onClick"],ce={key:1,class:"text-sm text-gray-500"},be={__name:"ReportePagos",props:{entregas:Array,resumenMetodos:Array,stats:Object,metodoEntregaStats:Object,usuarios:Array,responsables:Array,filters:Object},setup(l){const u=l,M=p([]),C=p([]),r=p({fecha_inicio:u.filters.fecha_inicio||"",fecha_fin:u.filters.fecha_fin||"",usuario_id:u.filters.usuario_id||"",recibido_por:u.filters.recibido_por||""}),P=new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}),d=o=>P.format(o||0),h=o=>{if(!o)return"N/A";try{return new Date(o).toLocaleDateString("es-MX")}catch{return"Fecha inválida"}},_=o=>o.monto_efectivo>0&&o.monto_cheques==0&&o.monto_tarjetas==0?"Efectivo":o.monto_cheques>0&&o.monto_efectivo==0&&o.monto_tarjetas==0?"Cheque":o.monto_tarjetas>0&&o.monto_efectivo==0&&o.monto_cheques==0?"Tarjeta":"Mixto",q=o=>{const e=_(o).toLowerCase();return{efectivo:"bg-green-100 text-green-800",cheque:"bg-blue-100 text-blue-800",tarjeta:"bg-purple-100 text-purple-800",mixto:"bg-orange-100 text-orange-800"}[e]||"bg-gray-100 text-gray-800"},v=o=>o.monto_efectivo>0&&o.monto_cheques==0&&o.monto_tarjetas==0?"Efectivo":o.monto_cheques>0&&o.monto_efectivo==0&&o.monto_tarjetas==0?"Cheque":o.monto_tarjetas>0&&o.monto_efectivo==0&&o.monto_cheques==0?"Tarjeta":"Mixto",N=o=>{const e=v(o).toLowerCase();return{efectivo:"bg-green-100 text-green-800",cheque:"bg-blue-100 text-blue-800",tarjeta:"bg-purple-100 text-purple-800",mixto:"bg-orange-100 text-orange-800"}[e]||"bg-gray-100 text-gray-800"},R=o=>o.id_origen||"N/A",S=()=>{const o={};r.value.fecha_inicio&&(o.fecha_inicio=r.value.fecha_inicio),r.value.fecha_fin&&(o.fecha_fin=r.value.fecha_fin),r.value.usuario_id&&(o.usuario_id=r.value.usuario_id),r.value.recibido_por&&(o.recibido_por=r.value.recibido_por),window.location.href=route("entregas-dinero.reporte-pagos",o)},F=async o=>{const e=prompt("Nombre del responsable que recibe el dinero:","");if(!e)return;const s=prompt("Notas de la entrega (opcional):","");try{const c=await(await fetch(route("entregas-dinero.marcar-entregado-responsable",o.id),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify({responsable_nombre:e,notas_entrega:s||null})})).json();c.success?(notyf.success("Entrega marcada como entregada al responsable"),window.location.reload()):notyf.error(c.error||"Error al marcar la entrega")}catch{notyf.error("Error de conexión")}};return T(()=>{}),(o,e)=>(n(),V(U,{title:"Reporte de Pagos Recibidos"},{header:b(()=>[t("div",B,[e[5]||(e[5]=t("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Reporte de Pagos Recibidos ",-1)),O(z(L),{href:o.route("entregas-dinero.index"),class:"bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded"},{default:b(()=>e[4]||(e[4]=[y(" ← Volver a Entregas ")])),_:1},8,["href"])])]),default:b(()=>[t("div",D,[t("div",X,[t("form",{onSubmit:A(S,["prevent"]),class:"grid grid-cols-1 md:grid-cols-5 gap-4"},[t("div",null,[e[6]||(e[6]=t("label",{class:"block text-sm font-medium text-gray-700"},"Fecha Inicio",-1)),x(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>r.value.fecha_inicio=s),type:"date",class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"},null,512),[[w,r.value.fecha_inicio]])]),t("div",null,[e[7]||(e[7]=t("label",{class:"block text-sm font-medium text-gray-700"},"Fecha Fin",-1)),x(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>r.value.fecha_fin=s),type:"date",class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"},null,512),[[w,r.value.fecha_fin]])]),t("div",null,[e[9]||(e[9]=t("label",{class:"block text-sm font-medium text-gray-700"},"Usuario",-1)),x(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>r.value.usuario_id=s),class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"},[e[8]||(e[8]=t("option",{value:""},"Todos",-1)),(n(!0),a(f,null,g(M.value,s=>(n(),a("option",{key:s.id,value:s.id},i(s.name),9,H))),128))],512),[[k,r.value.usuario_id]])]),t("div",null,[e[11]||(e[11]=t("label",{class:"block text-sm font-medium text-gray-700"},"Recibido Por",-1)),x(t("select",{"onUpdate:modelValue":e[3]||(e[3]=s=>r.value.recibido_por=s),class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"},[e[10]||(e[10]=t("option",{value:""},"Todos",-1)),(n(!0),a(f,null,g(C.value,s=>(n(),a("option",{key:s.id,value:s.id},i(s.name),9,I))),128))],512),[[k,r.value.recibido_por]])]),e[12]||(e[12]=t("div",{class:"flex items-end"},[t("button",{type:"submit",class:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded w-full"}," Filtrar ")],-1))],32)])]),t("div",$,[t("div",J,[t("div",K,[t("div",G,[e[14]||(e[14]=t("div",{class:"flex-shrink-0"},[t("div",{class:"w-8 h-8 bg-green-500 rounded-full flex items-center justify-center"},[t("span",{class:"text-white text-sm font-bold"},"$")])],-1)),t("div",Q,[e[13]||(e[13]=t("dt",{class:"text-sm font-medium text-gray-500 truncate"}," Total Recibido ",-1)),t("dd",W,i(d(l.stats.total_recibido)),1)])])])]),t("div",Y,[t("div",Z,[t("div",tt,[t("div",et,[t("div",st,[t("span",ot,i(l.stats.cantidad_entregas),1)])]),t("div",it,[e[15]||(e[15]=t("dt",{class:"text-sm font-medium text-gray-500 truncate"}," Entregas ",-1)),t("dd",nt,i(l.stats.cantidad_entregas),1)])])])]),t("div",at,[t("div",rt,[t("div",lt,[t("div",dt,[t("div",ct,[t("span",ut,i(l.stats.usuarios_unicos),1)])]),t("div",mt,[e[16]||(e[16]=t("dt",{class:"text-sm font-medium text-gray-500 truncate"}," Usuarios ",-1)),t("dd",xt,i(l.stats.usuarios_unicos),1)])])])]),t("div",ft,[t("div",gt,[t("div",pt,[t("div",bt,[t("div",yt,[t("span",ht,i(l.stats.responsables_unicos),1)])]),t("div",_t,[e[17]||(e[17]=t("dt",{class:"text-sm font-medium text-gray-500 truncate"}," Responsables ",-1)),t("dd",vt,i(l.stats.responsables_unicos),1)])])])])]),t("div",wt,[t("div",kt,[e[18]||(e[18]=t("div",{class:"px-6 py-4 bg-gray-50 border-b border-gray-200"},[t("h3",{class:"text-lg font-medium text-gray-900"},"Resumen por Método de Pago en Entrega")],-1)),t("div",jt,[t("div",Et,[(n(!0),a(f,null,g(l.resumenMetodos,s=>(n(),a("div",{key:s.metodo,class:"flex items-center justify-between p-4 bg-gray-50 rounded-lg"},[t("div",null,[t("div",Mt,i(s.label),1),t("div",Ct,i(s.cantidad)+" entregas",1)]),t("div",Pt,[t("div",qt,i(d(s.total)),1)])]))),128))])])]),t("div",Nt,[e[25]||(e[25]=t("div",{class:"px-6 py-4 bg-gray-50 border-b border-gray-200"},[t("h3",{class:"text-lg font-medium text-gray-900"},"Desglose de Montos")],-1)),t("div",Rt,[t("div",St,[t("div",Ft,[e[19]||(e[19]=t("span",{class:"text-gray-600"},"Efectivo en Entrega:",-1)),t("span",Tt,i(d(l.metodoEntregaStats.efectivo||0)),1)]),t("div",Vt,[e[20]||(e[20]=t("span",{class:"text-gray-600"},"Cheques en Entrega:",-1)),t("span",At,i(d(l.metodoEntregaStats.cheque||0)),1)]),t("div",Ot,[e[21]||(e[21]=t("span",{class:"text-gray-600"},"Tarjetas en Entrega:",-1)),t("span",zt,i(d(l.metodoEntregaStats.tarjeta||0)),1)]),t("div",Lt,[e[22]||(e[22]=t("span",{class:"text-gray-600"},"Mixto en Entrega:",-1)),t("span",Ut,i(d(l.metodoEntregaStats.mixto||0)),1)]),e[24]||(e[24]=t("hr",{class:"my-2"},null,-1)),t("div",Bt,[e[23]||(e[23]=t("span",null,"Total Entregas:",-1)),t("span",null,i(d(l.stats.total_recibido)),1)])])])])]),t("div",Dt,[e[29]||(e[29]=t("div",{class:"px-6 py-4 bg-gray-50 border-b border-gray-200"},[t("h3",{class:"text-lg font-medium text-gray-900"},"Detalle de Pagos Recibidos")],-1)),t("div",Xt,[t("table",Ht,[e[28]||(e[28]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Fecha Entrega "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Usuario "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Recibido Por "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Método de Pago Original "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Método de Pago Entrega "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Origen "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Monto "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Notas "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Entregado Responsable "),t("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"}," Acciones ")])],-1)),t("tbody",It,[(n(!0),a(f,null,g(l.entregas,s=>{var m,c;return n(),a("tr",{key:s.id},[t("td",$t,i(h(s.fecha_entrega)),1),t("td",Jt,i((m=s.usuario)==null?void 0:m.name),1),t("td",Kt,i((c=s.recibidoPor)==null?void 0:c.name),1),t("td",Gt,[t("span",{class:j([q(s),"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"])},i(_(s)),3)]),t("td",Qt,[t("span",{class:j([N(s),"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"])},i(v(s)),3)]),t("td",Wt,[s.tipo_origen==="venta"?(n(),a("span",Yt," Venta #"+i(R(s)),1)):s.tipo_origen==="cobranza"?(n(),a("span",Zt," Cobranza #"+i(s.id_origen),1)):(n(),a("span",te," Manual "))]),t("td",ee,i(d(s.total)),1),t("td",se,i(s.notas_recibido||s.notas||"-"),1),t("td",oe,[s.entregado_responsable?(n(),a("span",ie,e[26]||(e[26]=[t("svg",{class:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),y(" Sí ")]))):(n(),a("span",ne," Pendiente ")),s.fecha_entregado_responsable?(n(),a("div",ae,i(h(s.fecha_entregado_responsable)),1)):E("",!0),s.responsable_organizacion?(n(),a("div",re,i(s.responsable_organizacion),1)):E("",!0)]),t("td",le,[s.entregado_responsable?(n(),a("span",ce," Entregado ")):(n(),a("button",{key:0,onClick:ue=>F(s),class:"inline-flex items-center gap-2 px-3 py-1 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors text-sm"},e[27]||(e[27]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})],-1),y(" Entregar ")]),8,de))])])}),128))])])])])]),_:1}))}};export{be as default};
