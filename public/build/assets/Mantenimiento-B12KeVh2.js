import{r as d,c as S,i as u,o as a,g,f as e,u as r,Z as z,e as w,l as m,A as p,v as x,z as b,t as o,F as v,m as _,E as A,b as V,n as C,N as E}from"./vendor-d19pJyVS.js";import{A as U}from"./AppLayout-CcnrZQKI.js";import"./utils-Dq7h7Pqt.js";import"./app-BcT2PLJy.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const B={class:"flex items-center justify-between mb-6"},O={class:"bg-white rounded-lg shadow-sm border p-6 mb-6"},R={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4"},F={class:"flex items-end"},P=["disabled"],Z={class:"bg-white rounded-lg shadow-sm border"},G={class:"p-6 border-b"},I={class:"flex items-center justify-between"},J={class:"overflow-x-auto"},K={class:"min-w-full divide-y divide-gray-200"},Q={class:"bg-gray-50"},W={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},X=["checked"],Y={class:"bg-white divide-y divide-gray-200"},$={class:"px-6 py-4"},ee=["value"],te={class:"px-6 py-4"},se={class:"font-medium text-gray-900"},ne={class:"text-sm text-gray-500"},ie={class:"px-6 py-4"},le={class:"text-sm text-gray-900"},oe={class:"px-6 py-4"},ae={class:"text-sm text-gray-900"},re={class:"px-6 py-4"},de={class:"text-sm font-medium text-red-600"},ue={class:"px-6 py-4 text-sm font-medium"},me={class:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6"},pe={class:"flex-1 flex justify-between sm:hidden"},xe={class:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between"},ce={class:"text-sm text-gray-700"},ge={class:"font-medium"},be={class:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px"},_e=Object.assign({layout:U},{__name:"Mantenimiento",props:{herramientas:{type:Object,required:!0}},setup(H){const M=H,i=d([]),f=d(""),c=d(""),y=d(new Date().toISOString().split("T")[0]),h=d(""),l=S(()=>{var n;return((n=M.herramientas)==null?void 0:n.data)||[]}),k=()=>{i.value.length===l.value.length?i.value=[]:i.value=l.value.map(n=>n.id)},L=()=>{if(i.value.length===0){alert("Selecciona al menos una herramienta");return}if(!c.value.trim()){alert("Ingresa una descripción del mantenimiento");return}i.value.forEach(n=>{l.value.find(s=>s.id===n)&&E.post(route("herramientas.registrar-mantenimiento",n),{fecha_mantenimiento:y.value,costo_mantenimiento:f.value,descripcion_mantenimiento:c.value,proximo_mantenimiento_dias:h.value},{preserveScroll:!0,onSuccess:()=>{const s=i.value.indexOf(n);s!==-1&&i.value.splice(s,1)}})})},j=n=>n?new Date(n).toLocaleDateString("es-ES"):"N/A",N=n=>{if(!n)return"N/A";const t=Math.abs(new Date-new Date(n));return Math.ceil(t/(1e3*60*60*24))},D=S(()=>{var n;return((n=M.herramientas)==null?void 0:n.links)||[]});return(n,t)=>(a(),u(v,null,[g(r(z),{title:"Mantenimiento de Herramientas"}),e("div",B,[t[6]||(t[6]=e("h1",{class:"text-3xl font-bold text-slate-900"},"Mantenimiento Preventivo",-1)),g(r(p),{class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",href:n.route("herramientas.dashboard")},{default:w(()=>t[5]||(t[5]=[m(" Volver al Dashboard ")])),_:1},8,["href"])]),e("div",O,[t[11]||(t[11]=e("h2",{class:"text-xl font-semibold mb-4"},"Registrar Mantenimiento Masivo",-1)),e("div",R,[e("div",null,[t[7]||(t[7]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Fecha de Mantenimiento",-1)),x(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>y.value=s),type:"date",class:"w-full border rounded px-3 py-2"},null,512),[[b,y.value]])]),e("div",null,[t[8]||(t[8]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Costo Total",-1)),x(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>f.value=s),type:"number",step:"0.01",placeholder:"0.00",class:"w-full border rounded px-3 py-2"},null,512),[[b,f.value]])]),e("div",null,[t[9]||(t[9]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Próximo Mantenimiento (días)",-1)),x(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>h.value=s),type:"number",placeholder:"90",class:"w-full border rounded px-3 py-2"},null,512),[[b,h.value]])]),e("div",F,[e("button",{onClick:L,disabled:i.value.length===0,class:"w-full px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 disabled:bg-gray-400"}," Registrar Mantenimiento ("+o(i.value.length)+") ",9,P)])]),e("div",null,[t[10]||(t[10]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Descripción del Mantenimiento",-1)),x(e("textarea",{"onUpdate:modelValue":t[3]||(t[3]=s=>c.value=s),rows:"3",placeholder:"Describe el mantenimiento realizado...",class:"w-full border rounded px-3 py-2"},null,512),[[b,c.value]])])]),e("div",Z,[e("div",G,[e("div",I,[t[12]||(t[12]=e("h2",{class:"text-xl font-semibold"},"Herramientas que Requieren Mantenimiento",-1)),e("button",{onClick:k,class:"px-3 py-2 text-sm bg-blue-600 text-white rounded hover:bg-blue-700"},o(i.value.length===l.value.length?"Deseleccionar Todas":"Seleccionar Todas"),1)])]),e("div",J,[e("table",K,[e("thead",Q,[e("tr",null,[e("th",W,[e("input",{type:"checkbox",checked:i.value.length===l.value.length&&l.value.length>0,onChange:k},null,40,X)]),t[13]||(t[13]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Herramienta",-1)),t[14]||(t[14]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Categoría",-1)),t[15]||(t[15]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Último Mantenimiento",-1)),t[16]||(t[16]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Días Transcurridos",-1)),t[17]||(t[17]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Estado",-1)),t[18]||(t[18]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Acciones",-1))])]),e("tbody",Y,[(a(!0),u(v,null,_(l.value,s=>{var T;return a(),u("tr",{key:s.id,class:"hover:bg-gray-50"},[e("td",$,[x(e("input",{type:"checkbox",value:s.id,"onUpdate:modelValue":t[4]||(t[4]=q=>i.value=q)},null,8,ee),[[A,i.value]])]),e("td",te,[e("div",null,[e("div",se,o(s.nombre),1),e("div",ne,o(s.numero_serie),1)])]),e("td",ie,[e("span",le,o(((T=s.categoria_herramienta)==null?void 0:T.nombre)||"Sin categoría"),1)]),e("td",oe,[e("span",ae,o(j(s.fecha_ultimo_mantenimiento)),1)]),e("td",re,[e("span",de,o(N(s.fecha_ultimo_mantenimiento))+" días ",1)]),t[21]||(t[21]=e("td",{class:"px-6 py-4"},[e("span",{class:"px-2 py-1 text-xs font-medium bg-red-100 text-red-800 rounded-full"}," Requiere Mantenimiento ")],-1)),e("td",ue,[g(r(p),{href:n.route("herramientas.show",s.id),class:"text-blue-600 hover:underline mr-3"},{default:w(()=>t[19]||(t[19]=[m(" Ver ")])),_:2},1032,["href"]),g(r(p),{href:n.route("herramientas.edit",s.id),class:"text-green-600 hover:underline"},{default:w(()=>t[20]||(t[20]=[m(" Editar ")])),_:2},1032,["href"])])])}),128))])])]),e("div",me,[e("div",pe,[(a(!0),u(v,null,_(D.value,s=>(a(),V(r(p),{key:s.url+s.label,href:s.url||"#","preserve-scroll":"",class:C(["relative inline-flex items-center px-4 py-2 border text-sm font-medium",s.active?"z-10 bg-indigo-50 border-indigo-500 text-indigo-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"]),innerHTML:s.label},null,8,["href","class","innerHTML"]))),128))]),e("div",xe,[e("div",null,[e("p",ce,[t[22]||(t[22]=m(" Mostrando ")),e("span",ge,o(l.value.length),1),t[23]||(t[23]=m(" herramientas que requieren mantenimiento "))])]),e("div",null,[e("nav",be,[(a(!0),u(v,null,_(D.value,s=>(a(),V(r(p),{key:s.url+s.label,href:s.url||"#","preserve-scroll":"",class:C(["relative inline-flex items-center px-2 py-2 rounded-l-md border text-sm font-medium",s.active?"z-10 bg-indigo-50 border-indigo-500 text-indigo-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"]),innerHTML:s.label},null,8,["href","class","innerHTML"]))),128))])])])])])],64))}});export{_e as default};
