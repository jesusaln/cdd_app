import{r as k,i as l,o as r,g as v,f as t,u as b,Z as h,k as d,t as n,F as x,m as C,l as y,n as c,e as M,A as j,q as p,v as i,z as m,x as V,s as N,N as P}from"./vendor-d19pJyVS.js";import{N as $}from"./app-BcT2PLJy.js";import{_ as E}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./utils-Dq7h7Pqt.js";const z={class:"ventas-show"},S={key:0,class:"bg-white rounded-lg shadow-md p-6"},T={class:"mb-4"},q={class:"mb-4"},B={class:"mb-4"},F={class:"mb-4"},U={class:"mb-4"},D={class:"flex items-center space-x-4"},L={key:0,class:"text-sm text-gray-600"},A={key:0,class:"mb-4"},O={class:"bg-green-50 p-4 rounded-lg"},R={class:"grid grid-cols-1 md:grid-cols-2 gap-x-4 gap-y-4"},I={class:"mt-1"},Z={class:"mt-1 text-sm text-gray-900"},G={key:0,class:"mt-4"},H={class:"mt-1 text-sm text-gray-700 bg-white p-3 rounded border"},J={key:1},K={key:2,class:"mt-6 flex flex-wrap gap-2"},Q={key:0,class:"flex space-x-2"},W={key:3,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},X={class:"bg-white rounded-lg shadow-xl w-full max-w-md max-h-[90vh] overflow-y-auto"},Y={class:"flex items-center justify-between p-6 border-b border-gray-200"},_={class:"p-6"},tt={class:"space-y-4"},et={class:"bg-gray-50 p-4 rounded-lg"},ot={class:"flex justify-between items-center"},st={class:"text-sm text-gray-900"},at={class:"flex justify-between items-center mt-2"},nt={class:"text-sm text-gray-900"},lt={class:"flex justify-between items-center mt-2"},rt={class:"text-lg font-bold text-gray-900"},dt={class:"flex justify-between items-center mt-2"},it={class:"text-lg font-bold text-red-600"},gt=["max"],ut={class:"text-xs text-gray-500 mt-1"},mt={class:"flex justify-end gap-3 px-6 py-4 border-t border-gray-200 bg-gray-50"},ft=["disabled"],vt={class:"bg-white rounded-lg shadow-xl w-full max-w-md max-h-[90vh] overflow-y-auto"},bt={class:"flex items-center justify-between p-6 border-b border-gray-200"},xt={class:"p-6"},yt={class:"space-y-4"},ct={class:"bg-gray-50 p-4 rounded-lg"},pt={class:"flex justify-between items-center"},Pt={class:"text-sm text-gray-900"},wt={class:"flex justify-between items-center mt-2"},kt={class:"text-sm text-gray-900"},ht={class:"flex justify-between items-center mt-2"},Ct={class:"text-lg font-bold text-gray-900"},Mt={class:"flex justify-end gap-3 px-6 py-4 border-t border-gray-200 bg-gray-50"},jt=["disabled"],Vt={__name:"Show",props:{venta:Object},setup(s){const g=k(!1),u=new $({duration:3e3,position:{x:"right",y:"top"}}),w=async o=>{if(g.value=!0,confirm("¿Estás seguro de que deseas eliminar esta venta?"))try{await P.delete(`/ventas/${o}`,{onSuccess:()=>{u.success("Venta eliminada exitosamente."),P.visit(route("ventas.index"))},onError:()=>u.error("Error al eliminar la venta.")})}catch{u.error("Ocurrió un error inesperado.")}finally{g.value=!1}};return(o,e)=>{var f;return r(),l(x,null,[v(b(h),{title:"Mostrar Venta"}),t("div",z,[e[43]||(e[43]=t("h1",{class:"text-2xl font-semibold mb-6"},"Detalles de la Venta",-1)),s.venta?(r(),l("div",S,[t("div",T,[e[15]||(e[15]=t("h2",{class:"text-lg font-medium text-gray-700"},"Cliente",-1)),t("p",null,n(s.venta.cliente.nombre_razon_social),1)]),t("div",q,[e[16]||(e[16]=t("h2",{class:"text-lg font-medium text-gray-700"},"Productos",-1)),t("ul",null,[(r(!0),l(x,null,C(s.venta.productos,a=>(r(),l("li",{key:a.id,class:"mb-2"},[t("strong",null,n(a.nombre),1),y(" - $"+n(a.pivot.precio)+" (Cantidad: "+n(a.pivot.cantidad)+") ",1)]))),128))])]),t("div",B,[e[17]||(e[17]=t("h2",{class:"text-lg font-medium text-gray-700"},"Total",-1)),t("p",null,"$"+n(s.venta.total),1)]),t("div",F,[e[18]||(e[18]=t("h2",{class:"text-lg font-medium text-gray-700"},"Estado",-1)),t("p",null,n(s.venta.estado),1)]),t("div",U,[e[19]||(e[19]=t("h2",{class:"text-lg font-medium text-gray-700"},"Estado de Pago",-1)),t("div",D,[t("span",{class:c([{"bg-green-100 text-green-800":s.venta.pagado,"bg-red-100 text-red-800":!s.venta.pagado},"inline-flex items-center px-2.5 py-0.5 rounded-full text-sm font-medium"])},n(s.venta.pagado?"Pagado":"Pendiente"),3),s.venta.pagado?(r(),l("span",L," Pagado el "+n(o.formatearFecha(s.venta.fecha_pago)),1)):d("",!0)])]),s.venta.pagado?(r(),l("div",A,[e[23]||(e[23]=t("h3",{class:"text-md font-medium text-gray-700 mb-2"},"Detalles del Pago",-1)),t("div",O,[t("div",R,[t("div",null,[e[20]||(e[20]=t("dt",{class:"text-sm font-medium text-gray-500"},"Método de Pago",-1)),t("dd",I,[t("span",{class:c([o.getMetodoPagoClass(s.venta.metodo_pago),"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"])},n(o.getMetodoPagoLabel(s.venta.metodo_pago)),3)])]),t("div",null,[e[21]||(e[21]=t("dt",{class:"text-sm font-medium text-gray-500"},"Pagado Por",-1)),t("dd",Z,n(((f=s.venta.pagado_por_usuario)==null?void 0:f.name)||"Usuario no encontrado"),1)])]),s.venta.notas_pago?(r(),l("div",G,[e[22]||(e[22]=t("dt",{class:"text-sm font-medium text-gray-500"},"Notas de Pago",-1)),t("dd",H,n(s.venta.notas_pago),1)])):d("",!0)])])):d("",!0)])):(r(),l("div",J,e[24]||(e[24]=[t("p",null,"Cargando detalles de la venta...",-1)]))),s.venta?(r(),l("div",K,[v(b(j),{href:o.route("ventas.edit",s.venta.id),class:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600"},{default:M(()=>e[25]||(e[25]=[y(" Editar ")])),_:1},8,["href"]),s.venta.pagado?d("",!0):(r(),l("div",Q,[t("button",{onClick:e[0]||(e[0]=a=>o.showPagoParcialModal=!0),class:"bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600"}," Registrar Pago Parcial "),t("button",{onClick:e[1]||(e[1]=a=>o.showPagoModal=!0),class:"bg-purple-500 text-white px-4 py-2 rounded hover:bg-purple-600"}," Marcar como Pagado ")])),t("button",{onClick:e[2]||(e[2]=a=>w(s.venta.id)),class:"bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600"}," Eliminar ")])):d("",!0),g.value?(r(),l("div",W,e[26]||(e[26]=[t("div",{class:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"},null,-1)]))):d("",!0),o.showPagoParcialModal?(r(),l("div",{key:4,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:e[8]||(e[8]=p(a=>o.showPagoParcialModal=!1,["self"]))},[t("div",X,[t("div",Y,[e[28]||(e[28]=t("h3",{class:"text-lg font-medium text-gray-900"},"Registrar Pago Parcial",-1)),t("button",{onClick:e[3]||(e[3]=a=>o.showPagoParcialModal=!1),class:"text-gray-400 hover:text-gray-600 transition-colors"},e[27]||(e[27]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),t("div",_,[t("div",tt,[t("div",et,[t("div",ot,[e[29]||(e[29]=t("span",{class:"text-sm font-medium text-gray-700"},"Venta:",-1)),t("span",st,n(s.venta.numero_venta),1)]),t("div",at,[e[30]||(e[30]=t("span",{class:"text-sm font-medium text-gray-700"},"Cliente:",-1)),t("span",nt,n(s.venta.cliente.nombre_razon_social),1)]),t("div",lt,[e[31]||(e[31]=t("span",{class:"text-sm font-medium text-gray-700"},"Monto Total:",-1)),t("span",rt,n(o.formatCurrency(s.venta.total)),1)]),t("div",dt,[e[32]||(e[32]=t("span",{class:"text-sm font-medium text-gray-700"},"Pendiente:",-1)),t("span",it,n(o.formatCurrency(s.venta.total-(s.venta.monto_pagado||0))),1)])]),t("div",null,[e[33]||(e[33]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Monto del Pago *",-1)),i(t("input",{"onUpdate:modelValue":e[4]||(e[4]=a=>o.montoPagoParcial=a),type:"number",step:"0.01",min:"0.01",max:s.venta.total-(s.venta.monto_pagado||0),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"0.00"},null,8,gt),[[m,o.montoPagoParcial]]),t("p",ut," Máximo: "+n(o.formatCurrency(s.venta.total-(s.venta.monto_pagado||0))),1)]),t("div",null,[e[34]||(e[34]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Notas del Pago (opcional)",-1)),i(t("textarea",{"onUpdate:modelValue":e[5]||(e[5]=a=>o.notasPagoParcial=a),rows:"3",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Agregar notas sobre este pago parcial..."},null,512),[[m,o.notasPagoParcial]])])])]),t("div",mt,[t("button",{onClick:e[6]||(e[6]=a=>o.showPagoParcialModal=!1),class:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-colors"}," Cancelar "),t("button",{onClick:e[7]||(e[7]=(...a)=>o.confirmarPagoParcial&&o.confirmarPagoParcial(...a)),disabled:!o.montoPagoParcial||isNaN(parseFloat(o.montoPagoParcial))||parseFloat(o.montoPagoParcial)<=0,class:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"}," Registrar Pago ",8,ft)])])])):d("",!0),o.showPagoModal?(r(),l("div",{key:5,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:e[14]||(e[14]=p(a=>o.showPagoModal=!1,["self"]))},[t("div",vt,[t("div",bt,[e[36]||(e[36]=t("h3",{class:"text-lg font-medium text-gray-900"},"Marcar Venta como Pagada",-1)),t("button",{onClick:e[9]||(e[9]=a=>o.showPagoModal=!1),class:"text-gray-400 hover:text-gray-600 transition-colors"},e[35]||(e[35]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),t("div",xt,[t("div",yt,[t("div",ct,[t("div",pt,[e[37]||(e[37]=t("span",{class:"text-sm font-medium text-gray-700"},"Venta:",-1)),t("span",Pt,n(s.venta.numero_venta),1)]),t("div",wt,[e[38]||(e[38]=t("span",{class:"text-sm font-medium text-gray-700"},"Cliente:",-1)),t("span",kt,n(s.venta.cliente.nombre_razon_social),1)]),t("div",ht,[e[39]||(e[39]=t("span",{class:"text-sm font-medium text-gray-700"},"Monto Total:",-1)),t("span",Ct,n(o.formatCurrency(s.venta.total)),1)])]),t("div",null,[e[41]||(e[41]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Método de Pago *",-1)),i(t("select",{"onUpdate:modelValue":e[10]||(e[10]=a=>o.metodoPago=a),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:""},e[40]||(e[40]=[N('<option value="" data-v-2f67ffa8>Seleccionar método de pago</option><option value="efectivo" data-v-2f67ffa8>Efectivo</option><option value="transferencia" data-v-2f67ffa8>Transferencia</option><option value="cheque" data-v-2f67ffa8>Cheque</option><option value="tarjeta" data-v-2f67ffa8>Tarjeta</option><option value="otros" data-v-2f67ffa8>Otros</option>',6)]),512),[[V,o.metodoPago]])]),t("div",null,[e[42]||(e[42]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Notas de Pago (opcional)",-1)),i(t("textarea",{"onUpdate:modelValue":e[11]||(e[11]=a=>o.notasPago=a),rows:"3",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Agregar notas sobre el pago..."},null,512),[[m,o.notasPago]])])])]),t("div",Mt,[t("button",{onClick:e[12]||(e[12]=a=>o.showPagoModal=!1),class:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-colors"}," Cancelar "),t("button",{onClick:e[13]||(e[13]=(...a)=>o.confirmarPago&&o.confirmarPago(...a)),disabled:!o.metodoPago,class:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"}," Marcar como Pagado ",8,jt)])])])):d("",!0)])],64)}}},St=E(Vt,[["__scopeId","data-v-2f67ffa8"]]);export{St as default};
