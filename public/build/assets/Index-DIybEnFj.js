import{r as m,b as j,o as d,e as f,f as e,g as v,t as r,q as A,v as E,x as V,i as c,F as y,m as _,n as N,k as H,u as h,A as b,l as D}from"./vendor-d19pJyVS.js";import{a as O}from"./utils-Dq7h7Pqt.js";import{N as R}from"./app-BcT2PLJy.js";import{A as $}from"./AppLayout-CcnrZQKI.js";import{M as I}from"./Modales-BBthfVFz.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const U={class:"flex justify-between items-center"},X={class:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6"},q={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},G={class:"p-6 text-gray-900"},J={class:"flex items-center"},K={class:"ml-4"},Q={class:"text-lg font-semibold text-gray-900"},W={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},Y={class:"p-6 text-gray-900"},Z={class:"flex items-center"},ee={class:"ml-4"},te={class:"text-lg font-semibold text-gray-900"},se={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},oe={class:"p-6 text-gray-900"},re={class:"flex items-center"},ne={class:"flex-shrink-0"},ie={class:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center"},ae={class:"text-white text-sm font-bold"},le={class:"ml-4"},de={class:"text-lg font-semibold text-gray-900"},ce={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},ue={class:"p-6 text-gray-900"},me={class:"flex items-center"},fe={class:"flex-shrink-0"},xe={class:"w-8 h-8 bg-red-500 rounded-full flex items-center justify-center"},ge={class:"text-white text-sm font-bold"},pe={class:"ml-4"},ve={class:"text-lg font-semibold text-gray-900"},he={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg mb-6"},be={class:"p-6"},we=["value"],ye={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},_e={class:"p-6"},ke={class:"overflow-x-auto"},Ce={class:"min-w-full divide-y divide-gray-200"},Me={class:"bg-white divide-y divide-gray-200"},je={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},Ee={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},Ve={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},Ne={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},Le={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},Pe={class:"px-6 py-4 whitespace-nowrap"},Te={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},ze={class:"flex items-center justify-start space-x-2"},Be=["onClick"],Fe={class:"mt-4"},Se={class:"flex justify-between items-center"},Ae={class:"text-sm text-gray-700"},He={class:"flex space-x-1"},Xe={__name:"Index",props:{cuentas:Object,stats:Object,filters:Object},setup(i){const x=new R({duration:4e3,position:{x:"right",y:"top"},types:[{type:"success",background:"#10b981",icon:!1},{type:"error",background:"#ef4444",icon:!1},{type:"warning",background:"#f59e0b",icon:!1}]}),k=i,L=m([]),w=m(!1),g=m(null),C=m("details"),P=o=>{var t,s,l;g.value={...o,numero_venta:((t=o.venta)==null?void 0:t.numero_venta)||`V${String(o.venta_id).padStart(3,"0")}`,email_destino:(l=(s=o.venta)==null?void 0:s.cliente)==null?void 0:l.email,tipo_envio:"recordatorio_pago"},C.value="confirm-email",w.value=!0},M=()=>{w.value=!1,g.value=null},T=async()=>{var o,t,s,l;try{const n=g.value;if(!(n!=null&&n.email_destino)){x.error("Email de destino no vÃ¡lido");return}M();const{data:a}=await O.post(`/ventas/${n.venta.id}/enviar-email`,{email_destino:n.email_destino});if(a!=null&&a.success)x.success(a.message||"Recordatorio de pago enviado correctamente");else throw new Error((a==null?void 0:a.error)||"Error desconocido al enviar recordatorio")}catch(n){console.error("Error al enviar recordatorio:",n);const a=((t=(o=n.response)==null?void 0:o.data)==null?void 0:t.error)||((l=(s=n.response)==null?void 0:s.data)==null?void 0:l.message)||n.message;x.error("Error al enviar recordatorio: "+a)}},u=m({estado:k.filters.estado||"",cliente_id:k.filters.cliente_id||""}),z=new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}),B=o=>{if(o==null)return 0;const t=Number(o);return Number.isFinite(t)?t:0},p=o=>z.format(B(o)),F=()=>{window.location.href=route("cuentas-por-cobrar.index",u.value)},S=o=>{var t,s;if(!((s=(t=o.venta)==null?void 0:t.cliente)!=null&&s.email)){x.error("El cliente no tiene email configurado");return}P(o)};return(o,t)=>(d(),j($,{title:"Cuentas por Cobrar"},{header:f(()=>[e("div",U,[t[3]||(t[3]=e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Cuentas por Cobrar ",-1)),v(h(b),{href:o.route("cuentas-por-cobrar.create"),class:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded"},{default:f(()=>t[2]||(t[2]=[D(" Nueva Cuenta por Cobrar ")])),_:1},8,["href"])])]),default:f(()=>[e("div",X,[e("div",q,[e("div",G,[e("div",J,[t[5]||(t[5]=e("div",{class:"flex-shrink-0"},[e("div",{class:"w-8 h-8 bg-red-500 rounded-full flex items-center justify-center"},[e("span",{class:"text-white text-sm font-bold"},"!")])],-1)),e("div",K,[t[4]||(t[4]=e("dt",{class:"text-sm font-medium text-gray-500 truncate"}," Total Vencido ",-1)),e("dd",Q,r(p(i.stats.total_vencido)),1)])])])]),e("div",W,[e("div",Y,[e("div",Z,[t[7]||(t[7]=e("div",{class:"flex-shrink-0"},[e("div",{class:"w-8 h-8 bg-yellow-500 rounded-full flex items-center justify-center"},[e("span",{class:"text-white text-sm font-bold"},"P")])],-1)),e("div",ee,[t[6]||(t[6]=e("dt",{class:"text-sm font-medium text-gray-500 truncate"}," Total Pendiente ",-1)),e("dd",te,r(p(i.stats.total_pendiente)),1)])])])]),e("div",se,[e("div",oe,[e("div",re,[e("div",ne,[e("div",ie,[e("span",ae,r(i.stats.cuentas_pendientes),1)])]),e("div",le,[t[8]||(t[8]=e("dt",{class:"text-sm font-medium text-gray-500 truncate"}," Cuentas Pendientes ",-1)),e("dd",de,r(i.stats.cuentas_pendientes),1)])])])]),e("div",ce,[e("div",ue,[e("div",me,[e("div",fe,[e("div",xe,[e("span",ge,r(i.stats.cuentas_vencidas),1)])]),e("div",pe,[t[9]||(t[9]=e("dt",{class:"text-sm font-medium text-gray-500 truncate"}," Cuentas Vencidas ",-1)),e("dd",ve,r(i.stats.cuentas_vencidas),1)])])])])]),e("div",he,[e("div",be,[e("form",{onSubmit:A(F,["prevent"]),class:"flex flex-wrap gap-4"},[e("div",null,[t[11]||(t[11]=e("label",{class:"block text-sm font-medium text-gray-700"},"Estado",-1)),E(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>u.value.estado=s),class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm"},t[10]||(t[10]=[e("option",{value:""},"Todos",-1),e("option",{value:"pendiente"},"Pendiente",-1),e("option",{value:"parcial"},"Parcial",-1),e("option",{value:"pagado"},"Pagado",-1),e("option",{value:"vencido"},"Vencido",-1)]),512),[[V,u.value.estado]])]),e("div",null,[t[13]||(t[13]=e("label",{class:"block text-sm font-medium text-gray-700"},"Cliente",-1)),E(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>u.value.cliente_id=s),class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm"},[t[12]||(t[12]=e("option",{value:""},"Todos",-1)),(d(!0),c(y,null,_(L.value,s=>(d(),c("option",{key:s.id,value:s.id},r(s.nombre_razon_social),9,we))),128))],512),[[V,u.value.cliente_id]])]),t[14]||(t[14]=e("div",{class:"flex items-end"},[e("button",{type:"submit",class:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded"}," Filtrar ")],-1))],32)])]),e("div",ye,[e("div",_e,[e("div",ke,[e("table",Ce,[t[18]||(t[18]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Venta "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Cliente "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Monto Total "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Pendiente "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Vencimiento "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Estado "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Acciones ")])],-1)),e("tbody",Me,[(d(!0),c(y,null,_(i.cuentas.data,s=>{var l,n;return d(),c("tr",{key:s.id},[e("td",je,r(s.venta.numero_venta),1),e("td",Ee,r(s.venta.cliente.nombre_razon_social),1),e("td",Ve,r(p(s.monto_total)),1),e("td",Ne,r(p(s.monto_pendiente)),1),e("td",Le,r(s.fecha_vencimiento?new Date(s.fecha_vencimiento).toLocaleDateString():"N/A"),1),e("td",Pe,[e("span",{class:N([{"bg-red-100 text-red-800":s.estado==="vencido","bg-yellow-100 text-yellow-800":s.estado==="parcial","bg-green-100 text-green-800":s.estado==="pagado","bg-gray-100 text-gray-800":s.estado==="pendiente"},"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"])},r(s.estado),3)]),e("td",Te,[e("div",ze,[v(h(b),{href:o.route("cuentas-por-cobrar.show",s.id),class:"group/btn relative inline-flex items-center justify-center w-9 h-9 rounded-lg bg-blue-50 text-blue-600 hover:bg-blue-100 hover:text-blue-700 hover:shadow-sm transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:ring-offset-1",title:"Ver detalles"},{default:f(()=>t[15]||(t[15]=[e("svg",{class:"w-4 h-4 transition-transform duration-200 group-hover/btn:scale-110",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})],-1)])),_:2},1032,["href"]),v(h(b),{href:o.route("cuentas-por-cobrar.edit",s.id),class:"group/btn relative inline-flex items-center justify-center w-9 h-9 rounded-lg bg-amber-50 text-amber-600 hover:bg-amber-100 hover:text-amber-700 hover:shadow-sm transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-amber-500/50 focus:ring-offset-1",title:"Editar"},{default:f(()=>t[16]||(t[16]=[e("svg",{class:"w-4 h-4 transition-transform duration-200 group-hover/btn:scale-110",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)])),_:2},1032,["href"]),["pendiente","parcial"].includes(s.estado)&&((n=(l=s.venta)==null?void 0:l.cliente)!=null&&n.email)?(d(),c("button",{key:0,onClick:a=>S(s),class:"group/btn relative inline-flex items-center justify-center w-9 h-9 rounded-lg bg-green-50 text-green-600 hover:bg-green-100 hover:text-green-700 hover:shadow-sm transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-green-500/50 focus:ring-offset-1",title:"Enviar Recordatorio de Pago"},t[17]||(t[17]=[e("svg",{class:"w-4 h-4 transition-transform duration-200 group-hover/btn:scale-110",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 12l-1.5-1.5m0 0L9 12m1.5-1.5V9"})],-1)]),8,Be)):H("",!0)])])])}),128))])])]),e("div",Fe,[e("div",Se,[e("div",Ae," Mostrando "+r(i.cuentas.from)+" a "+r(i.cuentas.to)+" de "+r(i.cuentas.total)+" resultados ",1),e("div",He,[(d(!0),c(y,null,_(i.cuentas.links,s=>(d(),j(h(b),{key:s.label,href:s.url||"#",innerHTML:s.label,class:N(["px-3 py-2 text-sm border rounded",s.active?"bg-blue-500 text-white border-blue-500":s.url?"bg-white text-gray-700 border-gray-300 hover:bg-gray-50":"bg-gray-100 text-gray-400 border-gray-200 cursor-not-allowed"]),"preserve-scroll":!!s.url},null,8,["href","innerHTML","class","preserve-scroll"]))),128))])])])])]),v(I,{show:w.value,mode:C.value,tipo:"ventas",selected:g.value||{},onClose:M,onConfirmEmail:T},null,8,["show","mode","selected"])]),_:1}))}};export{Xe as default};
