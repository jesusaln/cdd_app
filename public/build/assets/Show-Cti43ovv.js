import{r as v,c as L,b as B,o as d,e as y,f as t,i as u,k as c,t as s,n as I,g as j,u as N,A as M,l as C,J as R,q as F,v as T,z as S,x as U,N as q}from"./vendor-d19pJyVS.js";import{A as X}from"./AppLayout-CcnrZQKI.js";import{N as J}from"./app-BcT2PLJy.js";import"./utils-Dq7h7Pqt.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const _={class:"flex justify-between items-center"},G={class:"flex space-x-2"},K={class:"py-12"},H={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},Q={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},W={class:"p-6 bg-white border-b border-gray-200"},Y={class:"mb-6"},Z={class:"grid grid-cols-1 md:grid-cols-2 gap-x-4 gap-y-6"},tt={class:"mt-1 text-sm text-gray-900"},et={class:"mt-1"},ot={class:"mt-1 text-sm text-gray-900"},st={class:"mt-1 text-sm text-gray-900"},nt={class:"mb-6"},at={class:"bg-gray-50 p-4 rounded-lg"},rt={class:"grid grid-cols-1 md:grid-cols-2 gap-x-4 gap-y-6"},lt={class:"mt-1 text-sm text-gray-900"},dt={class:"mt-1 text-sm text-gray-900"},it={class:"mt-1 text-sm text-gray-900"},ut={class:"mt-1 text-sm text-gray-900"},ct={class:"mb-6"},mt={class:"bg-green-50 p-4 rounded-lg"},gt={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},xt={class:"text-center"},bt={class:"text-2xl font-bold text-blue-600"},ft={class:"text-center"},vt={class:"text-2xl font-bold text-green-600"},yt={class:"text-center"},pt={class:"text-2xl font-bold text-red-600"},wt={class:"mt-4"},Ct={class:"flex justify-between text-sm text-gray-600 mb-1"},ht={class:"w-full bg-gray-200 rounded-full h-2"},kt={key:0,class:"mb-6"},jt={class:"bg-green-50 p-4 rounded-lg"},Nt={class:"grid grid-cols-1 md:grid-cols-2 gap-x-4 gap-y-6"},Mt={class:"mt-1 text-sm text-gray-900"},Tt={class:"mt-1 text-sm text-gray-900"},Pt={class:"mt-1 text-sm text-gray-900"},St={key:0,class:"mt-4"},Et={class:"mt-1 text-sm text-gray-700 bg-white p-3 rounded border"},Vt={key:1,class:"mb-6"},Dt={class:"bg-yellow-50 p-4 rounded-lg"},Ft={class:"text-sm text-gray-700 whitespace-pre-line"},qt={class:"mb-6"},At={class:"bg-gray-50 p-4 rounded-lg"},Ot={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"},$t={class:"space-y-2"},zt={class:"flex justify-between"},Lt={class:"font-semibold"},Bt={class:"flex justify-between"},It={class:"font-semibold text-green-600"},Rt={class:"flex justify-between"},Ut={class:"font-semibold text-red-600"},Xt={class:"flex flex-col justify-center space-y-2"},Jt={key:2,class:"text-center"},_t={class:"border-t border-gray-200 pt-4"},Gt={class:"bg-white rounded-lg shadow-xl w-full max-w-md max-h-[90vh] overflow-y-auto"},Kt={class:"flex items-center justify-between p-6 border-b border-gray-200"},Ht={class:"p-6"},Qt={class:"space-y-4"},Wt={class:"bg-gray-50 p-4 rounded-lg"},Yt={class:"flex justify-between items-center mb-2"},Zt={class:"text-sm text-gray-900"},te={class:"flex justify-between items-center mb-2"},ee={class:"text-sm text-gray-900"},oe={class:"flex justify-between items-center"},se={class:"text-lg font-bold text-gray-900"},ne={class:"flex justify-between items-center"},ae={class:"text-lg font-bold text-red-600"},re=["max"],le={class:"text-xs text-gray-500 mt-1"},de={class:"flex justify-end gap-3 px-6 py-4 border-t border-gray-200 bg-gray-50"},ie=["disabled"],ue={class:"bg-white rounded-lg shadow-xl w-full max-w-md max-h-[90vh] overflow-y-auto"},ce={class:"flex items-center justify-between p-6 border-b border-gray-200"},me={class:"p-6"},ge={class:"space-y-4"},xe={class:"bg-gray-50 p-4 rounded-lg"},be={class:"flex justify-between items-center mb-2"},fe={class:"text-sm text-gray-900"},ve={class:"flex justify-between items-center mb-2"},ye={class:"text-sm text-gray-900"},pe={class:"flex justify-between items-center"},we={class:"text-lg font-bold text-gray-900"},Ce={class:"flex justify-end gap-3 px-6 py-4 border-t border-gray-200 bg-gray-50"},he=["disabled"],Pe={__name:"Show",props:{cuenta:{type:Object,required:!0}},setup(o){const l=new J({duration:4e3,position:{x:"right",y:"top"},types:[{type:"success",background:"#10b981",icon:!1},{type:"error",background:"#ef4444",icon:!1},{type:"warning",background:"#f59e0b",icon:!1}]}),m=o,g=v(!1),x=v(!1),b=v(""),h=v(""),i=v(""),k=v(""),A=new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}),P=n=>{if(n==null)return 0;const e=Number(n);return Number.isFinite(e)?e:0},r=n=>A.format(P(n)),E=L(()=>{var p,w;const n=P((p=m.cuenta)==null?void 0:p.monto_total);if(n<=0)return 0;const f=P((w=m.cuenta)==null?void 0:w.monto_pagado)/n*100;return Math.min(100,Math.max(0,Math.round(f)))}),O=n=>({efectivo:"Efectivo",transferencia:"Transferencia",cheque:"Cheque",tarjeta:"Tarjeta",otros:"Otros"})[n]||n||"No especificado",$=async()=>{if(!b.value){l.error("Debe seleccionar un método de cobro");return}try{const e=await(await fetch(route("ventas.marcar-pagado",m.cuenta.venta.id),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify({metodo_pago:b.value,notas_pago:h.value||null})})).json();e.success?(l.success("Cuenta marcada como cobrada exitosamente"),g.value=!1,b.value="",h.value="",q.reload()):l.error(e.error||"Error al marcar como cobrada")}catch{l.error("Error de conexión")}},z=async()=>{const n=parseFloat(i.value);if(!i.value||isNaN(n)||n<=0){l.error("Debe ingresar un monto válido mayor a cero");return}if(n>m.cuenta.monto_pendiente){l.error(`El monto no puede ser mayor al pendiente de ${r(m.cuenta.monto_pendiente)}`);return}try{const e=await fetch(route("cuentas-por-cobrar.registrar-pago",m.cuenta.id),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify({monto:n,notas:k.value||null})});if(e.ok)l.success("Cobro parcial registrado exitosamente"),x.value=!1,i.value="",k.value="",q.reload();else{const f=await e.json();l.error(f.message||"Error al registrar el cobro parcial")}}catch{l.error("Error de conexión")}};return(n,e)=>(d(),B(X,{title:"Detalles de Cuenta por Cobrar"},{header:y(()=>[t("div",_,[e[14]||(e[14]=t("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Detalles de Cuenta por Cobrar ",-1)),t("div",G,[j(N(M),{href:n.route("cuentas-por-cobrar.edit",o.cuenta.id),class:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded"},{default:y(()=>e[12]||(e[12]=[C(" Editar ")])),_:1},8,["href"]),j(N(M),{href:n.route("cuentas-por-cobrar.index"),class:"bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded"},{default:y(()=>e[13]||(e[13]=[C(" Volver ")])),_:1},8,["href"])])])]),default:y(()=>{var f,p,w,V,D;return[t("div",K,[t("div",H,[t("div",Q,[t("div",W,[t("div",Y,[e[19]||(e[19]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Información General",-1)),t("dl",Z,[t("div",null,[e[15]||(e[15]=t("dt",{class:"text-sm font-medium text-gray-500"},"ID de Cuenta",-1)),t("dd",tt,"#"+s(o.cuenta.id),1)]),t("div",null,[e[16]||(e[16]=t("dt",{class:"text-sm font-medium text-gray-500"},"Estado",-1)),t("dd",et,[t("span",{class:I([{"bg-red-100 text-red-800":o.cuenta.estado==="vencido","bg-yellow-100 text-yellow-800":o.cuenta.estado==="parcial","bg-green-100 text-green-800":o.cuenta.estado==="pagado","bg-gray-100 text-gray-800":o.cuenta.estado==="pendiente"},"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"])},s(o.cuenta.estado),3)])]),t("div",null,[e[17]||(e[17]=t("dt",{class:"text-sm font-medium text-gray-500"},"Fecha de Creación",-1)),t("dd",ot,s(new Date(o.cuenta.created_at).toLocaleDateString()),1)]),t("div",null,[e[18]||(e[18]=t("dt",{class:"text-sm font-medium text-gray-500"},"Fecha de Vencimiento",-1)),t("dd",st,s(o.cuenta.fecha_vencimiento?new Date(o.cuenta.fecha_vencimiento).toLocaleDateString():"No especificada"),1)])])]),t("div",nt,[e[24]||(e[24]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Información de la Venta",-1)),t("div",at,[t("dl",rt,[t("div",null,[e[20]||(e[20]=t("dt",{class:"text-sm font-medium text-gray-500"},"Número de Venta",-1)),t("dd",lt,[j(N(M),{href:n.route("ventas.show",o.cuenta.venta.id),class:"text-blue-600 hover:text-blue-800"},{default:y(()=>[C(s(o.cuenta.venta.numero_venta),1)]),_:1},8,["href"])])]),t("div",null,[e[21]||(e[21]=t("dt",{class:"text-sm font-medium text-gray-500"},"Cliente",-1)),t("dd",dt,s(o.cuenta.venta.cliente.nombre_razon_social),1)]),t("div",null,[e[22]||(e[22]=t("dt",{class:"text-sm font-medium text-gray-500"},"Total de la Venta",-1)),t("dd",it,s(o.cuenta.venta?r(o.cuenta.venta.total):"N/A"),1)]),t("div",null,[e[23]||(e[23]=t("dt",{class:"text-sm font-medium text-gray-500"},"Estado de la Venta",-1)),t("dd",ut,s(o.cuenta.venta.estado),1)])])])]),t("div",ct,[e[29]||(e[29]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Estado de Cobros",-1)),t("div",mt,[t("div",gt,[t("div",xt,[t("div",bt,s(r(o.cuenta.monto_total)),1),e[25]||(e[25]=t("div",{class:"text-sm text-blue-600"},"Monto Total",-1))]),t("div",ft,[t("div",vt,s(r(o.cuenta.monto_pagado)),1),e[26]||(e[26]=t("div",{class:"text-sm text-green-600"},"Monto Cobrado",-1))]),t("div",yt,[t("div",pt,s(r(o.cuenta.monto_pendiente)),1),e[27]||(e[27]=t("div",{class:"text-sm text-red-600"},"Monto Pendiente",-1))])]),t("div",wt,[t("div",Ct,[e[28]||(e[28]=t("span",null,"Progreso de Cobro",-1)),t("span",null,s(E.value)+"%",1)]),t("div",ht,[t("div",{class:"bg-green-600 h-2 rounded-full",style:R({width:E.value+"%"})},null,4)])])])]),o.cuenta.estado==="pagado"?(d(),u("div",kt,[e[35]||(e[35]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Información de Cobro",-1)),t("div",jt,[t("div",Nt,[e[33]||(e[33]=t("div",null,[t("dt",{class:"text-sm font-medium text-gray-500"},"Estado de Cobro"),t("dd",{class:"mt-1"},[t("span",{class:"bg-green-100 text-green-800 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"}," Cobrado ")])],-1)),t("div",null,[e[30]||(e[30]=t("dt",{class:"text-sm font-medium text-gray-500"},"Método de Cobro",-1)),t("dd",Mt,s(O((f=o.cuenta.venta)==null?void 0:f.metodo_pago)),1)]),t("div",null,[e[31]||(e[31]=t("dt",{class:"text-sm font-medium text-gray-500"},"Fecha de Cobro",-1)),t("dd",Tt,s((p=o.cuenta.venta)!=null&&p.fecha_pago?new Date(o.cuenta.venta.fecha_pago).toLocaleDateString():"N/A"),1)]),t("div",null,[e[32]||(e[32]=t("dt",{class:"text-sm font-medium text-gray-500"},"Cobrado Por",-1)),t("dd",Pt,s(((V=(w=o.cuenta.venta)==null?void 0:w.pagado_por_usuario)==null?void 0:V.name)||"Usuario no encontrado"),1)])]),(D=o.cuenta.venta)!=null&&D.notas_pago?(d(),u("div",St,[e[34]||(e[34]=t("dt",{class:"text-sm font-medium text-gray-500"},"Notas de Cobro",-1)),t("dd",Et,s(o.cuenta.venta.notas_pago),1)])):c("",!0)])])):c("",!0),o.cuenta.notas?(d(),u("div",Vt,[e[36]||(e[36]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Notas",-1)),t("div",Dt,[t("p",Ft,s(o.cuenta.notas),1)])])):c("",!0),t("div",qt,[e[43]||(e[43]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Gestión de Cobros",-1)),t("div",At,[t("div",Ot,[t("div",$t,[t("div",zt,[e[37]||(e[37]=t("span",{class:"text-sm text-gray-600"},"Total de la cuenta:",-1)),t("span",Lt,s(r(o.cuenta.monto_total)),1)]),t("div",Bt,[e[38]||(e[38]=t("span",{class:"text-sm text-gray-600"},"Cobrado hasta ahora:",-1)),t("span",It,s(r(o.cuenta.monto_pagado)),1)]),t("div",Rt,[e[39]||(e[39]=t("span",{class:"text-sm text-gray-600"},"Pendiente:",-1)),t("span",Ut,s(r(o.cuenta.monto_pendiente)),1)])]),t("div",Xt,[o.cuenta.monto_pendiente>0?(d(),u("button",{key:0,onClick:e[0]||(e[0]=a=>x.value=!0),class:"bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded text-sm"}," + Registrar Cobro Parcial ")):c("",!0),o.cuenta.estado!=="pagado"&&o.cuenta.monto_pendiente>0?(d(),u("button",{key:1,onClick:e[1]||(e[1]=a=>g.value=!0),class:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded text-sm"}," ✓ Marcar como Cobrado ")):c("",!0),o.cuenta.estado==="pagado"?(d(),u("div",Jt,e[40]||(e[40]=[t("span",{class:"bg-green-100 text-green-800 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"}," Cuenta Completamente Cobrada ",-1)]))):c("",!0)])]),t("div",_t,[e[42]||(e[42]=t("p",{class:"text-xs text-gray-500 mb-2"},[t("strong",null,"Nota:"),C(" Los cobros parciales se registran en el historial de notas. Para ver el historial detallado, edita la cuenta. ")],-1)),j(N(M),{href:n.route("cuentas-por-cobrar.edit",o.cuenta.id),class:"text-blue-600 hover:text-blue-800 text-sm font-medium"},{default:y(()=>e[41]||(e[41]=[C(" Ver historial completo de cobros → ")])),_:1},8,["href"])])])])])])])]),x.value?(d(),u("div",{key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:e[6]||(e[6]=F(a=>x.value=!1,["self"]))},[t("div",Gt,[t("div",Kt,[e[45]||(e[45]=t("h3",{class:"text-lg font-medium text-gray-900"},"Registrar Cobro Parcial",-1)),t("button",{onClick:e[2]||(e[2]=a=>x.value=!1),class:"text-gray-400 hover:text-gray-600 transition-colors"},e[44]||(e[44]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),t("div",Ht,[t("div",Qt,[t("div",Wt,[t("div",Yt,[e[46]||(e[46]=t("span",{class:"text-sm font-medium text-gray-700"},"Cuenta:",-1)),t("span",Zt,"#"+s(o.cuenta.id),1)]),t("div",te,[e[47]||(e[47]=t("span",{class:"text-sm font-medium text-gray-700"},"Cliente:",-1)),t("span",ee,s(o.cuenta.venta.cliente.nombre_razon_social),1)]),t("div",oe,[e[48]||(e[48]=t("span",{class:"text-sm font-medium text-gray-700"},"Monto Total:",-1)),t("span",se,s(r(o.cuenta.monto_total)),1)]),t("div",ne,[e[49]||(e[49]=t("span",{class:"text-sm font-medium text-gray-700"},"Pendiente:",-1)),t("span",ae,s(r(o.cuenta.monto_pendiente)),1)])]),t("div",null,[e[50]||(e[50]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Monto del Cobro *",-1)),T(t("input",{"onUpdate:modelValue":e[3]||(e[3]=a=>i.value=a),type:"number",step:"0.01",min:"0.01",max:o.cuenta.monto_pendiente,class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"0.00"},null,8,re),[[S,i.value]]),t("p",le," Máximo: "+s(r(o.cuenta.monto_pendiente)),1)]),t("div",null,[e[51]||(e[51]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Notas del Cobro (opcional)",-1)),T(t("textarea",{"onUpdate:modelValue":e[4]||(e[4]=a=>k.value=a),rows:"3",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Agregar notas sobre este cobro parcial..."},null,512),[[S,k.value]])])])]),t("div",de,[t("button",{onClick:e[5]||(e[5]=a=>x.value=!1),class:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-colors"}," Cancelar "),t("button",{onClick:z,disabled:!i.value||isNaN(parseFloat(i.value))||parseFloat(i.value)<=0,class:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"}," Registrar Cobro ",8,ie)])])])):c("",!0),g.value?(d(),u("div",{key:1,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:e[11]||(e[11]=F(a=>g.value=!1,["self"]))},[t("div",ue,[t("div",ce,[e[53]||(e[53]=t("h3",{class:"text-lg font-medium text-gray-900"},"Marcar Cuenta como Cobrada",-1)),t("button",{onClick:e[7]||(e[7]=a=>g.value=!1),class:"text-gray-400 hover:text-gray-600 transition-colors"},e[52]||(e[52]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),t("div",me,[t("div",ge,[t("div",xe,[t("div",be,[e[54]||(e[54]=t("span",{class:"text-sm font-medium text-gray-700"},"Cuenta:",-1)),t("span",fe,"#"+s(o.cuenta.id),1)]),t("div",ve,[e[55]||(e[55]=t("span",{class:"text-sm font-medium text-gray-700"},"Cliente:",-1)),t("span",ye,s(o.cuenta.venta.cliente.nombre_razon_social),1)]),t("div",pe,[e[56]||(e[56]=t("span",{class:"text-sm font-medium text-gray-700"},"Monto Total:",-1)),t("span",we,s(r(o.cuenta.monto_total)),1)])]),t("div",null,[e[58]||(e[58]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Método de Cobro *",-1)),T(t("select",{"onUpdate:modelValue":e[8]||(e[8]=a=>b.value=a),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:""},e[57]||(e[57]=[t("option",{value:""},"Seleccionar método de cobro",-1),t("option",{value:"efectivo"},"Efectivo",-1),t("option",{value:"transferencia"},"Transferencia",-1),t("option",{value:"cheque"},"Cheque",-1),t("option",{value:"tarjeta"},"Tarjeta",-1),t("option",{value:"otros"},"Otros",-1)]),512),[[U,b.value]])]),t("div",null,[e[59]||(e[59]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Notas de Cobro (opcional)",-1)),T(t("textarea",{"onUpdate:modelValue":e[9]||(e[9]=a=>h.value=a),rows:"3",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Agregar notas sobre el cobro..."},null,512),[[S,h.value]])])])]),t("div",Ce,[t("button",{onClick:e[10]||(e[10]=a=>g.value=!1),class:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-colors"}," Cancelar "),t("button",{onClick:$,disabled:!b.value,class:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"}," Marcar como Cobrado ",8,he)])])])):c("",!0)]}),_:1}))}};export{Pe as default};
