import{Q,T as W,c as _,i,o as n,g as A,f as e,u as r,Z as X,k as c,s as Z,e as J,l as u,A as K,F as b,m as g,t as l,q as Y,v as f,z as v,n as p,x as k,D as N,N as tt}from"./vendor-d19pJyVS.js";import{A as et}from"./AppLayout-CcnrZQKI.js";import{_ as st}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./utils-Dq7h7Pqt.js";import"./app-BcT2PLJy.js";const ot={class:"min-h-screen bg-gray-50 py-8"},rt={class:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8"},it={class:"mb-6"},nt={class:"flex items-start justify-between gap-4"},at={key:0,class:"mb-6 rounded-lg border border-red-200 bg-red-50 p-4 text-red-800 shadow-sm"},lt={class:"list-disc ml-7 text-sm space-y-0.5"},dt={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ct={class:"md:col-span-2"},ut={class:"flex justify-between mt-1"},pt={key:0,class:"text-sm text-red-600"},mt={class:"text-xs text-gray-400"},ft=["value"],xt={key:0,class:"mt-1 text-sm text-red-600"},bt=["value"],gt={key:0,class:"mt-1 text-sm text-red-600"},yt=["value"],vt={key:0,class:"mt-1 text-sm text-red-600"},wt=["value"],_t={key:0,class:"mt-1 text-sm text-red-600"},kt={class:"mt-1 flex items-center"},ht={class:"text-xs text-gray-600"},Ct={class:"flex items-center justify-between mb-1"},Mt={class:"flex gap-2"},zt={key:0,class:"mt-1 text-sm text-red-600"},jt={class:"flex items-center justify-between mb-1"},Tt={class:"flex gap-1 flex-wrap"},St={key:0,class:"mt-1 text-sm text-red-600"},Vt={key:1,class:"mt-1 text-xs text-gray-500 flex items-center"},Dt={class:"font-medium text-gray-700 ml-1"},Bt={key:2,class:"mt-1 text-xs text-amber-600 flex items-center"},Et={class:"md:col-span-2"},Ut={class:"flex justify-between mt-1"},At={key:0,class:"text-sm text-red-600"},Nt={class:"text-xs text-gray-400"},It={class:"md:col-span-2"},$t={class:"flex items-center justify-between mb-1"},Lt={class:"text-xs text-gray-400"},Ot={key:0,class:"mt-1 text-sm text-red-600"},Ft={class:"mt-2 flex flex-wrap gap-2"},Rt=["onClick"],Gt={class:"mt-8 pt-6 border-t border-gray-200"},Ht={class:"flex flex-col sm:flex-row gap-3 sm:items-center sm:justify-between"},Pt={class:"flex gap-3"},qt=["disabled"],Qt={key:0},Wt={key:1,class:"inline-flex items-center"},Xt=["disabled"],Zt={key:0},Jt={key:1,class:"inline-flex items-center"},Kt=Object.assign({layout:et},{__name:"Create",props:{usuarios:{type:Array,default:()=>[]},clientes:{type:Array,default:()=>[]},tipos:{type:Array,default:()=>[]},estados:{type:Array,default:()=>["pendiente","en_proceso","completado","cancelado"]}},setup(y){var D,B,E;const h=y,C=Q(),I=((E=(B=(D=C==null?void 0:C.props)==null?void 0:D.auth)==null?void 0:B.user)==null?void 0:E.id)??"",s=W({titulo:"",user_id:I||"",cliente_id:null,tipo:h.tipos[0]||"",estado:h.estados.includes("en_proceso")?"en_proceso":h.estados[0]||"",inicio_at:"",fin_at:"",ubicacion:"",descripcion:""}),$=["Materiales utilizados:","Tiempo estimado:","Pendientes:","Observaciones:","Estado del equipo:","Próximos pasos:"],L=_(()=>Object.keys(s.errors||{}).length>0),O=_(()=>s.titulo&&s.user_id&&s.tipo&&s.estado&&s.inicio_at),z=_(()=>{if(!s.inicio_at||!s.fin_at)return"";const a=new Date(s.inicio_at),o=new Date(s.fin_at)-a;return isNaN(o)?"":o<0?"La fecha de fin no puede ser anterior al inicio":o/(1e3*60*60)>12?"Duración muy larga, verifica las fechas":""});function m(a){var t;return(t=s.errors)!=null&&t[a]?"border-red-300 focus:ring-red-500 bg-red-50":"border-gray-300"}function j(a){return a.replace(/_/g," ").toLowerCase().replace(/\b\w/g,t=>t.toUpperCase())}function F(a){return{pendiente:"text-yellow-700",en_proceso:"text-blue-700",completado:"text-green-700",cancelado:"text-red-700"}[a]||"text-gray-700"}function R(a){return{pendiente:"bg-yellow-400",en_proceso:"bg-blue-400",completado:"bg-green-400",cancelado:"bg-red-400"}[a]||"bg-gray-400"}function G(a){return{pendiente:"Por iniciar",en_proceso:"En progreso",completado:"Finalizada",cancelado:"No realizada"}[a]||""}function T(a){const t=new Date;t.setMinutes(t.getMinutes()-t.getTimezoneOffset());const o=t.toISOString().slice(0,16);s[a]=o}function M(a){if(!s.inicio_at)return;const t=new Date(s.inicio_at),o=new Date(t.getTime()-t.getTimezoneOffset()*6e4);o.setMinutes(o.getMinutes()+a);const d=new Date(o.getTime()+o.getTimezoneOffset()*6e4);d.setMinutes(d.getMinutes()-d.getTimezoneOffset()),s.fin_at=d.toISOString().slice(0,16)}const S=_(()=>{if(!s.inicio_at||!s.fin_at)return"";const a=new Date(s.inicio_at),o=new Date(s.fin_at)-a;if(isNaN(o)||o<=0)return"";const d=Math.round(o/6e4),w=Math.floor(d/60),x=d%60;return w?`${w}h ${x}m`:`${x}m`});function H(a){const t=s.descripcion||"",o=t?`

`:"";s.descripcion=t+o+a+" ",N(()=>{const d=document.getElementById("descripcion");d&&(d.focus(),d.setSelectionRange(d.value.length,d.value.length))})}function P(a){const t=a.target;t.style.height="auto",t.style.height=Math.min(t.scrollHeight,200)+"px"}function q(){return{...s.data()}}function V(a="index"){const t=q();s.post(route("bitacora.store"),{preserveScroll:!0,data:t,onSuccess:()=>{if(a==="stay"){const o=s.user_id,d=s.tipo,w=s.estado;s.reset("titulo","cliente_id","inicio_at","fin_at","ubicacion","descripcion"),s.user_id=o,s.tipo=d,s.estado=w,N(()=>{var U;const x=document.getElementById("titulo");(U=x==null?void 0:x.focus)==null||U.call(x)})}else tt.visit(route("bitacora.index"))}})}return(a,t)=>(n(),i(b,null,[A(r(X),{title:"Registrar Actividad"}),e("div",ot,[e("div",rt,[e("div",it,[e("div",nt,[t[17]||(t[17]=e("div",null,[e("h1",{class:"text-3xl font-bold text-gray-900 tracking-tight"},"Registrar Actividad"),e("p",{class:"mt-2 text-sm text-gray-600"},"Captura detallada para tu bitácora. Los campos marcados con * son obligatorios.")],-1)),A(r(K),{href:a.route("bitacora.index"),class:"inline-flex items-center px-4 py-2 bg-white border border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50 hover:border-gray-400 transition-colors shadow-sm"},{default:J(()=>t[16]||(t[16]=[e("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),u(" Volver ")])),_:1},8,["href"])])]),L.value?(n(),i("div",at,[t[18]||(t[18]=e("div",{class:"flex items-center mb-2"},[e("svg",{class:"w-5 h-5 mr-2 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]),e("div",{class:"font-semibold"},"Revisa los campos marcados:")],-1)),e("ul",lt,[(n(!0),i(b,null,g(r(s).errors,(o,d)=>(n(),i("li",{key:d},l(o),1))),128))])])):c("",!0),e("form",{onSubmit:t[15]||(t[15]=Y(o=>V("index"),["prevent"])),class:"bg-white rounded-2xl shadow-sm border border-gray-200 p-6"},[e("div",dt,[e("div",ct,[t[19]||(t[19]=e("label",{for:"titulo",class:"block text-sm font-medium text-gray-700 mb-1"},[u(" Título "),e("span",{class:"text-red-500"},"*")],-1)),f(e("input",{id:"titulo","onUpdate:modelValue":t[0]||(t[0]=o=>r(s).titulo=o),type:"text",class:p(["mt-1 w-full px-4 py-2.5 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors",m("titulo")]),placeholder:"Ej. Instalación minisplit sucursal Centro",maxlength:"150",autocomplete:"off"},null,2),[[v,r(s).titulo,void 0,{trim:!0}]]),e("div",ut,[r(s).errors.titulo?(n(),i("p",pt,l(r(s).errors.titulo),1)):c("",!0),e("span",mt,l((r(s).titulo||"").length)+" / 150",1)])]),e("div",null,[t[21]||(t[21]=e("label",{for:"user_id",class:"block text-sm font-medium text-gray-700 mb-1"},[u(" Empleado "),e("span",{class:"text-red-500"},"*")],-1)),f(e("select",{id:"user_id","onUpdate:modelValue":t[1]||(t[1]=o=>r(s).user_id=o),class:p(["mt-1 w-full px-4 py-2.5 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors",m("user_id")])},[t[20]||(t[20]=e("option",{value:"",disabled:""},"Selecciona un empleado",-1)),(n(!0),i(b,null,g(y.usuarios,o=>(n(),i("option",{key:o.id,value:o.id},l(o.name),9,ft))),128))],2),[[k,r(s).user_id]]),r(s).errors.user_id?(n(),i("p",xt,l(r(s).errors.user_id),1)):c("",!0)]),e("div",null,[t[23]||(t[23]=e("label",{for:"cliente_id",class:"block text-sm font-medium text-gray-700 mb-1"},"Cliente",-1)),f(e("select",{id:"cliente_id","onUpdate:modelValue":t[2]||(t[2]=o=>r(s).cliente_id=o),class:p(["mt-1 w-full px-4 py-2.5 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors",m("cliente_id")])},[t[22]||(t[22]=e("option",{value:null},"— Sin cliente —",-1)),(n(!0),i(b,null,g(y.clientes,o=>(n(),i("option",{key:o.id,value:o.id},l(o.nombre_razon_social),9,bt))),128))],2),[[k,r(s).cliente_id]]),r(s).errors.cliente_id?(n(),i("p",gt,l(r(s).errors.cliente_id),1)):c("",!0)]),e("div",null,[t[25]||(t[25]=e("label",{for:"tipo",class:"block text-sm font-medium text-gray-700 mb-1"},[u(" Tipo "),e("span",{class:"text-red-500"},"*")],-1)),f(e("select",{id:"tipo","onUpdate:modelValue":t[3]||(t[3]=o=>r(s).tipo=o),class:p(["mt-1 w-full px-4 py-2.5 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent capitalize transition-colors",m("tipo")])},[t[24]||(t[24]=e("option",{value:"",disabled:""},"Selecciona un tipo",-1)),(n(!0),i(b,null,g(y.tipos,o=>(n(),i("option",{key:o,value:o},l(j(o)),9,yt))),128))],2),[[k,r(s).tipo]]),r(s).errors.tipo?(n(),i("p",vt,l(r(s).errors.tipo),1)):c("",!0)]),e("div",null,[t[26]||(t[26]=e("label",{for:"estado",class:"block text-sm font-medium text-gray-700 mb-1"},[u(" Estado "),e("span",{class:"text-red-500"},"*")],-1)),f(e("select",{id:"estado","onUpdate:modelValue":t[4]||(t[4]=o=>r(s).estado=o),class:p(["mt-1 w-full px-4 py-2.5 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent capitalize transition-colors",m("estado")])},[(n(!0),i(b,null,g(y.estados,o=>(n(),i("option",{key:o,value:o},[e("span",{class:p(F(o))},l(j(o)),3)],8,wt))),128))],2),[[k,r(s).estado]]),r(s).errors.estado?(n(),i("p",_t,l(r(s).errors.estado),1)):c("",!0),e("div",kt,[e("div",{class:p(["w-2 h-2 rounded-full mr-2",R(r(s).estado)])},null,2),e("span",ht,l(G(r(s).estado)),1)])]),e("div",null,[e("div",Ct,[t[27]||(t[27]=e("label",{for:"inicio_at",class:"block text-sm font-medium text-gray-700"},[u(" Inicio "),e("span",{class:"text-red-500"},"*")],-1)),e("div",Mt,[e("button",{type:"button",onClick:t[5]||(t[5]=o=>T("inicio_at")),class:"text-xs px-2 py-1 border border-gray-300 rounded hover:bg-gray-50 transition-colors"}," Ahora ")])]),f(e("input",{id:"inicio_at","onUpdate:modelValue":t[6]||(t[6]=o=>r(s).inicio_at=o),type:"datetime-local",class:p(["mt-1 w-full px-4 py-2.5 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors",m("inicio_at")])},null,2),[[v,r(s).inicio_at]]),r(s).errors.inicio_at?(n(),i("p",zt,l(r(s).errors.inicio_at),1)):c("",!0)]),e("div",null,[e("div",jt,[t[28]||(t[28]=e("label",{for:"fin_at",class:"block text-sm font-medium text-gray-700"},"Fin",-1)),e("div",Tt,[e("button",{type:"button",onClick:t[7]||(t[7]=o=>T("fin_at")),class:"text-xs px-2 py-1 border border-gray-300 rounded hover:bg-gray-50 transition-colors"}," Ahora "),e("button",{type:"button",onClick:t[8]||(t[8]=o=>M(30)),class:"text-xs px-2 py-1 border border-gray-300 rounded hover:bg-gray-50 transition-colors"}," +30m "),e("button",{type:"button",onClick:t[9]||(t[9]=o=>M(60)),class:"text-xs px-2 py-1 border border-gray-300 rounded hover:bg-gray-50 transition-colors"}," +1h "),e("button",{type:"button",onClick:t[10]||(t[10]=o=>M(120)),class:"text-xs px-2 py-1 border border-gray-300 rounded hover:bg-gray-50 transition-colors"}," +2h ")])]),f(e("input",{id:"fin_at","onUpdate:modelValue":t[11]||(t[11]=o=>r(s).fin_at=o),type:"datetime-local",class:p(["mt-1 w-full px-4 py-2.5 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors",m("fin_at")])},null,2),[[v,r(s).fin_at]]),r(s).errors.fin_at?(n(),i("p",St,l(r(s).errors.fin_at),1)):c("",!0),S.value?(n(),i("p",Vt,[t[29]||(t[29]=e("svg",{class:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),t[30]||(t[30]=u(" Duración: ")),e("span",Dt,l(S.value),1)])):c("",!0),z.value?(n(),i("p",Bt,[t[31]||(t[31]=e("svg",{class:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L3.339 16.5c-.77.833.192 2.5 1.732 2.5z"})],-1)),u(" "+l(z.value),1)])):c("",!0)]),e("div",Et,[t[32]||(t[32]=e("label",{for:"ubicacion",class:"block text-sm font-medium text-gray-700 mb-1"},"Ubicación",-1)),f(e("input",{id:"ubicacion","onUpdate:modelValue":t[12]||(t[12]=o=>r(s).ubicacion=o),type:"text",class:p(["mt-1 w-full px-4 py-2.5 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors",m("ubicacion")]),placeholder:"Ej. Sucursal Centro, Blvd. X, #123",maxlength:"255"},null,2),[[v,r(s).ubicacion,void 0,{trim:!0}]]),e("div",Ut,[r(s).errors.ubicacion?(n(),i("p",At,l(r(s).errors.ubicacion),1)):c("",!0),e("span",Nt,l((r(s).ubicacion||"").length)+" / 255",1)])]),e("div",It,[e("div",$t,[t[33]||(t[33]=e("label",{for:"descripcion",class:"block text-sm font-medium text-gray-700"},"Descripción",-1)),e("span",Lt,l((r(s).descripcion||"").length)+" / 5000",1)]),f(e("textarea",{id:"descripcion","onUpdate:modelValue":t[13]||(t[13]=o=>r(s).descripcion=o),rows:"5",class:p(["mt-1 w-full px-4 py-2.5 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors resize-none",m("descripcion")]),placeholder:"Detalle las actividades realizadas, materiales usados, pendientes, etc.",maxlength:"5000",onInput:P},null,34),[[v,r(s).descripcion,void 0,{trim:!0}]]),r(s).errors.descripcion?(n(),i("p",Ot,l(r(s).errors.descripcion),1)):c("",!0),e("div",Ft,[(n(),i(b,null,g($,o=>e("button",{key:o,type:"button",onClick:d=>H(o),class:"text-xs px-2 py-1 bg-blue-50 text-blue-600 rounded hover:bg-blue-100 transition-colors"}," + "+l(o),9,Rt)),64))])])]),e("div",Gt,[e("div",Ht,[t[37]||(t[37]=e("div",{class:"text-xs text-gray-500 flex items-center"},[e("svg",{class:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]),u(" Se guardará el usuario que registra y la hora exacta del envío. ")],-1)),e("div",Pt,[e("button",{type:"button",onClick:t[14]||(t[14]=o=>V("stay")),disabled:r(s).processing,class:"px-5 py-2.5 rounded-lg border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium"},[r(s).processing?(n(),i("span",Wt,t[34]||(t[34]=[e("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})],-1),u(" Guardando… ")]))):(n(),i("span",Qt,"Guardar y capturar otra"))],8,qt),e("button",{type:"submit",disabled:r(s).processing||!O.value,class:"px-5 py-2.5 rounded-lg bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium shadow-sm"},[r(s).processing?(n(),i("span",Jt,t[36]||(t[36]=[e("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})],-1),u(" Guardando… ")]))):(n(),i("span",Zt,t[35]||(t[35]=[e("svg",{class:"w-4 h-4 inline mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1),u(" Guardar ")])))],8,Xt)])])])],32),t[38]||(t[38]=Z('<div class="mt-6 bg-blue-50 border border-blue-200 rounded-lg p-4" data-v-d8f46784><h3 class="text-sm font-medium text-blue-900 mb-2 flex items-center" data-v-d8f46784><svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-d8f46784><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" data-v-d8f46784></path></svg> Tips para una mejor captura </h3><ul class="text-xs text-blue-800 space-y-1" data-v-d8f46784><li data-v-d8f46784>• Si la actividad aún está en curso, deja el <span class="font-medium" data-v-d8f46784>Fin</span> vacío y marca el estado como <span class="font-medium" data-v-d8f46784>en proceso</span>.</li><li data-v-d8f46784>• Usa los botones de tiempo rápido (+30m, +1h, +2h) para agilizar el registro.</li><li data-v-d8f46784>• Incluye detalles específicos en la descripción para futuras referencias.</li><li data-v-d8f46784>• Las plantillas de descripción te ayudan a estructurar la información.</li></ul></div>',1))])])],64))}}),re=st(Kt,[["__scopeId","data-v-d8f46784"]]);export{re as default};
