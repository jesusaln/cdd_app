import{r as x,K as V,p as D,w as $,i as n,k as y,o as l,f as e,t as d,q as F,v as k,l as C,z as E,F as H,m as I,n as L}from"./vendor-d19pJyVS.js";import{a as h}from"./utils-Dq7h7Pqt.js";const q={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 p-4"},S={class:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto"},T={class:"p-6 border-b"},U={class:"text-lg font-medium text-gray-900 mb-4"},G={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},K=["placeholder"],J={key:0,class:"mt-1 text-sm text-red-600"},O=["placeholder"],P={key:0,class:"mt-1 text-sm text-red-600"},Q={class:"flex justify-between"},R={key:1},W=["disabled"],X={key:0,class:"flex items-center"},Y={key:1},Z={class:"p-6"},ee={key:0,class:"text-center py-8 text-gray-500"},te={key:1,class:"space-y-3 max-h-96 overflow-y-auto"},ae={class:"flex-1"},se={class:"font-medium text-gray-900"},oe={key:0,class:"text-sm text-gray-600"},re={class:"flex items-center space-x-2"},ie=["onClick"],ne=["onClick"],de={__name:"CategoriaHerramientaModal",props:{show:{type:Boolean,default:!1},categorias:{type:Array,default:()=>[]}},emits:["close","categoria-created","categoria-updated"],setup(g,{emit:z}){const w=g,v=z,m=x(!1),u=x({}),p=x([]),r=x(null),s=V({nombre:"",descripcion:""});D(async()=>{w.show&&await f()}),$(()=>w.show,async o=>{o&&(r.value=null,s.nombre="",s.descripcion="",await f())});const f=async()=>{try{const o=await h.get("/herramientas/categorias");p.value=o.data}catch(o){console.error("Error al cargar categorías:",o)}},M=o=>{r.value=o,s.nombre=o.nombre,s.descripcion=o.descripcion||""},_=()=>{r.value=null,s.nombre="",s.descripcion="",u.value={}},A=async()=>{var o,t,a,c;m.value=!0,u.value={};try{let i;if(r.value){i=await h.put(`/herramientas/categorias/${r.value.id}`,s),v("categoria-updated",i.data.categoria);const b=p.value.findIndex(N=>N.id===r.value.id);b!==-1&&(p.value[b]=i.data.categoria),_()}else i=await h.post("/herramientas/categorias",s),v("categoria-created",i.data.categoria),s.nombre="",s.descripcion="",await f()}catch(i){(t=(o=i.response)==null?void 0:o.data)!=null&&t.errors?u.value=i.response.data.errors:alert(((c=(a=i.response)==null?void 0:a.data)==null?void 0:c.message)||"Error al procesar la categoría")}finally{m.value=!1}},j=async o=>{var t,a;try{const c=await h.patch(`/herramientas/categorias/${o.id}/toggle`);v("categoria-updated",c.data.categoria);const i=p.value.findIndex(b=>b.id===o.id);i!==-1&&(p.value[i]=c.data.categoria)}catch(c){alert(((a=(t=c.response)==null?void 0:t.data)==null?void 0:a.message)||"Error al cambiar el estado de la categoría")}},B=()=>{u.value={},r.value=null,s.nombre="",s.descripcion="",v("close")};return(o,t)=>g.show?(l(),n("div",q,[e("div",S,[e("div",{class:"flex items-center justify-between p-6 border-b"},[t[3]||(t[3]=e("h3",{class:"text-xl font-semibold text-gray-900"},"Gestión de Categorías",-1)),e("button",{onClick:B,class:"text-gray-400 hover:text-gray-600"},t[2]||(t[2]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),e("div",T,[e("h4",U,d(r.value?"Editar Categoría":"Crear Nueva Categoría"),1),e("form",{onSubmit:F(A,["prevent"]),class:"space-y-4"},[e("div",G,[e("div",null,[t[4]||(t[4]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},[C(" Nombre "),e("span",{class:"text-red-500"},"*")],-1)),k(e("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>s.nombre=a),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:r.value?s.nombre:"Ej: Herramientas Eléctricas",required:""},null,8,K),[[E,s.nombre]]),u.value.nombre?(l(),n("div",J,d(u.value.nombre),1)):y("",!0)]),e("div",null,[t[5]||(t[5]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Descripción",-1)),k(e("input",{"onUpdate:modelValue":t[1]||(t[1]=a=>s.descripcion=a),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:r.value?s.descripcion:"Descripción opcional..."},null,8,O),[[E,s.descripcion]]),u.value.descripcion?(l(),n("div",P,d(u.value.descripcion),1)):y("",!0)])]),e("div",Q,[r.value?(l(),n("button",{key:0,type:"button",onClick:_,class:"px-4 py-2 text-gray-700 border border-gray-300 rounded-md hover:bg-gray-50"}," Cancelar Edición ")):(l(),n("div",R)),e("button",{type:"submit",disabled:m.value,class:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50"},[m.value?(l(),n("span",X,[t[6]||(t[6]=e("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),C(" "+d(m.value?r.value?"Actualizando...":"Creando...":r.value?"Actualizar":"Crear"),1)])):(l(),n("span",Y,d(r.value?"Actualizar Categoría":"Crear Categoría"),1))],8,W)])],32)]),e("div",Z,[t[7]||(t[7]=e("h4",{class:"text-lg font-medium text-gray-900 mb-4"},"Categorías Existentes",-1)),g.categorias.length===0?(l(),n("div",ee," No hay categorías creadas aún ")):(l(),n("div",te,[(l(!0),n(H,null,I(g.categorias,a=>(l(),n("div",{key:a.id,class:"flex items-center justify-between p-3 border border-gray-200 rounded-lg hover:bg-gray-50"},[e("div",ae,[e("div",se,d(a.nombre),1),a.descripcion?(l(),n("div",oe,d(a.descripcion),1)):y("",!0)]),e("div",re,[e("span",{class:L([a.activo?"text-green-600":"text-red-600","text-sm"])},d(a.activo?"Activa":"Inactiva"),3),e("button",{onClick:c=>M(a),class:"px-3 py-1 text-sm bg-blue-600 text-white rounded hover:bg-blue-700"}," Editar ",8,ie),e("button",{onClick:c=>j(a),class:"px-3 py-1 text-sm border border-gray-300 rounded hover:bg-gray-50"},d(a.activo?"Desactivar":"Activar"),9,ne)])]))),128))]))])])])):y("",!0)}};export{de as _};
