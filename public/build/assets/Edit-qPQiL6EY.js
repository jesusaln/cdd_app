import{r as v,T as se,c as ne,p as ie,O as I,w as de,i as D,o as B,g as y,f as o,u as s,Z as le,q as ue,l as d,k as ce,v as f,z as $,x as A,F as pe,m as me,t as ge,s as T,N as ve}from"./vendor-d19pJyVS.js";import{N as fe}from"./app-BcT2PLJy.js";import{A as be}from"./AppLayout-CcnrZQKI.js";import{_ as xe,a as ye,b as we}from"./BotonesAccion-DYwTTkJE.js";import{_ as he,P as ke}from"./ProductosSeleccionados-DXGsTgz6.js";import{_ as _e}from"./BuscarProducto-B_taEjGP.js";import{_ as Ce}from"./VistaPreviaModal-CAwANwka.js";import{_ as Me}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./utils-Dq7h7Pqt.js";const Fe={class:"ordenes-compra-edit min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 p-6"},$e={class:"max-w-6xl mx-auto"},je={class:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden"},Pe={class:"bg-gradient-to-r from-indigo-500 to-indigo-600 px-6 py-4"},Ve={class:"text-lg font-semibold text-white flex items-center"},Ee={key:0,class:"ml-2 inline-flex items-center gap-1 px-2 py-1 bg-indigo-100 text-indigo-700 text-xs font-medium rounded-full"},Ne={class:"p-6 grid grid-cols-1 md:grid-cols-2 gap-6"},De={class:"relative"},Be={class:"relative"},Ae=["disabled"],ze={class:"mt-3 flex flex-wrap gap-2"},Se=["disabled"],qe=["disabled"],He=["value"],Oe={class:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden"},Ue={class:"p-6"},Le={class:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden"},Ie={class:"p-6"},Te={class:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden"},Ge={class:"p-6 grid grid-cols-1 md:grid-cols-2 gap-6"},Re={class:"md:col-span-2"},Qe=["disabled"],Ye=["disabled"],Ze=["disabled"],Je={class:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden"},Ke={class:"p-6"},We=["disabled"],Xe={class:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden"},eo={class:"p-6"},oo={class:"space-y-4"},ro=["disabled"],to=Object.assign({layout:be},{__name:"Edit",props:{ordenCompra:{type:Object,required:!0},proveedores:{type:Array,default:()=>[]},productos:{type:Array,default:()=>[]},almacenes:{type:Array,default:()=>[]},errors:{type:Object,default:()=>({})}},setup(q){const G=new fe({duration:5e3,position:{x:"right",y:"top"},types:[{type:"success",background:"#10B981",icon:{className:"notyf__icon--success",tagName:"i",text:"✓"}},{type:"error",background:"#EF4444",icon:{className:"notyf__icon--error",tagName:"i",text:"✗"}},{type:"info",background:"#3B82F6",icon:{className:"notyf__icon--info",tagName:"i",text:"ℹ"}}]}),i=(t,e="success")=>{G.open({type:e,message:t})},n=q,H=v([...n.proveedores]),r=se({numero_orden:"",fecha_orden:"",fecha_entrega_esperada:"",prioridad:"media",proveedor_id:"",almacen_id:"",direccion_entrega:"",terminos_pago:"30_dias",metodo_pago:"transferencia",subtotal:0,descuento_items:0,descuento_general:0,iva:0,total:0,items:[],observaciones:""}),j=t=>{if(!t)return"";try{if(typeof t=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(t))return t;const e=new Date(t);if(isNaN(e.getTime()))return"";const a=e.getFullYear(),c=String(e.getMonth()+1).padStart(2,"0"),u=String(e.getDate()).padStart(2,"0");return`${a}-${c}-${u}`}catch{return""}},O=()=>{n.ordenCompra?(r.numero_orden=n.ordenCompra.numero_orden||"",r.fecha_orden=j(n.ordenCompra.fecha_orden)||j(new Date),r.fecha_entrega_esperada=j(n.ordenCompra.fecha_entrega_esperada),r.prioridad=n.ordenCompra.prioridad||"media",r.proveedor_id=n.ordenCompra.proveedor_id||"",r.almacen_id=n.ordenCompra.almacen_id||"",r.direccion_entrega=n.ordenCompra.direccion_entrega||"",r.terminos_pago=n.ordenCompra.terminos_pago||"30_dias",r.metodo_pago=n.ordenCompra.metodo_pago||"transferencia",r.subtotal=parseFloat(n.ordenCompra.subtotal)||0,r.descuento_items=parseFloat(n.ordenCompra.descuento_items)||0,r.descuento_general=parseFloat(n.ordenCompra.descuento_general)||0,r.iva=parseFloat(n.ordenCompra.iva)||0,r.total=parseFloat(n.ordenCompra.total)||0,r.observaciones=n.ordenCompra.observaciones||""):(r.numero_orden="",r.fecha_orden=j(new Date),r.fecha_entrega_esperada="",r.prioridad="media",r.proveedor_id="",r.almacen_id="",r.direccion_entrega="",r.terminos_pago="30_dias",r.metodo_pago="transferencia",r.subtotal=0,r.descuento_items=0,r.descuento_general=0,r.iva=0,r.total=0,r.observaciones="")},R=v(null),m=v(null),l=v([]),g=v({}),x=v({}),b=v({}),z=v(!1),N=v(!0),p=v(!0),Q=()=>{i("Usa los botones para establecer fechas de entrega comunes","info")},Y=async()=>{const t=r.numero_orden.trim();try{await navigator.clipboard.writeText(t),i(`Número copiado: ${t}`,"success")}catch{const a=document.createElement("textarea");a.value=t,document.body.appendChild(a),a.select(),document.execCommand("copy"),document.body.removeChild(a),i(`Número copiado: ${t}`,"success")}},Z=()=>{const t=j(new Date);r.fecha_orden!==t&&(r.fecha_orden=t)},P=t=>{const e=new Date;let a=new Date(e);switch(t){case"hoy":break;case"manana":a.setDate(e.getDate()+1);break;case"3dias":a.setDate(e.getDate()+3);break;case"semana":a.setDate(e.getDate()+7);break;case"mes":a.setMonth(e.getMonth()+1);break}const c=a.getFullYear(),u=String(a.getMonth()+1).padStart(2,"0"),w=String(a.getDate()).padStart(2,"0"),h=`${c}-${u}-${w}`;r.fecha_entrega_esperada=h,i(`Fecha de entrega establecida: ${{hoy:"Hoy",manana:"Mañana","3dias":"En 3 días",semana:"En una semana",mes:"En un mes"}[t]} (${h})`,"success")},J=()=>{m.value&&l.value.length>0?z.value=!0:i("Selecciona un proveedor y al menos un producto","error")},K=t=>{var e;if(!t){m.value=null,r.proveedor_id="",i("Selección de proveedor limpiada","info");return}((e=m.value)==null?void 0:e.id)!==t.id&&(m.value=t,r.proveedor_id=t.id,i(`Proveedor seleccionado: ${t.nombre_razon_social}`))},W=t=>{if(!t||typeof t.id>"u"){i("Producto inválido","error");return}if(l.value.some(a=>a.id===t.id&&a.tipo==="producto"))i("Este producto ya está en la lista","info");else{const a={id:t.id,tipo:"producto",nombre:t.nombre,descripcion:t.descripcion||"",precio:t.precio_compra||0,precio_compra:t.precio_compra||0};l.value.push(a);const c=`producto-${t.id}`;g.value[c]=1;let u=0;t.precio_compra&&Number(t.precio_compra)>0?u=Number(t.precio_compra):t.precio_venta&&Number(t.precio_venta)>0&&(u=Number(t.precio_venta)),x.value[c]=u,b.value[c]=0,_(),saveState(),i(`Producto añadido: ${t.nombre||t.descripcion||"Producto"}`)}},X=t=>{if(!t||typeof t.id>"u"||!t.tipo)return;const e=`${t.tipo}-${t.id}`;l.value=l.value.filter(a=>!(a.id===t.id&&a.tipo===t.tipo)),delete g.value[e],delete x.value[e],delete b.value[e],_(),i(`Producto eliminado: ${t.nombre||t.descripcion||"Producto"}`,"info")},ee=(t,e)=>{const a=parseFloat(e);isNaN(a)||a<0||(g.value[t]=a,_())},oe=(t,e)=>{const a=parseFloat(e);isNaN(a)||a<0||a>100||(b.value[t]=a,_())},k=ne(()=>{let t=0,e=0;l.value.forEach(C=>{const M=`${C.tipo}-${C.id}`,V=parseFloat(g.value[M])||0,E=parseFloat(x.value[M])||0,S=parseFloat(b.value[M])||0;if(V>0&&E>=0){const F=V*E;e+=F*(S/100),t+=F}});const a=parseFloat(r.descuento_general)||0,c=Math.max(0,t-e),u=Math.max(0,c-a),w=u*.16,h=u+w;return{subtotal:parseFloat(t.toFixed(2)),descuentoItems:parseFloat(e.toFixed(2)),descuentoGeneral:a,subtotalConDescuentos:parseFloat(u.toFixed(2)),iva:parseFloat(w.toFixed(2)),total:parseFloat(h.toFixed(2))}}),_=()=>{r.subtotal=k.value.subtotal,r.descuento_items=k.value.descuentoItems,r.iva=k.value.iva,r.total=k.value.total},re=()=>{if(!r.fecha_orden)return i("Fecha de orden no disponible","error"),!1;if(!r.proveedor_id)return i("Selecciona un proveedor","error"),!1;if(l.value.length===0)return i("Agrega al menos un producto","error"),!1;for(const t of l.value){const e=`${t.tipo}-${t.id}`,a=parseFloat(b.value[e])||0,c=parseFloat(g.value[e])||0,u=parseFloat(x.value[e])||0;if(a<0||a>100)return i("Los descuentos deben estar entre 0% y 100%.","error"),!1;if(c<=0)return i("Las cantidades deben ser mayores a 0","error"),!1;if(u<0)return i("Los precios no pueden ser negativos","error"),!1}return!0},te=()=>{re()&&(r.items=l.value.map(t=>{const e=`producto-${t.id}`;return{id:t.id,tipo:"producto",cantidad:parseFloat(g.value[e])||1,precio:parseFloat(x.value[e])||0,descuento:parseFloat(b.value[e])||0}}),_(),r.put(route("ordenescompra.update",n.ordenCompra.id),{onSuccess:()=>{i("Orden de compra actualizada con éxito"),ve.visit(route("ordenescompra.index"))},onError:t=>{if(t&&typeof t=="object"&&t.message&&t.message.includes("CSRF token mismatch")){i("La sesión ha expirado. Refrescando la página...","error"),setTimeout(()=>{window.location.reload()},2e3);return}const e=Object.values(t)[0];Array.isArray(e)?i(e[0],"error"):i("Hubo errores de validación","error")}}))},ae=()=>{r.fecha_entrega_esperada="",r.prioridad="media",r.almacen_id="",r.direccion_entrega="",r.terminos_pago="30_dias",r.metodo_pago="transferencia",r.observaciones="",r.descuento_general=0,l.value=[],g.value={},x.value={},b.value={},i("Formulario limpiado correctamente")},U=()=>{var t;(t=n.ordenCompra)!=null&&t.productos&&Array.isArray(n.ordenCompra.productos)&&(n.ordenCompra.productos.forEach((e,a)=>{var u,w,h,C,M,V,E;if(e.tipo==="producto"||((u=e.pivot)==null?void 0:u.item_type)==="App\\Models\\Producto"||((w=e.pivot)==null?void 0:w.item_type)==="App\\\\Models\\\\Producto"){const S={id:e.id,tipo:"producto",nombre:e.nombre,descripcion:e.descripcion||"",precio:((h=e.pivot)==null?void 0:h.precio)||0,precio_compra:((C=e.pivot)==null?void 0:C.precio)||0};l.value.push(S);const F=`producto-${e.id}`;g.value[F]=((M=e.pivot)==null?void 0:M.cantidad)||1,x.value[F]=((V=e.pivot)==null?void 0:V.precio)||0,b.value[F]=((E=e.pivot)==null?void 0:E.descuento)||0}}),_())},L=()=>{var t;if((t=n.ordenCompra)!=null&&t.proveedor&&(m.value=n.ordenCompra.proveedor),!m.value&&r.proveedor_id){const e=H.value.find(a=>a.id===r.proveedor_id);e&&(m.value=e)}};return ie(()=>{O(),L(),U(),p.value=!1;const t=setInterval(()=>{Z()},5*60*1e3);window.addEventListener("beforeunload",e=>{r.isDirty&&(e.preventDefault(),e.returnValue="¿Estás seguro de que quieres salir? Los cambios no guardados se perderán.")}),I(()=>{clearInterval(t)})}),de(()=>n.ordenCompra,t=>{t&&!r.fecha_orden&&(O(),L(),U(),p.value=!1)},{immediate:!1}),I(()=>{window.removeEventListener("beforeunload",()=>{})}),(t,e)=>(B(),D("div",null,[y(s(le),{title:"Editar Orden de Compra"}),o("div",Fe,[o("div",$e,[y(xe,{title:"Editar Orden de Compra",description:"Modifica los detalles de la orden de compra existente","can-preview":m.value&&l.value.length>0,"back-url":t.route("ordenescompra.index"),"show-shortcuts":N.value,onPreview:J,onCloseShortcuts:e[0]||(e[0]=a=>N.value=!1)},null,8,["can-preview","back-url","show-shortcuts"]),o("form",{onSubmit:ue(te,["prevent"]),class:"space-y-8"},[o("div",je,[o("div",Pe,[o("h2",Ve,[e[20]||(e[20]=o("svg",{class:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),e[21]||(e[21]=d(" Información General ")),p.value?(B(),D("span",Ee,e[19]||(e[19]=[o("svg",{class:"w-3 h-3 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1),d(" Cargando... ")]))):ce("",!0)])]),o("div",Ne,[o("div",null,[e[25]||(e[25]=o("label",{for:"numero_orden",class:"block text-sm font-medium text-gray-700 mb-2 flex items-center gap-2"},[d(" Número de Orden * "),o("span",{class:"inline-flex items-center gap-1 px-2 py-1 bg-blue-100 text-blue-700 text-xs font-medium rounded-full"},[o("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})]),d(" Automático ")])],-1)),o("div",De,[f(o("input",{id:"numero_orden","onUpdate:modelValue":e[1]||(e[1]=a=>s(r).numero_orden=a),type:"text",class:"w-full bg-gray-50 text-gray-500 cursor-not-allowed border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-indigo-500 focus:border-transparent",readonly:""},null,512),[[$,s(r).numero_orden]]),e[22]||(e[22]=o("div",{class:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none"},[o("svg",{class:"w-5 h-5 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})])],-1))]),o("div",{class:"mt-2 flex items-center gap-2"},[e[24]||(e[24]=o("p",{class:"text-xs text-gray-500"}," Este número es fijo para esta orden de compra ",-1)),o("button",{onClick:Y,class:"inline-flex items-center gap-1 px-2 py-1 bg-gray-100 text-gray-700 text-xs font-medium rounded hover:bg-gray-200 transition-colors",title:"Copiar número de orden"},e[23]||(e[23]=[o("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})],-1),d(" Copiar ")]))])]),o("div",null,[e[27]||(e[27]=o("label",{for:"fecha_orden",class:"block text-sm font-medium text-gray-700 mb-2 flex items-center gap-2"},[d(" Fecha de Orden * "),o("span",{class:"inline-flex items-center gap-1 px-2 py-1 bg-blue-100 text-blue-700 text-xs font-medium rounded-full"},[o("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})]),d(" Automática ")])],-1)),o("div",Be,[f(o("input",{id:"fecha_orden","onUpdate:modelValue":e[2]||(e[2]=a=>s(r).fecha_orden=a),type:"date",class:"w-full bg-gray-50 text-gray-500 cursor-not-allowed border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-indigo-500 focus:border-transparent",readonly:"",required:""},null,512),[[$,s(r).fecha_orden]]),e[26]||(e[26]=o("div",{class:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none"},[o("svg",{class:"w-5 h-5 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1))]),e[28]||(e[28]=o("p",{class:"mt-1 text-xs text-gray-500"}," Esta fecha se establece automáticamente con la fecha de creación ",-1))]),o("div",null,[o("label",{for:"fecha_entrega_esperada",class:"block text-sm font-medium text-gray-700 mb-2 flex items-center gap-2"},[e[30]||(e[30]=d(" Fecha de Entrega Esperada ")),o("button",{onClick:Q,type:"button",class:"text-gray-400 hover:text-gray-600 transition-colors",title:"Opciones de fechas rápidas disponibles"},e[29]||(e[29]=[o("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)]))]),f(o("input",{id:"fecha_entrega_esperada","onUpdate:modelValue":e[3]||(e[3]=a=>s(r).fecha_entrega_esperada=a),type:"date",disabled:p.value,class:"w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-indigo-500 focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed"},null,8,Ae),[[$,s(r).fecha_entrega_esperada]]),o("div",ze,[o("button",{onClick:e[4]||(e[4]=a=>P("hoy")),type:"button",class:"inline-flex items-center gap-1 px-3 py-2 bg-blue-50 text-blue-700 text-sm font-medium rounded-lg hover:bg-blue-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors duration-200"},e[31]||(e[31]=[o("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),d(" Hoy ")])),o("button",{onClick:e[5]||(e[5]=a=>P("manana")),type:"button",class:"inline-flex items-center gap-1 px-3 py-2 bg-green-50 text-green-700 text-sm font-medium rounded-lg hover:bg-green-100 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition-colors duration-200"},e[32]||(e[32]=[o("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})],-1),d(" Mañana ")])),o("button",{onClick:e[6]||(e[6]=a=>P("3dias")),type:"button",class:"inline-flex items-center gap-1 px-3 py-2 bg-yellow-50 text-yellow-700 text-sm font-medium rounded-lg hover:bg-yellow-100 focus:outline-none focus:ring-2 focus:ring-yellow-500 focus:ring-offset-2 transition-colors duration-200"},e[33]||(e[33]=[o("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1),d(" +3 días ")])),o("button",{onClick:e[7]||(e[7]=a=>P("semana")),type:"button",class:"inline-flex items-center gap-1 px-3 py-2 bg-purple-50 text-purple-700 text-sm font-medium rounded-lg hover:bg-purple-100 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 transition-colors duration-200"},e[34]||(e[34]=[o("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})],-1),d(" Una semana ")])),o("button",{onClick:e[8]||(e[8]=a=>P("mes")),type:"button",class:"inline-flex items-center gap-1 px-3 py-2 bg-red-50 text-red-700 text-sm font-medium rounded-lg hover:bg-red-100 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 transition-colors duration-200"},e[35]||(e[35]=[o("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1),d(" Un mes ")]))])]),o("div",null,[e[37]||(e[37]=o("label",{for:"prioridad",class:"block text-sm font-medium text-gray-700 mb-2"}," Prioridad ",-1)),f(o("select",{id:"prioridad","onUpdate:modelValue":e[9]||(e[9]=a=>s(r).prioridad=a),disabled:p.value,class:"w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-indigo-500 focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed"},e[36]||(e[36]=[o("option",{value:"baja"},"Baja",-1),o("option",{value:"media"},"Media",-1),o("option",{value:"alta"},"Alta",-1),o("option",{value:"urgente"},"Urgente",-1)]),8,Se),[[A,s(r).prioridad]])]),o("div",null,[e[39]||(e[39]=o("label",{for:"almacen_id",class:"block text-sm font-medium text-gray-700 mb-2"}," Almacén de Destino ",-1)),f(o("select",{id:"almacen_id","onUpdate:modelValue":e[10]||(e[10]=a=>s(r).almacen_id=a),disabled:p.value,class:"w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-indigo-500 focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed"},[e[38]||(e[38]=o("option",{value:""},"Seleccionar almacén...",-1)),(B(!0),D(pe,null,me(q.almacenes,a=>(B(),D("option",{key:a.id,value:a.id},ge(a.nombre),9,He))),128))],8,qe),[[A,s(r).almacen_id]]),e[40]||(e[40]=o("p",{class:"mt-1 text-xs text-gray-500"}," Almacén donde se recibirán los productos ",-1))])])]),o("div",Oe,[e[42]||(e[42]=o("div",{class:"bg-gradient-to-r from-blue-500 to-blue-600 px-6 py-4"},[o("h2",{class:"text-lg font-semibold text-white flex items-center"},[o("svg",{class:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})]),d(" Información del Proveedor ")])],-1)),o("div",Ue,[y(he,{proveedores:H.value,"proveedor-seleccionado":m.value,"label-busqueda":"Proveedor","placeholder-busqueda":"Buscar proveedor por nombre, RFC, email...",requerido:"",onProveedorSeleccionado:K},null,8,["proveedores","proveedor-seleccionado"]),e[41]||(e[41]=T('<div class="mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg" data-v-fc078759><div class="flex items-center gap-2 text-blue-700 text-sm" data-v-fc078759><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-fc078759><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" data-v-fc078759></path></svg><span class="font-medium" data-v-fc078759>Nota:</span><span data-v-fc078759>Las órdenes de compra solo incluyen productos físicos para inventario.</span></div></div>',1))])]),o("div",Le,[e[43]||(e[43]=o("div",{class:"bg-gradient-to-r from-green-500 to-green-600 px-6 py-4"},[o("h2",{class:"text-lg font-semibold text-white flex items-center"},[o("svg",{class:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012 2v2M7 7h10"})]),d(" Productos ")])],-1)),o("div",Ie,[y(_e,{ref_key:"buscarProductoRef",ref:R,productos:n.productos,servicios:[],"validar-stock":!1,onAgregarProducto:W},null,8,["productos"]),y(ke,{"selected-products":l.value,productos:n.productos,servicios:[],quantities:g.value,prices:x.value,discounts:b.value,onEliminarProducto:X,onUpdateQuantity:ee,onUpdateDiscount:oe},null,8,["selected-products","productos","quantities","prices","discounts"])])]),o("div",Te,[e[49]||(e[49]=o("div",{class:"bg-gradient-to-r from-orange-500 to-orange-600 px-6 py-4"},[o("h2",{class:"text-lg font-semibold text-white flex items-center"},[o("svg",{class:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})]),d(" Condiciones de Entrega ")])],-1)),o("div",Ge,[o("div",Re,[e[44]||(e[44]=o("label",{for:"direccion_entrega",class:"block text-sm font-medium text-gray-700 mb-2"}," Dirección de Entrega ",-1)),f(o("textarea",{id:"direccion_entrega","onUpdate:modelValue":e[11]||(e[11]=a=>s(r).direccion_entrega=a),disabled:p.value,class:"w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-orange-500 focus:border-transparent resize-vertical disabled:bg-gray-100 disabled:cursor-not-allowed",rows:"3",placeholder:"Especifica la dirección donde se debe entregar el pedido..."},null,8,Qe),[[$,s(r).direccion_entrega]])]),o("div",null,[e[46]||(e[46]=o("label",{for:"terminos_pago",class:"block text-sm font-medium text-gray-700 mb-2"}," Términos de Pago ",-1)),f(o("select",{id:"terminos_pago","onUpdate:modelValue":e[12]||(e[12]=a=>s(r).terminos_pago=a),disabled:p.value,class:"w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-orange-500 focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed"},e[45]||(e[45]=[T('<option value="contado" data-v-fc078759>Contado</option><option value="15_dias" data-v-fc078759>15 días</option><option value="30_dias" data-v-fc078759>30 días</option><option value="45_dias" data-v-fc078759>45 días</option><option value="60_dias" data-v-fc078759>60 días</option><option value="90_dias" data-v-fc078759>90 días</option>',6)]),8,Ye),[[A,s(r).terminos_pago]])]),o("div",null,[e[48]||(e[48]=o("label",{for:"metodo_pago",class:"block text-sm font-medium text-gray-700 mb-2"}," Método de Pago ",-1)),f(o("select",{id:"metodo_pago","onUpdate:modelValue":e[13]||(e[13]=a=>s(r).metodo_pago=a),disabled:p.value,class:"w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-orange-500 focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed"},e[47]||(e[47]=[o("option",{value:"transferencia"},"Transferencia Bancaria",-1),o("option",{value:"cheque"},"Cheque",-1),o("option",{value:"efectivo"},"Efectivo",-1),o("option",{value:"tarjeta"},"Tarjeta de Crédito",-1)]),8,Ze),[[A,s(r).metodo_pago]])])])]),o("div",Je,[e[50]||(e[50]=o("div",{class:"bg-gradient-to-r from-purple-500 to-purple-600 px-6 py-4"},[o("h2",{class:"text-lg font-semibold text-white flex items-center"},[o("svg",{class:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})]),d(" Notas y Observaciones ")])],-1)),o("div",Ke,[f(o("textarea",{"onUpdate:modelValue":e[14]||(e[14]=a=>s(r).observaciones=a),disabled:p.value,class:"w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-purple-500 focus:border-transparent resize-vertical disabled:bg-gray-100 disabled:cursor-not-allowed",rows:"4",placeholder:"Agrega observaciones, especificaciones técnicas, términos y condiciones especiales..."},null,8,We),[[$,s(r).observaciones]])])]),o("div",Xe,[e[53]||(e[53]=o("div",{class:"bg-gradient-to-r from-red-500 to-red-600 px-6 py-4"},[o("h2",{class:"text-lg font-semibold text-white flex items-center"},[o("svg",{class:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})]),d(" Descuento General ")])],-1)),o("div",eo,[o("div",oo,[o("div",null,[e[51]||(e[51]=o("label",{for:"descuento_general",class:"block text-sm font-medium text-gray-700 mb-2"}," Descuento General ($) ",-1)),f(o("input",{id:"descuento_general",type:"number",step:"0.01",min:"0","onUpdate:modelValue":e[15]||(e[15]=a=>s(r).descuento_general=a),disabled:p.value,class:"w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-red-500 focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed",placeholder:"0.00"},null,8,ro),[[$,s(r).descuento_general]]),e[52]||(e[52]=o("p",{class:"mt-1 text-xs text-gray-500"}," Este descuento se aplica al subtotal después de los descuentos por item ",-1))])])])]),y(ye,{"show-margin-calculator":!1,"margin-data":{costoTotal:0,precioVenta:0,ganancia:0,margenPorcentaje:0},totals:k.value,"item-count":l.value.length,"total-quantity":Object.values(g.value).reduce((a,c)=>a+(c||0),0)},null,8,["totals","item-count","total-quantity"]),y(we,{"back-url":t.route("ordenescompra.index"),"is-processing":s(r).processing,"can-submit":s(r).proveedor_id&&l.value.length>0,"button-text":s(r).processing?"Actualizando...":"Actualizar Orden de Compra",onLimpiar:ae},null,8,["back-url","is-processing","can-submit","button-text"])],32),o("button",{onClick:e[16]||(e[16]=a=>N.value=!N.value),class:"fixed bottom-4 left-4 bg-gray-600 text-white p-3 rounded-full shadow-lg hover:bg-gray-700 transition-colors duration-200",title:"Mostrar atajos de teclado"},e[54]||(e[54]=[o("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)])),y(Ce,{show:z.value,type:"ordenescompra",proveedor:m.value,productos:l.value,totals:k.value,notas:s(r).observaciones,"orden-data":{numero_orden:s(r).numero_orden,fecha_orden:s(r).fecha_orden,fecha_entrega_esperada:s(r).fecha_entrega_esperada,prioridad:s(r).prioridad,direccion_entrega:s(r).direccion_entrega,terminos_pago:s(r).terminos_pago,metodo_pago:s(r).metodo_pago},onClose:e[17]||(e[17]=a=>z.value=!1),onPrint:e[18]||(e[18]=()=>t.window.print())},null,8,["show","proveedor","productos","totals","notas","orden-data"])])])]))}}),go=Me(to,[["__scopeId","data-v-fc078759"]]);export{go as default};
