import{r as v,K as D,i as s,o as a,f as l,g as n,G as E,e as o,l as d,n as y,t as C,P as R,D as Q,Q as z,T as G,c as I,w as U,b,k as m,u as $,F as O,m as j,N}from"./vendor-d19pJyVS.js";import{_ as J}from"./ActionSection-CiwCYD2L.js";import{_ as W}from"./DialogModal-BMx9KjTB.js";import{_ as B}from"./InputError-DR3j2HKb.js";import{_ as V}from"./PrimaryButton-D_2lIeSZ.js";import{_ as F}from"./SecondaryButton-BHgzZ2Qe.js";import{_ as H}from"./TextInput-CLu6pR_b.js";import{_ as X}from"./DangerButton-kZW3lc2t.js";import{_ as Y}from"./InputLabel-BboP45ES.js";import"./utils-Dq7h7Pqt.js";import"./SectionTitle-BO8LIPnY.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Modal-DXOFbFUN.js";const Z={class:"mt-4"},w={__name:"ConfirmsPassword",props:{title:{type:String,default:"Confirm Password"},content:{type:String,default:"For your security, please confirm your password to continue."},button:{type:String,default:"Confirm"}},emits:["confirmed"],setup(x,{emit:T}){const k=T,i=v(!1),e=D({password:"",error:"",processing:!1}),u=v(null),_=()=>{axios.get(route("password.confirmation")).then(r=>{r.data.confirmed?k("confirmed"):(i.value=!0,setTimeout(()=>u.value.focus(),250))})},g=()=>{e.processing=!0,axios.post(route("password.confirm"),{password:e.password}).then(()=>{e.processing=!1,f(),Q().then(()=>k("confirmed"))}).catch(r=>{e.processing=!1,e.error=r.response.data.errors.password[0],u.value.focus()})},f=()=>{i.value=!1,e.password="",e.error=""};return(r,c)=>(a(),s("span",null,[l("span",{onClick:_},[E(r.$slots,"default")]),n(W,{show:i.value,onClose:f},{title:o(()=>[d(C(x.title),1)]),content:o(()=>[d(C(x.content)+" ",1),l("div",Z,[n(H,{ref_key:"passwordInput",ref:u,modelValue:e.password,"onUpdate:modelValue":c[0]||(c[0]=S=>e.password=S),type:"password",class:"mt-1 block w-3/4",placeholder:"Password",autocomplete:"current-password",onKeyup:R(g,["enter"])},null,8,["modelValue"]),n(B,{message:e.error,class:"mt-2"},null,8,["message"])])]),footer:o(()=>[n(F,{onClick:f},{default:o(()=>c[1]||(c[1]=[d(" Cancel ")])),_:1}),n(V,{class:y(["ms-3",{"opacity-25":e.processing}]),disabled:e.processing,onClick:g},{default:o(()=>[d(C(x.button),1)]),_:1},8,["class","disabled"])]),_:1},8,["show"])]))}},ee={key:0,class:"text-lg font-medium text-white"},te={key:1,class:"text-lg font-medium text-black"},ae={key:2,class:"text-lg font-medium text-black"},oe={key:3},se={key:0},ne={class:"mt-4 max-w-xl text-sm text-black"},le={key:0,class:"font-semibold"},re={key:1},ie=["innerHTML"],ce={key:0,class:"mt-4 max-w-xl text-sm text-black"},de={class:"font-semibold"},ue=["innerHTML"],me={key:1,class:"mt-4"},fe={key:1},pe={class:"grid gap-1 max-w-xl mt-4 px-4 py-4 font-mono text-sm bg-gray-100 rounded-lg text-black"},ve={class:"mt-5"},ge={key:0},_e={key:1},Ae={__name:"TwoFactorAuthenticationForm",props:{requiresConfirmation:Boolean},setup(x){const T=x,k=z(),i=v(!1),e=v(!1),u=v(!1),_=v(null),g=v(null),f=v([]),r=G({code:""}),c=I(()=>{var p;return!i.value&&((p=k.props.auth.user)==null?void 0:p.two_factor_enabled)});U(c,()=>{c.value||(r.reset(),r.clearErrors())});const S=()=>{i.value=!0,N.post(route("two-factor.enable"),{},{preserveScroll:!0,onSuccess:()=>Promise.all([L(),M(),P()]),onFinish:()=>{i.value=!1,e.value=T.requiresConfirmation}})},L=()=>axios.get(route("two-factor.qr-code")).then(p=>{_.value=p.data.svg}),M=()=>axios.get(route("two-factor.secret-key")).then(p=>{g.value=p.data.secretKey}),P=()=>axios.get(route("two-factor.recovery-codes")).then(p=>{f.value=p.data}),A=()=>{r.post(route("two-factor.confirm"),{errorBag:"confirmTwoFactorAuthentication",preserveScroll:!0,preserveState:!0,onSuccess:()=>{e.value=!1,_.value=null,g.value=null}})},q=()=>{axios.post(route("two-factor.recovery-codes")).then(()=>P())},K=()=>{u.value=!0,N.delete(route("two-factor.disable"),{preserveScroll:!0,onSuccess:()=>{u.value=!1,e.value=!1}})};return(p,t)=>(a(),b(J,null,{title:o(()=>t[1]||(t[1]=[l("h2",{class:"text-black font-semibold text-xl leading-tight"}," Autenticación de Dos Factores ",-1)])),description:o(()=>t[2]||(t[2]=[l("p",{class:"text-black"}," Añade seguridad adicional a tu cuenta usando la autenticación de dos factores. ",-1)])),content:o(()=>[c.value&&!e.value?(a(),s("h3",ee," Has habilitado la autenticación de dos factores. ")):c.value&&e.value?(a(),s("h3",te," Finaliza la configuración de la autenticación de dos factores. ")):(a(),s("h3",ae," No has habilitado la autenticación de dos factores. ")),t[11]||(t[11]=l("div",{class:"mt-3 max-w-xl text-sm text-white"},[l("p",null," Cuando la autenticación de dos factores está habilitada, se te pedirá un token seguro y aleatorio durante la autenticación. Puedes obtener este token desde la aplicación Google Authenticator de tu teléfono. ")],-1)),c.value?(a(),s("div",oe,[_.value?(a(),s("div",se,[l("div",ne,[e.value?(a(),s("p",le," Para finalizar la configuración de la autenticación de dos factores, escanea el siguiente código QR usando la aplicación de autenticación de tu teléfono o introduce la clave de configuración y proporciona el código OTP generado. ")):(a(),s("p",re," La autenticación de dos factores está ahora habilitada. Escanea el siguiente código QR usando la aplicación de autenticación de tu teléfono o introduce la clave de configuración. "))]),l("div",{class:"mt-4 p-2 inline-block bg-white",innerHTML:_.value},null,8,ie),g.value?(a(),s("div",ce,[l("p",de,[t[3]||(t[3]=d(" Clave de Configuración: ")),l("span",{innerHTML:g.value},null,8,ue)])])):m("",!0),e.value?(a(),s("div",me,[n(Y,{for:"code",value:"Código",class:"text-black"}),n(H,{id:"code",modelValue:$(r).code,"onUpdate:modelValue":t[0]||(t[0]=h=>$(r).code=h),type:"text",name:"code",class:"block mt-1 w-1/2 text-black",inputmode:"numeric",autofocus:"",autocomplete:"one-time-code",onKeyup:R(A,["enter"])},null,8,["modelValue"]),n(B,{message:$(r).errors.code,class:"mt-2 text-black"},null,8,["message"])])):m("",!0)])):m("",!0),f.value.length>0&&!e.value?(a(),s("div",fe,[t[4]||(t[4]=l("div",{class:"mt-4 max-w-xl text-sm text-black"},[l("p",{class:"font-semibold"}," Almacena estos códigos de recuperación en un gestor de contraseñas seguro. Pueden usarse para recuperar el acceso a tu cuenta si pierdes tu dispositivo de autenticación de dos factores. ")],-1)),l("div",pe,[(a(!0),s(O,null,j(f.value,h=>(a(),s("div",{key:h},C(h),1))),128))])])):m("",!0)])):m("",!0),l("div",ve,[c.value?(a(),s("div",_e,[n(w,{onConfirmed:A},{default:o(()=>[e.value?(a(),b(V,{key:0,type:"button",class:y(["me-3 text-black",{"opacity-25":i.value}]),disabled:i.value},{default:o(()=>t[6]||(t[6]=[d(" Confirmar ")])),_:1},8,["class","disabled"])):m("",!0)]),_:1}),n(w,{onConfirmed:q},{default:o(()=>[f.value.length>0&&!e.value?(a(),b(F,{key:0,class:"me-3 text-black"},{default:o(()=>t[7]||(t[7]=[d(" Regenerar Códigos de Recuperación ")])),_:1})):m("",!0)]),_:1}),n(w,{onConfirmed:P},{default:o(()=>[f.value.length===0&&!e.value?(a(),b(F,{key:0,class:"me-3 text-black"},{default:o(()=>t[8]||(t[8]=[d(" Mostrar Códigos de Recuperación ")])),_:1})):m("",!0)]),_:1}),n(w,{onConfirmed:K},{default:o(()=>[e.value?(a(),b(F,{key:0,class:y(["text-black",{"opacity-25":u.value}]),disabled:u.value},{default:o(()=>t[9]||(t[9]=[d(" Cancelar ")])),_:1},8,["class","disabled"])):m("",!0)]),_:1}),n(w,{onConfirmed:K},{default:o(()=>[e.value?m("",!0):(a(),b(X,{key:0,class:y(["text-black",{"opacity-25":u.value}]),disabled:u.value},{default:o(()=>t[10]||(t[10]=[d(" Deshabilitar ")])),_:1},8,["class","disabled"]))]),_:1})])):(a(),s("div",ge,[n(w,{onConfirmed:S},{default:o(()=>[n(V,{type:"button",class:y([{"opacity-25":i.value},"text-black"]),disabled:i.value},{default:o(()=>t[5]||(t[5]=[d(" Habilitar ")])),_:1},8,["class","disabled"])]),_:1})]))])]),_:1}))}};export{Ae as default};
